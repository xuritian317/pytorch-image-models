
Fri Nov 12 23:17:45 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Fri Nov 12 23:17:45 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Fri Nov 12 23:17:47 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Fri Nov 12 23:17:47 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Fri Nov 12 23:18:58 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Fri Nov 12 23:18:58 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 32
  Total train batch size (w. parallel, distributed & accumulation) = 32
  Gradient Accumulation steps = 1
Fri Nov 12 23:19:15 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Fri Nov 12 23:19:17 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Fri Nov 12 23:20:30 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 32
  Total train batch size (w. parallel, distributed & accumulation) = 32
  Gradient Accumulation steps = 1
Fri Nov 12 23:20:45 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Fri Nov 12 23:20:47 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Fri Nov 12 23:21:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:21:37 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Fri Nov 12 23:21:38 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Fri Nov 12 23:21:40 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Fri Nov 12 23:21:40 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Fri Nov 12 23:22:50 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Fri Nov 12 23:22:50 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Fri Nov 12 23:24:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:25:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:29:24 2021


Validation Results
Global Steps: 200
Valid Loss: 3.60262
Valid Accuracy: 0.24412
Fri Nov 12 23:29:24 2021
Saved model checkpoint to [DIR: %s]./output
Fri Nov 12 23:29:24 2021

best accuracy so far: 0.244120
Fri Nov 12 23:29:37 2021


Validation Results
Global Steps: 200
Valid Loss: 5.24897
Valid Accuracy: 0.01952
Fri Nov 12 23:29:38 2021
Saved model checkpoint to [DIR: %s]./output
Fri Nov 12 23:29:38 2021

best accuracy so far: 0.019522
Fri Nov 12 23:30:42 2021

 train accuracy so far: 0.152148
Fri Nov 12 23:30:58 2021

 train accuracy so far: 0.016602
Fri Nov 12 23:31:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:31:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:36:01 2021


Validation Results
Global Steps: 400
Valid Loss: 2.68678
Valid Accuracy: 0.33253
Fri Nov 12 23:36:01 2021
Saved model checkpoint to [DIR: %s]./output
Fri Nov 12 23:36:01 2021

best accuracy so far: 0.332534
Fri Nov 12 23:36:29 2021


Validation Results
Global Steps: 400
Valid Loss: 5.01030
Valid Accuracy: 0.05170
Fri Nov 12 23:36:30 2021
Saved model checkpoint to [DIR: %s]./output
Fri Nov 12 23:36:30 2021

best accuracy so far: 0.051702
Fri Nov 12 23:38:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:38:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:42:38 2021


Validation Results
Global Steps: 600
Valid Loss: 2.82904
Valid Accuracy: 0.28649
Fri Nov 12 23:42:38 2021

best accuracy so far: 0.332534
Fri Nov 12 23:43:04 2021

 train accuracy so far: 0.282227
Fri Nov 12 23:43:22 2021


Validation Results
Global Steps: 600
Valid Loss: 4.30392
Valid Accuracy: 0.16650
Fri Nov 12 23:43:23 2021
Saved model checkpoint to [DIR: %s]./output
Fri Nov 12 23:43:23 2021

best accuracy so far: 0.166500
Fri Nov 12 23:43:50 2021

 train accuracy so far: 0.081836
Fri Nov 12 23:44:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:45:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:49:14 2021


Validation Results
Global Steps: 800
Valid Loss: 2.75912
Valid Accuracy: 0.29436
Fri Nov 12 23:49:15 2021

best accuracy so far: 0.332534
Fri Nov 12 23:50:13 2021


Validation Results
Global Steps: 800
Valid Loss: 3.45803
Valid Accuracy: 0.25711
Fri Nov 12 23:50:14 2021
Saved model checkpoint to [DIR: %s]./output
Fri Nov 12 23:50:14 2021

best accuracy so far: 0.257112
Fri Nov 12 23:50:59 2021

 train accuracy so far: 0.281641
Fri Nov 12 23:51:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:52:02 2021

 train accuracy so far: 0.260156
Fri Nov 12 23:52:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:55:51 2021


Validation Results
Global Steps: 1000
Valid Loss: 2.63324
Valid Accuracy: 0.32507
Fri Nov 12 23:55:51 2021

best accuracy so far: 0.332534
Fri Nov 12 23:57:06 2021


Validation Results
Global Steps: 1000
Valid Loss: 2.79321
Valid Accuracy: 0.36518
Fri Nov 12 23:57:06 2021
Saved model checkpoint to [DIR: %s]./output
Fri Nov 12 23:57:06 2021

best accuracy so far: 0.365181
Fri Nov 12 23:58:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Fri Nov 12 23:59:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:02:27 2021


Validation Results
Global Steps: 1200
Valid Loss: 2.62935
Valid Accuracy: 0.33400
Sat Nov 13 00:02:28 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:02:28 2021

best accuracy so far: 0.334000
Sat Nov 13 00:03:20 2021

 train accuracy so far: 0.334180
Sat Nov 13 00:03:58 2021


Validation Results
Global Steps: 1200
Valid Loss: 2.30025
Valid Accuracy: 0.44980
Sat Nov 13 00:03:58 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:03:58 2021

best accuracy so far: 0.449797
Sat Nov 13 00:04:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:04:52 2021

 train accuracy so far: 0.412891
Sat Nov 13 00:06:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:09:04 2021


Validation Results
Global Steps: 1400
Valid Loss: 2.32862
Valid Accuracy: 0.37824
Sat Nov 13 00:09:05 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:09:05 2021

best accuracy so far: 0.378240
Sat Nov 13 00:10:50 2021


Validation Results
Global Steps: 1400
Valid Loss: 1.98009
Valid Accuracy: 0.51296
Sat Nov 13 00:10:50 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:10:50 2021

best accuracy so far: 0.512959
Sat Nov 13 00:11:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:13:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:15:40 2021


Validation Results
Global Steps: 1600
Valid Loss: 2.19657
Valid Accuracy: 0.41468
Sat Nov 13 00:15:41 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:15:41 2021

best accuracy so far: 0.414685
Sat Nov 13 00:15:41 2021

 train accuracy so far: 0.374609
Sat Nov 13 00:17:42 2021


Validation Results
Global Steps: 1600
Valid Loss: 1.73793
Valid Accuracy: 0.56666
Sat Nov 13 00:17:43 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:17:43 2021

best accuracy so far: 0.566660
Sat Nov 13 00:17:43 2021

 train accuracy so far: 0.526758
Sat Nov 13 00:17:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:19:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:22:16 2021


Validation Results
Global Steps: 1800
Valid Loss: 2.04851
Valid Accuracy: 0.43700
Sat Nov 13 00:22:17 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:22:17 2021

best accuracy so far: 0.437004
Sat Nov 13 00:23:35 2021

 train accuracy so far: 0.423242
Sat Nov 13 00:24:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:24:34 2021


Validation Results
Global Steps: 1800
Valid Loss: 1.55016
Valid Accuracy: 0.61063
Sat Nov 13 00:24:34 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:24:34 2021

best accuracy so far: 0.610634
Sat Nov 13 00:25:56 2021

 train accuracy so far: 0.609570
Sat Nov 13 00:26:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:28:53 2021


Validation Results
Global Steps: 2000
Valid Loss: 2.19818
Valid Accuracy: 0.42275
Sat Nov 13 00:28:53 2021

best accuracy so far: 0.437004
Sat Nov 13 00:31:04 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:31:27 2021


Validation Results
Global Steps: 2000
Valid Loss: 1.40772
Valid Accuracy: 0.62849
Sat Nov 13 00:31:27 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:31:27 2021

best accuracy so far: 0.628490
Sat Nov 13 00:33:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:35:29 2021


Validation Results
Global Steps: 2200
Valid Loss: 2.10341
Valid Accuracy: 0.44253
Sat Nov 13 00:35:30 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:35:30 2021

best accuracy so far: 0.442534
Sat Nov 13 00:35:56 2021

 train accuracy so far: 0.451367
Sat Nov 13 00:37:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:38:19 2021


Validation Results
Global Steps: 2200
Valid Loss: 1.30400
Valid Accuracy: 0.65381
Sat Nov 13 00:38:20 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:38:20 2021

best accuracy so far: 0.653808
Sat Nov 13 00:38:47 2021

 train accuracy so far: 0.682813
Sat Nov 13 00:40:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:42:05 2021


Validation Results
Global Steps: 2400
Valid Loss: 2.17442
Valid Accuracy: 0.43561
Sat Nov 13 00:42:06 2021

best accuracy so far: 0.442534
Sat Nov 13 00:43:50 2021

 train accuracy so far: 0.480664
Sat Nov 13 00:44:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:45:12 2021


Validation Results
Global Steps: 2400
Valid Loss: 1.21671
Valid Accuracy: 0.67639
Sat Nov 13 00:45:13 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:45:13 2021

best accuracy so far: 0.676394
Sat Nov 13 00:47:00 2021

 train accuracy so far: 0.724609
Sat Nov 13 00:47:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:48:42 2021


Validation Results
Global Steps: 2600
Valid Loss: 1.98781
Valid Accuracy: 0.46292
Sat Nov 13 00:48:42 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:48:42 2021

best accuracy so far: 0.462922
Sat Nov 13 00:50:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:52:06 2021


Validation Results
Global Steps: 2600
Valid Loss: 1.10856
Valid Accuracy: 0.69572
Sat Nov 13 00:52:07 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:52:07 2021

best accuracy so far: 0.695716
Sat Nov 13 00:54:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:55:18 2021


Validation Results
Global Steps: 2800
Valid Loss: 1.74459
Valid Accuracy: 0.52195
Sat Nov 13 00:55:19 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:55:19 2021

best accuracy so far: 0.521953
Sat Nov 13 00:56:11 2021

 train accuracy so far: 0.522070
Sat Nov 13 00:57:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 00:58:57 2021


Validation Results
Global Steps: 2800
Valid Loss: 1.03289
Valid Accuracy: 0.70897
Sat Nov 13 00:58:58 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 00:58:58 2021

best accuracy so far: 0.708975
Sat Nov 13 00:59:52 2021

 train accuracy so far: 0.764453
Sat Nov 13 01:01:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:01:55 2021


Validation Results
Global Steps: 3000
Valid Loss: 1.78875
Valid Accuracy: 0.50683
Sat Nov 13 01:01:56 2021

best accuracy so far: 0.521953
Sat Nov 13 01:04:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:05:50 2021


Validation Results
Global Steps: 3000
Valid Loss: 0.95416
Valid Accuracy: 0.73136
Sat Nov 13 01:05:51 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:05:51 2021

best accuracy so far: 0.731361
Sat Nov 13 01:08:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:08:31 2021


Validation Results
Global Steps: 3200
Valid Loss: 1.71180
Valid Accuracy: 0.53121
Sat Nov 13 01:08:31 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:08:31 2021

best accuracy so far: 0.531215
Sat Nov 13 01:08:31 2021

 train accuracy so far: 0.569727
Sat Nov 13 01:10:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:12:42 2021


Validation Results
Global Steps: 3200
Valid Loss: 0.93577
Valid Accuracy: 0.74082
Sat Nov 13 01:12:43 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:12:43 2021

best accuracy so far: 0.740822
Sat Nov 13 01:12:43 2021

 train accuracy so far: 0.792969
Sat Nov 13 01:14:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:15:07 2021


Validation Results
Global Steps: 3400
Valid Loss: 1.57501
Valid Accuracy: 0.56053
Sat Nov 13 01:15:08 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:15:08 2021

best accuracy so far: 0.560530
Sat Nov 13 01:16:26 2021

 train accuracy so far: 0.616992
Sat Nov 13 01:17:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:19:36 2021


Validation Results
Global Steps: 3400
Valid Loss: 0.87847
Valid Accuracy: 0.74755
Sat Nov 13 01:19:36 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:19:36 2021

best accuracy so far: 0.747551
Sat Nov 13 01:20:57 2021

 train accuracy so far: 0.818750
Sat Nov 13 01:21:44 2021


Validation Results
Global Steps: 3600
Valid Loss: 1.60391
Valid Accuracy: 0.55287
Sat Nov 13 01:21:44 2021

best accuracy so far: 0.560530
Sat Nov 13 01:21:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:23:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:26:28 2021


Validation Results
Global Steps: 3600
Valid Loss: 0.85719
Valid Accuracy: 0.75321
Sat Nov 13 01:26:29 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:26:29 2021

best accuracy so far: 0.753215
Sat Nov 13 01:28:20 2021


Validation Results
Global Steps: 3800
Valid Loss: 1.63162
Valid Accuracy: 0.56133
Sat Nov 13 01:28:20 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:28:20 2021

best accuracy so far: 0.561330
Sat Nov 13 01:28:45 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:28:46 2021

 train accuracy so far: 0.640039
Sat Nov 13 01:30:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:33:21 2021


Validation Results
Global Steps: 3800
Valid Loss: 0.84633
Valid Accuracy: 0.75628
Sat Nov 13 01:33:22 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:33:22 2021

best accuracy so far: 0.756280
Sat Nov 13 01:33:49 2021

 train accuracy so far: 0.839063
Sat Nov 13 01:34:57 2021


Validation Results
Global Steps: 4000
Valid Loss: 1.48341
Valid Accuracy: 0.58918
Sat Nov 13 01:34:57 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:34:57 2021

best accuracy so far: 0.589180
Sat Nov 13 01:35:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:36:41 2021

 train accuracy so far: 0.684180
Sat Nov 13 01:37:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:40:13 2021


Validation Results
Global Steps: 4000
Valid Loss: 0.77907
Valid Accuracy: 0.77187
Sat Nov 13 01:40:13 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:40:13 2021

best accuracy so far: 0.771870
Sat Nov 13 01:41:33 2021


Validation Results
Global Steps: 4200
Valid Loss: 1.52529
Valid Accuracy: 0.58658
Sat Nov 13 01:41:33 2021

best accuracy so far: 0.589180
Sat Nov 13 01:42:01 2021

 train accuracy so far: 0.868555
Sat Nov 13 01:42:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:43:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:47:05 2021


Validation Results
Global Steps: 4200
Valid Loss: 0.78269
Valid Accuracy: 0.76834
Sat Nov 13 01:47:06 2021

best accuracy so far: 0.771870
Sat Nov 13 01:48:10 2021


Validation Results
Global Steps: 4400
Valid Loss: 1.43279
Valid Accuracy: 0.60597
Sat Nov 13 01:48:11 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:48:11 2021

best accuracy so far: 0.605970
Sat Nov 13 01:49:02 2021

 train accuracy so far: 0.713086
Sat Nov 13 01:49:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:50:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:53:58 2021


Validation Results
Global Steps: 4400
Valid Loss: 0.76454
Valid Accuracy: 0.77607
Sat Nov 13 01:53:58 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:53:58 2021

best accuracy so far: 0.776068
Sat Nov 13 01:54:46 2021


Validation Results
Global Steps: 4600
Valid Loss: 1.33914
Valid Accuracy: 0.64015
Sat Nov 13 01:54:47 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 01:54:47 2021

best accuracy so far: 0.640149
Sat Nov 13 01:54:52 2021

 train accuracy so far: 0.882227
Sat Nov 13 01:56:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 01:56:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:00:50 2021


Validation Results
Global Steps: 4600
Valid Loss: 0.75946
Valid Accuracy: 0.77693
Sat Nov 13 02:00:51 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:00:51 2021

best accuracy so far: 0.776934
Sat Nov 13 02:01:22 2021


Validation Results
Global Steps: 4800
Valid Loss: 1.25180
Valid Accuracy: 0.65261
Sat Nov 13 02:01:23 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:01:23 2021

best accuracy so far: 0.652608
Sat Nov 13 02:01:23 2021

 train accuracy so far: 0.742773
Sat Nov 13 02:03:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:03:33 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:07:42 2021


Validation Results
Global Steps: 4800
Valid Loss: 0.72911
Valid Accuracy: 0.78480
Sat Nov 13 02:07:43 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:07:43 2021

best accuracy so far: 0.784796
Sat Nov 13 02:07:43 2021

 train accuracy so far: 0.895508
Sat Nov 13 02:07:59 2021


Validation Results
Global Steps: 5000
Valid Loss: 1.20583
Valid Accuracy: 0.67400
Sat Nov 13 02:08:00 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:08:00 2021

best accuracy so far: 0.673996
Sat Nov 13 02:09:17 2021

 train accuracy so far: 0.780859
Sat Nov 13 02:09:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:10:09 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:14:34 2021


Validation Results
Global Steps: 5000
Valid Loss: 0.72900
Valid Accuracy: 0.78500
Sat Nov 13 02:14:35 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:14:35 2021

best accuracy so far: 0.784996
Sat Nov 13 02:14:36 2021


Validation Results
Global Steps: 5200
Valid Loss: 1.28030
Valid Accuracy: 0.66753
Sat Nov 13 02:14:36 2021

best accuracy so far: 0.673996
Sat Nov 13 02:15:55 2021

 train accuracy so far: 0.910547
Sat Nov 13 02:16:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:16:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:21:12 2021


Validation Results
Global Steps: 5400
Valid Loss: 1.23474
Valid Accuracy: 0.66647
Sat Nov 13 02:21:13 2021

best accuracy so far: 0.673996
Sat Nov 13 02:21:26 2021


Validation Results
Global Steps: 5200
Valid Loss: 0.70680
Valid Accuracy: 0.79006
Sat Nov 13 02:21:27 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:21:27 2021

best accuracy so far: 0.790059
Sat Nov 13 02:21:39 2021

 train accuracy so far: 0.815820
Sat Nov 13 02:23:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:23:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:27:49 2021


Validation Results
Global Steps: 5600
Valid Loss: 1.22494
Valid Accuracy: 0.68053
Sat Nov 13 02:27:49 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:27:49 2021

best accuracy so far: 0.680525
Sat Nov 13 02:28:19 2021


Validation Results
Global Steps: 5400
Valid Loss: 0.67414
Valid Accuracy: 0.80099
Sat Nov 13 02:28:20 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:28:20 2021

best accuracy so far: 0.800986
Sat Nov 13 02:28:47 2021

 train accuracy so far: 0.918945
Sat Nov 13 02:29:33 2021

 train accuracy so far: 0.835938
Sat Nov 13 02:29:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:30:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:34:26 2021


Validation Results
Global Steps: 5800
Valid Loss: 1.18417
Valid Accuracy: 0.68939
Sat Nov 13 02:34:26 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:34:26 2021

best accuracy so far: 0.689386
Sat Nov 13 02:35:13 2021


Validation Results
Global Steps: 5600
Valid Loss: 0.67227
Valid Accuracy: 0.80212
Sat Nov 13 02:35:14 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:35:14 2021

best accuracy so far: 0.802119
Sat Nov 13 02:36:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:37:01 2021

 train accuracy so far: 0.928906
Sat Nov 13 02:37:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:41:01 2021


Validation Results
Global Steps: 6000
Valid Loss: 1.15394
Valid Accuracy: 0.70604
Sat Nov 13 02:41:02 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:41:02 2021

best accuracy so far: 0.706043
Sat Nov 13 02:41:54 2021

 train accuracy so far: 0.874609
Sat Nov 13 02:42:05 2021


Validation Results
Global Steps: 5800
Valid Loss: 0.70339
Valid Accuracy: 0.79086
Sat Nov 13 02:42:05 2021

best accuracy so far: 0.802119
Sat Nov 13 02:43:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:44:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:47:38 2021


Validation Results
Global Steps: 6200
Valid Loss: 1.15373
Valid Accuracy: 0.70458
Sat Nov 13 02:47:38 2021

best accuracy so far: 0.706043
Sat Nov 13 02:48:57 2021


Validation Results
Global Steps: 6000
Valid Loss: 0.66490
Valid Accuracy: 0.79992
Sat Nov 13 02:48:57 2021

best accuracy so far: 0.802119
Sat Nov 13 02:49:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:49:51 2021

 train accuracy so far: 0.928516
Sat Nov 13 02:51:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:54:14 2021


Validation Results
Global Steps: 6400
Valid Loss: 1.14437
Valid Accuracy: 0.71930
Sat Nov 13 02:54:14 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 02:54:14 2021

best accuracy so far: 0.719302
Sat Nov 13 02:54:14 2021

 train accuracy so far: 0.899219
Sat Nov 13 02:55:49 2021


Validation Results
Global Steps: 6200
Valid Loss: 0.66362
Valid Accuracy: 0.80119
Sat Nov 13 02:55:49 2021

best accuracy so far: 0.802119
Sat Nov 13 02:56:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 02:58:04 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:00:50 2021


Validation Results
Global Steps: 6600
Valid Loss: 1.20784
Valid Accuracy: 0.71317
Sat Nov 13 03:00:50 2021

best accuracy so far: 0.719302
Sat Nov 13 03:02:08 2021

 train accuracy so far: 0.917578
Sat Nov 13 03:02:42 2021


Validation Results
Global Steps: 6400
Valid Loss: 0.65780
Valid Accuracy: 0.80278
Sat Nov 13 03:02:42 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:02:42 2021

best accuracy so far: 0.802785
Sat Nov 13 03:02:42 2021

 train accuracy so far: 0.940234
Sat Nov 13 03:03:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:04:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:07:26 2021


Validation Results
Global Steps: 6800
Valid Loss: 1.12818
Valid Accuracy: 0.72843
Sat Nov 13 03:07:27 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:07:27 2021

best accuracy so far: 0.728430
Sat Nov 13 03:09:32 2021


Validation Results
Global Steps: 6600
Valid Loss: 0.65775
Valid Accuracy: 0.80605
Sat Nov 13 03:09:33 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:09:33 2021

best accuracy so far: 0.806050
Sat Nov 13 03:09:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:10:54 2021

 train accuracy so far: 0.946484
Sat Nov 13 03:11:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:14:02 2021


Validation Results
Global Steps: 7000
Valid Loss: 1.16006
Valid Accuracy: 0.73189
Sat Nov 13 03:14:03 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:14:03 2021

best accuracy so far: 0.731894
Sat Nov 13 03:14:29 2021

 train accuracy so far: 0.942187
Sat Nov 13 03:16:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:16:25 2021


Validation Results
Global Steps: 6800
Valid Loss: 0.64825
Valid Accuracy: 0.80552
Sat Nov 13 03:16:25 2021

best accuracy so far: 0.806050
Sat Nov 13 03:18:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:20:39 2021


Validation Results
Global Steps: 7200
Valid Loss: 1.15328
Valid Accuracy: 0.73403
Sat Nov 13 03:20:40 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:20:40 2021

best accuracy so far: 0.734026
Sat Nov 13 03:22:24 2021

 train accuracy so far: 0.956445
Sat Nov 13 03:22:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:23:16 2021


Validation Results
Global Steps: 7000
Valid Loss: 0.64779
Valid Accuracy: 0.80871
Sat Nov 13 03:23:16 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:23:16 2021

best accuracy so far: 0.808715
Sat Nov 13 03:23:43 2021

 train accuracy so far: 0.950586
Sat Nov 13 03:25:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:27:15 2021


Validation Results
Global Steps: 7400
Valid Loss: 1.14117
Valid Accuracy: 0.74289
Sat Nov 13 03:27:16 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:27:16 2021

best accuracy so far: 0.742888
Sat Nov 13 03:29:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:30:08 2021


Validation Results
Global Steps: 7200
Valid Loss: 0.63568
Valid Accuracy: 0.81451
Sat Nov 13 03:30:09 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:30:09 2021

best accuracy so far: 0.814511
Sat Nov 13 03:31:56 2021

 train accuracy so far: 0.957227
Sat Nov 13 03:32:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:33:51 2021


Validation Results
Global Steps: 7600
Valid Loss: 1.15187
Valid Accuracy: 0.74522
Sat Nov 13 03:33:52 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:33:52 2021

best accuracy so far: 0.745220
Sat Nov 13 03:34:44 2021

 train accuracy so far: 0.966016
Sat Nov 13 03:36:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:37:00 2021


Validation Results
Global Steps: 7400
Valid Loss: 0.64870
Valid Accuracy: 0.81151
Sat Nov 13 03:37:00 2021

best accuracy so far: 0.814511
Sat Nov 13 03:39:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:40:28 2021


Validation Results
Global Steps: 7800
Valid Loss: 1.16507
Valid Accuracy: 0.74715
Sat Nov 13 03:40:28 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:40:28 2021

best accuracy so far: 0.747152
Sat Nov 13 03:42:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:43:53 2021


Validation Results
Global Steps: 7600
Valid Loss: 0.63972
Valid Accuracy: 0.80911
Sat Nov 13 03:43:54 2021

best accuracy so far: 0.814511
Sat Nov 13 03:44:48 2021

 train accuracy so far: 0.961133
Sat Nov 13 03:46:09 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:47:04 2021


Validation Results
Global Steps: 8000
Valid Loss: 1.18217
Valid Accuracy: 0.74802
Sat Nov 13 03:47:05 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:47:05 2021

best accuracy so far: 0.748018
Sat Nov 13 03:47:05 2021

 train accuracy so far: 0.982812
Sat Nov 13 03:49:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:50:46 2021


Validation Results
Global Steps: 7800
Valid Loss: 0.64674
Valid Accuracy: 0.80818
Sat Nov 13 03:50:46 2021

best accuracy so far: 0.814511
Sat Nov 13 03:53:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:53:40 2021


Validation Results
Global Steps: 8200
Valid Loss: 1.18898
Valid Accuracy: 0.75102
Sat Nov 13 03:53:41 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 03:53:41 2021

best accuracy so far: 0.751016
Sat Nov 13 03:54:59 2021

 train accuracy so far: 0.987891
Sat Nov 13 03:55:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 03:57:38 2021


Validation Results
Global Steps: 8000
Valid Loss: 0.63858
Valid Accuracy: 0.81278
Sat Nov 13 03:57:38 2021

best accuracy so far: 0.814511
Sat Nov 13 03:57:38 2021

 train accuracy so far: 0.965039
Sat Nov 13 03:59:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:00:16 2021


Validation Results
Global Steps: 8400
Valid Loss: 1.18525
Valid Accuracy: 0.75308
Sat Nov 13 04:00:17 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 04:00:17 2021

best accuracy so far: 0.753081
Sat Nov 13 04:02:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:04:31 2021


Validation Results
Global Steps: 8200
Valid Loss: 0.63341
Valid Accuracy: 0.81378
Sat Nov 13 04:04:31 2021

best accuracy so far: 0.814511
Sat Nov 13 04:05:53 2021

 train accuracy so far: 0.964648
Sat Nov 13 04:06:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:06:53 2021


Validation Results
Global Steps: 8600
Valid Loss: 1.18388
Valid Accuracy: 0.75581
Sat Nov 13 04:06:53 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 04:06:53 2021

best accuracy so far: 0.755813
Sat Nov 13 04:07:19 2021

 train accuracy so far: 0.991406
Sat Nov 13 04:09:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:11:24 2021


Validation Results
Global Steps: 8400
Valid Loss: 0.63448
Valid Accuracy: 0.81258
Sat Nov 13 04:11:24 2021

best accuracy so far: 0.814511
Sat Nov 13 04:13:29 2021


Validation Results
Global Steps: 8800
Valid Loss: 1.18692
Valid Accuracy: 0.75561
Sat Nov 13 04:13:29 2021

best accuracy so far: 0.755813
Sat Nov 13 04:13:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:15:13 2021

 train accuracy so far: 0.994922
Sat Nov 13 04:15:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:18:16 2021


Validation Results
Global Steps: 8600
Valid Loss: 0.63771
Valid Accuracy: 0.81291
Sat Nov 13 04:18:17 2021

best accuracy so far: 0.814511
Sat Nov 13 04:18:44 2021

 train accuracy so far: 0.966211
Sat Nov 13 04:20:05 2021


Validation Results
Global Steps: 9000
Valid Loss: 1.18779
Valid Accuracy: 0.75481
Sat Nov 13 04:20:05 2021

best accuracy so far: 0.755813
Sat Nov 13 04:20:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:22:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:25:09 2021


Validation Results
Global Steps: 8800
Valid Loss: 0.63116
Valid Accuracy: 0.81531
Sat Nov 13 04:25:09 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 04:25:09 2021

best accuracy so far: 0.815311
Sat Nov 13 04:26:41 2021


Validation Results
Global Steps: 9200
Valid Loss: 1.18750
Valid Accuracy: 0.75795
Sat Nov 13 04:26:41 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 04:26:41 2021

best accuracy so far: 0.757945
Sat Nov 13 04:26:57 2021

 train accuracy so far: 0.968750
Sat Nov 13 04:27:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:27:33 2021

 train accuracy so far: 0.995117
Sat Nov 13 04:28:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:32:01 2021


Validation Results
Global Steps: 9000
Valid Loss: 0.63068
Valid Accuracy: 0.81431
Sat Nov 13 04:32:02 2021

best accuracy so far: 0.815311
Sat Nov 13 04:33:17 2021


Validation Results
Global Steps: 9400
Valid Loss: 1.18923
Valid Accuracy: 0.75941
Sat Nov 13 04:33:18 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 04:33:18 2021

best accuracy so far: 0.759411
Sat Nov 13 04:34:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:35:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:38:53 2021


Validation Results
Global Steps: 9200
Valid Loss: 0.63033
Valid Accuracy: 0.81458
Sat Nov 13 04:38:53 2021

best accuracy so far: 0.815311
Sat Nov 13 04:39:47 2021

 train accuracy so far: 0.966602
Sat Nov 13 04:39:54 2021


Validation Results
Global Steps: 9600
Valid Loss: 1.18576
Valid Accuracy: 0.76021
Sat Nov 13 04:39:54 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 04:39:54 2021

best accuracy so far: 0.760211
Sat Nov 13 04:39:54 2021

 train accuracy so far: 0.996875
Sat Nov 13 04:41:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:42:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:45:44 2021


Validation Results
Global Steps: 9400
Valid Loss: 0.62969
Valid Accuracy: 0.81578
Sat Nov 13 04:45:45 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 04:45:45 2021

best accuracy so far: 0.815777
Sat Nov 13 04:46:29 2021


Validation Results
Global Steps: 9800
Valid Loss: 1.18664
Valid Accuracy: 0.76054
Sat Nov 13 04:46:30 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 04:46:30 2021

best accuracy so far: 0.760544
Sat Nov 13 04:47:47 2021

 train accuracy so far: 0.997266
Sat Nov 13 04:48:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:48:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:52:37 2021


Validation Results
Global Steps: 9600
Valid Loss: 0.63146
Valid Accuracy: 0.81518
Sat Nov 13 04:52:37 2021

best accuracy so far: 0.815777
Sat Nov 13 04:52:37 2021

 train accuracy so far: 0.968750
Sat Nov 13 04:53:06 2021


Validation Results
Global Steps: 10000
Valid Loss: 1.18692
Valid Accuracy: 0.76061
Sat Nov 13 04:53:06 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 04:53:06 2021

best accuracy so far: 0.760610
Sat Nov 13 04:53:06 2021

 train accuracy so far: 0.998437
Sat Nov 13 04:53:06 2021

Best Accuracy: 	0.760610
End Training!
Total Training Time: 	5.504583


Sat Nov 13 04:53:20 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 04:53:22 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 04:54:32 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 04:54:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:56:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 04:59:28 2021


Validation Results
Global Steps: 9800
Valid Loss: 0.63090
Valid Accuracy: 0.81504
Sat Nov 13 04:59:28 2021

best accuracy so far: 0.815777
Sat Nov 13 05:00:49 2021

 train accuracy so far: 0.973633
Sat Nov 13 05:01:04 2021


Validation Results
Global Steps: 200
Valid Loss: 5.29487
Valid Accuracy: 0.00886
Sat Nov 13 05:01:05 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:01:05 2021

best accuracy so far: 0.008861
Sat Nov 13 05:01:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:02:21 2021

 train accuracy so far: 0.014258
Sat Nov 13 05:03:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:06:20 2021


Validation Results
Global Steps: 10000
Valid Loss: 0.63090
Valid Accuracy: 0.81511
Sat Nov 13 05:06:20 2021

best accuracy so far: 0.815777
Sat Nov 13 05:06:20 2021

 train accuracy so far: 0.970313
Sat Nov 13 05:06:21 2021

Best Accuracy: 	0.815777
End Training!
Total Training Time: 	5.725259


Sat Nov 13 05:06:35 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 05:06:37 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 05:07:39 2021


Validation Results
Global Steps: 400
Valid Loss: 5.12403
Valid Accuracy: 0.04191
Sat Nov 13 05:07:40 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:07:40 2021

best accuracy so far: 0.041908
Sat Nov 13 05:07:48 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 05:09:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:10:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:14:12 2021


Validation Results
Global Steps: 600
Valid Loss: 4.76069
Valid Accuracy: 0.08855
Sat Nov 13 05:14:12 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:14:12 2021

best accuracy so far: 0.088547
Sat Nov 13 05:14:35 2021


Validation Results
Global Steps: 200
Valid Loss: 5.39980
Valid Accuracy: 0.00273
Sat Nov 13 05:14:36 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:14:36 2021

best accuracy so far: 0.002732
Sat Nov 13 05:14:38 2021

 train accuracy so far: 0.049023
Sat Nov 13 05:15:53 2021

 train accuracy so far: 0.009180
Sat Nov 13 05:16:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:16:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:20:44 2021


Validation Results
Global Steps: 800
Valid Loss: 4.25864
Valid Accuracy: 0.16397
Sat Nov 13 05:20:45 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:20:45 2021

best accuracy so far: 0.163968
Sat Nov 13 05:21:17 2021


Validation Results
Global Steps: 400
Valid Loss: 5.83348
Valid Accuracy: 0.01472
Sat Nov 13 05:21:17 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:21:17 2021

best accuracy so far: 0.014724
Sat Nov 13 05:22:26 2021

 train accuracy so far: 0.164453
Sat Nov 13 05:22:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:23:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:27:18 2021


Validation Results
Global Steps: 1000
Valid Loss: 3.69367
Valid Accuracy: 0.24086
Sat Nov 13 05:27:18 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:27:18 2021

best accuracy so far: 0.240855
Sat Nov 13 05:28:00 2021


Validation Results
Global Steps: 600
Valid Loss: 5.83348
Valid Accuracy: 0.01472
Sat Nov 13 05:28:00 2021

best accuracy so far: 0.014724
Sat Nov 13 05:28:25 2021

 train accuracy so far: 0.009180
Sat Nov 13 05:29:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:30:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:33:50 2021


Validation Results
Global Steps: 1200
Valid Loss: 3.18548
Valid Accuracy: 0.31494
Sat Nov 13 05:33:51 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:33:51 2021

best accuracy so far: 0.314944
Sat Nov 13 05:34:40 2021


Validation Results
Global Steps: 800
Valid Loss: 5.83348
Valid Accuracy: 0.01472
Sat Nov 13 05:34:40 2021

best accuracy so far: 0.014724
Sat Nov 13 05:34:42 2021

 train accuracy so far: 0.280664
Sat Nov 13 05:35:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:36:21 2021

 train accuracy so far: 0.008203
Sat Nov 13 05:36:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:40:23 2021


Validation Results
Global Steps: 1400
Valid Loss: 2.78853
Valid Accuracy: 0.37338
Sat Nov 13 05:40:23 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:40:23 2021

best accuracy so far: 0.373376
Sat Nov 13 05:41:20 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.83348
Valid Accuracy: 0.01472
Sat Nov 13 05:41:20 2021

best accuracy so far: 0.014724
Sat Nov 13 05:42:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:43:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:46:56 2021


Validation Results
Global Steps: 1600
Valid Loss: 2.50794
Valid Accuracy: 0.42221
Sat Nov 13 05:46:56 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:46:56 2021

best accuracy so far: 0.422213
Sat Nov 13 05:46:56 2021

 train accuracy so far: 0.370508
Sat Nov 13 05:48:02 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.83348
Valid Accuracy: 0.01472
Sat Nov 13 05:48:02 2021

best accuracy so far: 0.014724
Sat Nov 13 05:48:53 2021

 train accuracy so far: 0.007227
Sat Nov 13 05:49:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:49:35 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 05:49:38 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 05:50:49 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 05:53:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:53:27 2021


Validation Results
Global Steps: 1800
Valid Loss: 2.30901
Valid Accuracy: 0.45013
Sat Nov 13 05:53:28 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:53:28 2021

best accuracy so far: 0.450130
Sat Nov 13 05:54:44 2021

 train accuracy so far: 0.452930
Sat Nov 13 05:55:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 05:57:38 2021


Validation Results
Global Steps: 200
Valid Loss: 5.42942
Valid Accuracy: 0.00533
Sat Nov 13 05:57:39 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 05:57:39 2021

best accuracy so far: 0.005330
Sat Nov 13 05:59:00 2021

 train accuracy so far: 0.013086
Sat Nov 13 05:59:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:00:00 2021


Validation Results
Global Steps: 2000
Valid Loss: 2.08810
Valid Accuracy: 0.48617
Sat Nov 13 06:00:01 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 06:00:01 2021

best accuracy so far: 0.486175
Sat Nov 13 06:02:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:04:29 2021


Validation Results
Global Steps: 400
Valid Loss: 5.18036
Valid Accuracy: 0.01572
Sat Nov 13 06:04:30 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 06:04:30 2021

best accuracy so far: 0.015724
Sat Nov 13 06:06:34 2021


Validation Results
Global Steps: 2200
Valid Loss: 1.93094
Valid Accuracy: 0.52695
Sat Nov 13 06:06:35 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 06:06:35 2021

best accuracy so far: 0.526950
Sat Nov 13 06:06:45 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:06:50 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 06:06:53 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 06:08:04 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 06:10:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:11:20 2021


Validation Results
Global Steps: 600
Valid Loss: 5.15222
Valid Accuracy: 0.03538
Sat Nov 13 06:11:20 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 06:11:20 2021

best accuracy so far: 0.035379
Sat Nov 13 06:11:47 2021

 train accuracy so far: 0.029102
Sat Nov 13 06:13:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:14:37 2021


Validation Results
Global Steps: 200
Valid Loss: 4.74476
Valid Accuracy: 0.07282
Sat Nov 13 06:14:37 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 06:14:37 2021

best accuracy so far: 0.072823
Sat Nov 13 06:15:54 2021

 train accuracy so far: 0.055273
Sat Nov 13 06:16:45 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:18:09 2021


Validation Results
Global Steps: 800
Valid Loss: 5.13331
Valid Accuracy: 0.03538
Sat Nov 13 06:18:10 2021

best accuracy so far: 0.035379
Sat Nov 13 06:19:57 2021

 train accuracy so far: 0.031445
Sat Nov 13 06:20:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:21:11 2021


Validation Results
Global Steps: 400
Valid Loss: 3.49072
Valid Accuracy: 0.20175
Sat Nov 13 06:21:12 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 06:21:12 2021

best accuracy so far: 0.201746
Sat Nov 13 06:23:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:24:59 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.12729
Valid Accuracy: 0.03538
Sat Nov 13 06:24:59 2021

best accuracy so far: 0.035379
Sat Nov 13 06:27:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:27:45 2021


Validation Results
Global Steps: 600
Valid Loss: 3.07814
Valid Accuracy: 0.22560
Sat Nov 13 06:27:45 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 06:27:45 2021

best accuracy so far: 0.225598
Sat Nov 13 06:28:11 2021

 train accuracy so far: 0.194336
Sat Nov 13 06:29:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:31:48 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.13367
Valid Accuracy: 0.03538
Sat Nov 13 06:31:49 2021

best accuracy so far: 0.035379
Sat Nov 13 06:32:42 2021

 train accuracy so far: 0.031836
Sat Nov 13 06:34:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:34:18 2021


Validation Results
Global Steps: 800
Valid Loss: 2.94910
Valid Accuracy: 0.29222
Sat Nov 13 06:34:19 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 06:34:19 2021

best accuracy so far: 0.292225
Sat Nov 13 06:36:01 2021

 train accuracy so far: 0.281055
Sat Nov 13 06:36:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:38:37 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.15254
Valid Accuracy: 0.03538
Sat Nov 13 06:38:37 2021

best accuracy so far: 0.035379
Sat Nov 13 06:40:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:40:52 2021


Validation Results
Global Steps: 1000
Valid Loss: 2.64912
Valid Accuracy: 0.33307
Sat Nov 13 06:40:53 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 06:40:53 2021

best accuracy so far: 0.333067
Sat Nov 13 06:43:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:45:25 2021


Validation Results
Global Steps: 1600
Valid Loss: 5.12203
Valid Accuracy: 0.03538
Sat Nov 13 06:45:25 2021

best accuracy so far: 0.035379
Sat Nov 13 06:45:25 2021

 train accuracy so far: 0.031445
Sat Nov 13 06:47:27 2021


Validation Results
Global Steps: 1200
Valid Loss: 2.45963
Valid Accuracy: 0.37398
Sat Nov 13 06:47:27 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 06:47:27 2021

best accuracy so far: 0.373976
Sat Nov 13 06:47:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:48:18 2021

 train accuracy so far: 0.354883
Sat Nov 13 06:49:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:52:11 2021


Validation Results
Global Steps: 1800
Valid Loss: 5.12486
Valid Accuracy: 0.03538
Sat Nov 13 06:52:11 2021

best accuracy so far: 0.035379
Sat Nov 13 06:53:32 2021

 train accuracy so far: 0.033398
Sat Nov 13 06:54:01 2021


Validation Results
Global Steps: 1400
Valid Loss: 2.36963
Valid Accuracy: 0.40416
Sat Nov 13 06:54:16 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 06:54:18 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 06:54:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:55:29 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 06:57:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 06:58:58 2021


Validation Results
Global Steps: 2000
Valid Loss: 5.13522
Valid Accuracy: 0.03538
Sat Nov 13 06:58:59 2021

best accuracy so far: 0.035379
Sat Nov 13 07:01:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:02:00 2021


Validation Results
Global Steps: 200
Valid Loss: 5.17813
Valid Accuracy: 0.03438
Sat Nov 13 07:02:01 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 07:02:01 2021

best accuracy so far: 0.034379
Sat Nov 13 07:03:18 2021

 train accuracy so far: 0.024414
Sat Nov 13 07:04:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:05:46 2021


Validation Results
Global Steps: 2200
Valid Loss: 5.12320
Valid Accuracy: 0.03538
Sat Nov 13 07:05:47 2021

best accuracy so far: 0.035379
Sat Nov 13 07:06:01 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 07:06:03 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 07:07:14 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 07:08:33 2021


Validation Results
Global Steps: 400
Valid Loss: 4.61489
Valid Accuracy: 0.11000
Sat Nov 13 07:08:34 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 07:08:34 2021

best accuracy so far: 0.110001
Sat Nov 13 07:09:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:10:41 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:14:02 2021


Validation Results
Global Steps: 200
Valid Loss: 5.58566
Valid Accuracy: 0.00873
Sat Nov 13 07:14:02 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 07:14:02 2021

best accuracy so far: 0.008728
Sat Nov 13 07:15:06 2021


Validation Results
Global Steps: 600
Valid Loss: 4.41233
Valid Accuracy: 0.10520
Sat Nov 13 07:15:07 2021

best accuracy so far: 0.110001
Sat Nov 13 07:15:23 2021

 train accuracy so far: 0.014648
Sat Nov 13 07:15:32 2021

 train accuracy so far: 0.089453
Sat Nov 13 07:16:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:17:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:20:51 2021


Validation Results
Global Steps: 400
Valid Loss: 5.18950
Valid Accuracy: 0.01632
Sat Nov 13 07:20:51 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 07:20:51 2021

best accuracy so far: 0.016324
Sat Nov 13 07:21:38 2021


Validation Results
Global Steps: 800
Valid Loss: 4.45044
Valid Accuracy: 0.10474
Sat Nov 13 07:21:39 2021

best accuracy so far: 0.110001
Sat Nov 13 07:23:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:23:20 2021

 train accuracy so far: 0.086523
Sat Nov 13 07:23:45 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:27:40 2021


Validation Results
Global Steps: 600
Valid Loss: 5.13917
Valid Accuracy: 0.03538
Sat Nov 13 07:27:41 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 07:27:41 2021

best accuracy so far: 0.035379
Sat Nov 13 07:28:07 2021

 train accuracy so far: 0.031055
Sat Nov 13 07:28:10 2021


Validation Results
Global Steps: 1000
Valid Loss: 4.57213
Valid Accuracy: 0.08335
Sat Nov 13 07:28:11 2021

best accuracy so far: 0.110001
Sat Nov 13 07:29:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:30:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:34:28 2021


Validation Results
Global Steps: 800
Valid Loss: 5.13832
Valid Accuracy: 0.03538
Sat Nov 13 07:34:29 2021

best accuracy so far: 0.035379
Sat Nov 13 07:34:42 2021


Validation Results
Global Steps: 1200
Valid Loss: 4.67083
Valid Accuracy: 0.06669
Sat Nov 13 07:34:42 2021

best accuracy so far: 0.110001
Sat Nov 13 07:34:51 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 07:34:53 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 07:36:03 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 07:36:14 2021

 train accuracy so far: 0.028516
Sat Nov 13 07:36:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:38:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:41:14 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.18420
Valid Accuracy: 0.03538
Sat Nov 13 07:41:15 2021

best accuracy so far: 0.035379
Sat Nov 13 07:42:35 2021


Validation Results
Global Steps: 200
Valid Loss: 5.01479
Valid Accuracy: 0.05896
Sat Nov 13 07:42:36 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 07:42:36 2021

best accuracy so far: 0.058965
Sat Nov 13 07:43:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:43:51 2021

 train accuracy so far: 0.043945
Sat Nov 13 07:44:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:47:52 2021


Validation Results
Global Steps: 1200
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 07:47:52 2021

best accuracy so far: 0.035379
Sat Nov 13 07:48:06 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 07:48:08 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 07:49:06 2021


Validation Results
Global Steps: 400
Valid Loss: 4.47849
Valid Accuracy: 0.08235
Sat Nov 13 07:49:07 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 07:49:07 2021

best accuracy so far: 0.082351
Sat Nov 13 07:49:19 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 07:51:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:51:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:55:38 2021


Validation Results
Global Steps: 600
Valid Loss: 4.80823
Valid Accuracy: 0.06150
Sat Nov 13 07:55:38 2021

best accuracy so far: 0.082351
Sat Nov 13 07:56:03 2021

 train accuracy so far: 0.068555
Sat Nov 13 07:56:10 2021


Validation Results
Global Steps: 200
Valid Loss: 3.58658
Valid Accuracy: 0.24679
Sat Nov 13 07:56:10 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 07:56:10 2021

best accuracy so far: 0.246785
Sat Nov 13 07:57:32 2021

 train accuracy so far: 0.156836
Sat Nov 13 07:57:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 07:58:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:02:08 2021


Validation Results
Global Steps: 800
Valid Loss: 4.82707
Valid Accuracy: 0.05497
Sat Nov 13 08:02:09 2021

best accuracy so far: 0.082351
Sat Nov 13 08:03:04 2021


Validation Results
Global Steps: 400
Valid Loss: 2.92925
Valid Accuracy: 0.29909
Sat Nov 13 08:03:04 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 08:03:04 2021

best accuracy so far: 0.299087
Sat Nov 13 08:03:49 2021

 train accuracy so far: 0.049609
Sat Nov 13 08:04:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:05:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:08:38 2021


Validation Results
Global Steps: 1000
Valid Loss: 4.86735
Valid Accuracy: 0.05050
Sat Nov 13 08:08:38 2021

best accuracy so far: 0.082351
Sat Nov 13 08:09:59 2021


Validation Results
Global Steps: 600
Valid Loss: 2.91587
Valid Accuracy: 0.26931
Sat Nov 13 08:09:59 2021

best accuracy so far: 0.299087
Sat Nov 13 08:10:27 2021

 train accuracy so far: 0.291406
Sat Nov 13 08:10:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:12:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:15:06 2021


Validation Results
Global Steps: 1200
Valid Loss: 4.99723
Valid Accuracy: 0.03258
Sat Nov 13 08:15:06 2021

best accuracy so far: 0.082351
Sat Nov 13 08:15:56 2021

 train accuracy so far: 0.036328
Sat Nov 13 08:16:53 2021


Validation Results
Global Steps: 800
Valid Loss: 2.84425
Valid Accuracy: 0.28736
Sat Nov 13 08:16:53 2021

best accuracy so far: 0.299087
Sat Nov 13 08:17:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:18:43 2021

 train accuracy so far: 0.295898
Sat Nov 13 08:19:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:21:32 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.09937
Valid Accuracy: 0.03651
Sat Nov 13 08:21:32 2021

best accuracy so far: 0.082351
Sat Nov 13 08:23:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:23:47 2021


Validation Results
Global Steps: 1000
Valid Loss: 2.56853
Valid Accuracy: 0.34399
Sat Nov 13 08:23:47 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 08:23:47 2021

best accuracy so far: 0.343994
Sat Nov 13 08:26:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:27:58 2021


Validation Results
Global Steps: 1600
Valid Loss: 5.06807
Valid Accuracy: 0.03571
Sat Nov 13 08:27:58 2021

best accuracy so far: 0.082351
Sat Nov 13 08:27:58 2021

 train accuracy so far: 0.028125
Sat Nov 13 08:30:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:30:41 2021


Validation Results
Global Steps: 1200
Valid Loss: 2.33090
Valid Accuracy: 0.37644
Sat Nov 13 08:30:51 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 08:30:54 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 08:32:06 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 08:34:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:34:22 2021


Validation Results
Global Steps: 1800
Valid Loss: 5.12801
Valid Accuracy: 0.03538
Sat Nov 13 08:34:22 2021

best accuracy so far: 0.082351
Sat Nov 13 08:35:37 2021

 train accuracy so far: 0.029297
Sat Nov 13 08:36:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:38:55 2021


Validation Results
Global Steps: 200
Valid Loss: 4.87896
Valid Accuracy: 0.07116
Sat Nov 13 08:38:55 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 08:38:55 2021

best accuracy so far: 0.071157
Sat Nov 13 08:40:17 2021

 train accuracy so far: 0.046289
Sat Nov 13 08:40:49 2021


Validation Results
Global Steps: 2000
Valid Loss: 5.13170
Valid Accuracy: 0.03538
Sat Nov 13 08:40:49 2021

best accuracy so far: 0.082351
Sat Nov 13 08:41:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:42:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:45:45 2021


Validation Results
Global Steps: 400
Valid Loss: 4.57593
Valid Accuracy: 0.07835
Sat Nov 13 08:45:46 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 08:45:46 2021

best accuracy so far: 0.078353
Sat Nov 13 08:47:15 2021


Validation Results
Global Steps: 2200
Valid Loss: 5.12925
Valid Accuracy: 0.03538
Sat Nov 13 08:47:15 2021

best accuracy so far: 0.082351
Sat Nov 13 08:47:26 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 08:47:29 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 08:48:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:48:40 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 08:50:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:52:35 2021


Validation Results
Global Steps: 600
Valid Loss: 4.86014
Valid Accuracy: 0.05890
Sat Nov 13 08:52:35 2021

best accuracy so far: 0.078353
Sat Nov 13 08:53:02 2021

 train accuracy so far: 0.053711
Sat Nov 13 08:54:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:55:13 2021


Validation Results
Global Steps: 200
Valid Loss: 5.41298
Valid Accuracy: 0.00873
Sat Nov 13 08:55:13 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 08:55:13 2021

best accuracy so far: 0.008728
Sat Nov 13 08:56:30 2021

 train accuracy so far: 0.010937
Sat Nov 13 08:57:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 08:59:25 2021


Validation Results
Global Steps: 800
Valid Loss: 5.22772
Valid Accuracy: 0.03458
Sat Nov 13 08:59:25 2021

best accuracy so far: 0.078353
Sat Nov 13 09:01:12 2021

 train accuracy so far: 0.033398
Sat Nov 13 09:01:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:01:44 2021


Validation Results
Global Steps: 400
Valid Loss: 7.16657
Valid Accuracy: 0.00320
Sat Nov 13 09:01:44 2021

best accuracy so far: 0.008728
Sat Nov 13 09:03:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:06:10 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.13684
Valid Accuracy: 0.03538
Sat Nov 13 09:06:10 2021

best accuracy so far: 0.078353
Sat Nov 13 09:08:07 2021


Validation Results
Global Steps: 600
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 09:08:07 2021

best accuracy so far: 0.008728
Sat Nov 13 09:08:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:08:31 2021

 train accuracy so far: 0.005078
Sat Nov 13 09:10:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:12:52 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.15280
Valid Accuracy: 0.03538
Sat Nov 13 09:12:52 2021

best accuracy so far: 0.078353
Sat Nov 13 09:13:45 2021

 train accuracy so far: 0.026367
Sat Nov 13 09:14:30 2021


Validation Results
Global Steps: 800
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 09:14:30 2021

best accuracy so far: 0.008728
Sat Nov 13 09:15:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:16:06 2021

 train accuracy so far: 0.006836
Sat Nov 13 09:16:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:19:34 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.18712
Valid Accuracy: 0.03538
Sat Nov 13 09:19:34 2021

best accuracy so far: 0.078353
Sat Nov 13 09:20:52 2021


Validation Results
Global Steps: 1000
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 09:20:52 2021

best accuracy so far: 0.008728
Sat Nov 13 09:21:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:22:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:26:13 2021


Validation Results
Global Steps: 1600
Valid Loss: 5.14492
Valid Accuracy: 0.03538
Sat Nov 13 09:26:13 2021

best accuracy so far: 0.078353
Sat Nov 13 09:26:13 2021

 train accuracy so far: 0.027930
Sat Nov 13 09:27:13 2021


Validation Results
Global Steps: 1200
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 09:27:14 2021

best accuracy so far: 0.008728
Sat Nov 13 09:27:22 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 09:27:24 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 09:28:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:28:33 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 09:30:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:32:58 2021


Validation Results
Global Steps: 1800
Valid Loss: 5.14047
Valid Accuracy: 0.03538
Sat Nov 13 09:32:58 2021

best accuracy so far: 0.078353
Sat Nov 13 09:33:12 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 09:33:14 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 09:34:26 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 09:35:05 2021


Validation Results
Global Steps: 200
Valid Loss: 5.28450
Valid Accuracy: 0.01752
Sat Nov 13 09:35:06 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 09:35:06 2021

best accuracy so far: 0.017523
Sat Nov 13 09:36:22 2021

 train accuracy so far: 0.023242
Sat Nov 13 09:36:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:37:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:41:21 2021


Validation Results
Global Steps: 200
Valid Loss: 3.75875
Valid Accuracy: 0.18049
Sat Nov 13 09:41:21 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 09:41:21 2021

best accuracy so far: 0.180492
Sat Nov 13 09:41:40 2021


Validation Results
Global Steps: 400
Valid Loss: 5.27954
Valid Accuracy: 0.01572
Sat Nov 13 09:41:40 2021

best accuracy so far: 0.017523
Sat Nov 13 09:42:45 2021

 train accuracy so far: 0.124609
Sat Nov 13 09:43:41 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:43:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:48:14 2021


Validation Results
Global Steps: 600
Valid Loss: 6.26067
Valid Accuracy: 0.00913
Sat Nov 13 09:48:14 2021

best accuracy so far: 0.017523
Sat Nov 13 09:48:18 2021


Validation Results
Global Steps: 400
Valid Loss: 4.81520
Valid Accuracy: 0.04924
Sat Nov 13 09:48:18 2021

best accuracy so far: 0.180492
Sat Nov 13 09:48:39 2021

 train accuracy so far: 0.016797
Sat Nov 13 09:50:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:50:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:54:48 2021


Validation Results
Global Steps: 800
Valid Loss: 5.18429
Valid Accuracy: 0.03538
Sat Nov 13 09:54:48 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 09:54:48 2021

best accuracy so far: 0.035379
Sat Nov 13 09:55:14 2021


Validation Results
Global Steps: 600
Valid Loss: 5.24843
Valid Accuracy: 0.03538
Sat Nov 13 09:55:14 2021

best accuracy so far: 0.180492
Sat Nov 13 09:55:42 2021

 train accuracy so far: 0.042188
Sat Nov 13 09:56:30 2021

 train accuracy so far: 0.014453
Sat Nov 13 09:56:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 09:57:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:01:22 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.38245
Valid Accuracy: 0.01213
Sat Nov 13 10:01:23 2021

best accuracy so far: 0.035379
Sat Nov 13 10:02:09 2021


Validation Results
Global Steps: 800
Valid Loss: 5.17721
Valid Accuracy: 0.03538
Sat Nov 13 10:02:09 2021

best accuracy so far: 0.180492
Sat Nov 13 10:03:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:03:59 2021

 train accuracy so far: 0.027539
Sat Nov 13 10:04:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:07:56 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.79848
Valid Accuracy: 0.00859
Sat Nov 13 10:07:56 2021

best accuracy so far: 0.035379
Sat Nov 13 10:08:07 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 10:08:09 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 10:09:02 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.14916
Valid Accuracy: 0.03538
Sat Nov 13 10:09:03 2021

best accuracy so far: 0.180492
Sat Nov 13 10:09:20 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 10:11:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:11:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:15:55 2021


Validation Results
Global Steps: 200
Valid Loss: 4.66874
Valid Accuracy: 0.06803
Sat Nov 13 10:15:55 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 10:15:55 2021

best accuracy so far: 0.068026
Sat Nov 13 10:15:58 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.13485
Valid Accuracy: 0.03538
Sat Nov 13 10:15:58 2021

best accuracy so far: 0.180492
Sat Nov 13 10:16:07 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 10:16:09 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 10:17:12 2021

 train accuracy so far: 0.043750
Sat Nov 13 10:17:19 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 10:18:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:19:33 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:22:27 2021


Validation Results
Global Steps: 400
Valid Loss: 4.99803
Valid Accuracy: 0.03205
Sat Nov 13 10:22:27 2021

best accuracy so far: 0.068026
Sat Nov 13 10:24:09 2021


Validation Results
Global Steps: 200
Valid Loss: 5.79121
Valid Accuracy: 0.00873
Sat Nov 13 10:24:09 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 10:24:09 2021

best accuracy so far: 0.008728
Sat Nov 13 10:24:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:25:31 2021

 train accuracy so far: 0.019727
Sat Nov 13 10:26:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:28:56 2021


Validation Results
Global Steps: 600
Valid Loss: 5.29846
Valid Accuracy: 0.01752
Sat Nov 13 10:28:56 2021

best accuracy so far: 0.068026
Sat Nov 13 10:29:21 2021

 train accuracy so far: 0.032031
Sat Nov 13 10:31:01 2021


Validation Results
Global Steps: 400
Valid Loss: 5.97201
Valid Accuracy: 0.01572
Sat Nov 13 10:31:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:31:02 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 10:31:02 2021

best accuracy so far: 0.015724
Sat Nov 13 10:33:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:35:23 2021


Validation Results
Global Steps: 800
Valid Loss: 5.17523
Valid Accuracy: 0.01472
Sat Nov 13 10:35:23 2021

best accuracy so far: 0.068026
Sat Nov 13 10:37:04 2021

 train accuracy so far: 0.024805
Sat Nov 13 10:37:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:37:55 2021


Validation Results
Global Steps: 600
Valid Loss: 5.36202
Valid Accuracy: 0.01712
Sat Nov 13 10:37:55 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 10:37:55 2021

best accuracy so far: 0.017123
Sat Nov 13 10:38:22 2021

 train accuracy so far: 0.014258
Sat Nov 13 10:40:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:41:51 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.19037
Valid Accuracy: 0.03538
Sat Nov 13 10:41:51 2021

best accuracy so far: 0.068026
Sat Nov 13 10:43:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:44:47 2021


Validation Results
Global Steps: 800
Valid Loss: 5.36155
Valid Accuracy: 0.03538
Sat Nov 13 10:44:47 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 10:44:47 2021

best accuracy so far: 0.035379
Sat Nov 13 10:46:36 2021

 train accuracy so far: 0.016797
Sat Nov 13 10:47:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:48:18 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.19960
Valid Accuracy: 0.03538
Sat Nov 13 10:48:18 2021

best accuracy so far: 0.068026
Sat Nov 13 10:48:32 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 10:48:35 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 10:49:45 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 10:51:41 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.33123
Valid Accuracy: 0.00859
Sat Nov 13 10:51:41 2021

best accuracy so far: 0.035379
Sat Nov 13 10:51:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:53:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:56:18 2021


Validation Results
Global Steps: 200
Valid Loss: 5.08243
Valid Accuracy: 0.05570
Sat Nov 13 10:56:19 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 10:56:19 2021

best accuracy so far: 0.055700
Sat Nov 13 10:57:35 2021

 train accuracy so far: 0.037500
Sat Nov 13 10:58:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 10:58:34 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.23926
Valid Accuracy: 0.03538
Sat Nov 13 10:58:34 2021

best accuracy so far: 0.035379
Sat Nov 13 10:59:28 2021

 train accuracy so far: 0.014648
Sat Nov 13 11:00:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:02:52 2021


Validation Results
Global Steps: 400
Valid Loss: 4.39865
Valid Accuracy: 0.10760
Sat Nov 13 11:02:53 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 11:02:53 2021

best accuracy so far: 0.107602
Sat Nov 13 11:05:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:05:24 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.28330
Valid Accuracy: 0.01213
Sat Nov 13 11:05:24 2021

best accuracy so far: 0.035379
Sat Nov 13 11:05:32 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 11:05:35 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 11:06:45 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 11:08:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:09:25 2021


Validation Results
Global Steps: 600
Valid Loss: 4.76042
Valid Accuracy: 0.06603
Sat Nov 13 11:09:25 2021

best accuracy so far: 0.107602
Sat Nov 13 11:09:50 2021

 train accuracy so far: 0.085156
Sat Nov 13 11:11:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:13:37 2021


Validation Results
Global Steps: 200
Valid Loss: 5.29487
Valid Accuracy: 0.00886
Sat Nov 13 11:13:37 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 11:13:37 2021

best accuracy so far: 0.008861
Sat Nov 13 11:14:59 2021

 train accuracy so far: 0.014258
Sat Nov 13 11:15:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:15:57 2021


Validation Results
Global Steps: 800
Valid Loss: 4.68457
Valid Accuracy: 0.06943
Sat Nov 13 11:15:58 2021

best accuracy so far: 0.107602
Sat Nov 13 11:17:39 2021

 train accuracy so far: 0.058984
Sat Nov 13 11:18:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:20:32 2021


Validation Results
Global Steps: 400
Valid Loss: 5.12403
Valid Accuracy: 0.04191
Sat Nov 13 11:20:33 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 11:20:33 2021

best accuracy so far: 0.041908
Sat Nov 13 11:22:30 2021


Validation Results
Global Steps: 1000
Valid Loss: 4.77665
Valid Accuracy: 0.05690
Sat Nov 13 11:22:31 2021

best accuracy so far: 0.107602
Sat Nov 13 11:22:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:24:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:27:27 2021


Validation Results
Global Steps: 600
Valid Loss: 4.76069
Valid Accuracy: 0.08855
Sat Nov 13 11:27:28 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 11:27:28 2021

best accuracy so far: 0.088547
Sat Nov 13 11:27:55 2021

 train accuracy so far: 0.049023
Sat Nov 13 11:29:03 2021


Validation Results
Global Steps: 1200
Valid Loss: 4.93865
Valid Accuracy: 0.04564
Sat Nov 13 11:29:04 2021

best accuracy so far: 0.107602
Sat Nov 13 11:29:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:29:54 2021

 train accuracy so far: 0.049414
Sat Nov 13 11:31:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:34:21 2021


Validation Results
Global Steps: 800
Valid Loss: 4.25864
Valid Accuracy: 0.16397
Sat Nov 13 11:34:21 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 11:34:21 2021

best accuracy so far: 0.163968
Sat Nov 13 11:35:36 2021


Validation Results
Global Steps: 1400
Valid Loss: 4.93297
Valid Accuracy: 0.04850
Sat Nov 13 11:35:36 2021

best accuracy so far: 0.107602
Sat Nov 13 11:35:48 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 11:35:50 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 11:36:10 2021

 train accuracy so far: 0.164453
Sat Nov 13 11:36:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:37:00 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 11:39:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:41:14 2021


Validation Results
Global Steps: 1000
Valid Loss: 3.69367
Valid Accuracy: 0.24086
Sat Nov 13 11:41:14 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 11:41:14 2021

best accuracy so far: 0.240855
Sat Nov 13 11:43:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:43:33 2021


Validation Results
Global Steps: 200
Valid Loss: 5.18647
Valid Accuracy: 0.02558
Sat Nov 13 11:43:33 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 11:43:33 2021

best accuracy so far: 0.025585
Sat Nov 13 11:44:49 2021

 train accuracy so far: 0.025391
Sat Nov 13 11:45:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:48:06 2021


Validation Results
Global Steps: 1200
Valid Loss: 3.18548
Valid Accuracy: 0.31494
Sat Nov 13 11:48:07 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 11:48:07 2021

best accuracy so far: 0.314944
Sat Nov 13 11:49:01 2021

 train accuracy so far: 0.280664
Sat Nov 13 11:50:02 2021


Validation Results
Global Steps: 400
Valid Loss: 5.30008
Valid Accuracy: 0.00993
Sat Nov 13 11:50:03 2021

best accuracy so far: 0.025585
Sat Nov 13 11:50:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:52:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:55:00 2021


Validation Results
Global Steps: 1400
Valid Loss: 2.78853
Valid Accuracy: 0.37338
Sat Nov 13 11:55:00 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 11:55:00 2021

best accuracy so far: 0.373376
Sat Nov 13 11:56:29 2021


Validation Results
Global Steps: 600
Valid Loss: 5.30196
Valid Accuracy: 0.01712
Sat Nov 13 11:56:29 2021

best accuracy so far: 0.025585
Sat Nov 13 11:56:54 2021

 train accuracy so far: 0.024609
Sat Nov 13 11:57:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 11:58:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:01:53 2021


Validation Results
Global Steps: 1600
Valid Loss: 2.50794
Valid Accuracy: 0.42221
Sat Nov 13 12:02:03 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 12:02:05 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 12:02:56 2021


Validation Results
Global Steps: 800
Valid Loss: 5.29153
Valid Accuracy: 0.01213
Sat Nov 13 12:02:56 2021

best accuracy so far: 0.025585
Sat Nov 13 12:03:15 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 12:04:36 2021

 train accuracy so far: 0.013281
Sat Nov 13 12:05:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:05:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:09:23 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.25368
Valid Accuracy: 0.03538
Sat Nov 13 12:09:24 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 12:09:24 2021

best accuracy so far: 0.035379
Sat Nov 13 12:10:06 2021


Validation Results
Global Steps: 200
Valid Loss: 5.10797
Valid Accuracy: 0.02592
Sat Nov 13 12:10:07 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 12:10:07 2021

best accuracy so far: 0.025918
Sat Nov 13 12:11:28 2021

 train accuracy so far: 0.025195
Sat Nov 13 12:11:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:12:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:15:49 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.26500
Valid Accuracy: 0.03538
Sat Nov 13 12:15:50 2021

best accuracy so far: 0.035379
Sat Nov 13 12:16:40 2021

 train accuracy so far: 0.019922
Sat Nov 13 12:16:57 2021


Validation Results
Global Steps: 400
Valid Loss: 5.41968
Valid Accuracy: 0.00826
Sat Nov 13 12:16:58 2021

best accuracy so far: 0.025918
Sat Nov 13 12:17:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:19:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:22:15 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.45771
Valid Accuracy: 0.00873
Sat Nov 13 12:22:15 2021

best accuracy so far: 0.035379
Sat Nov 13 12:22:28 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 12:22:30 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 12:23:43 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 12:23:48 2021


Validation Results
Global Steps: 600
Valid Loss: 5.37142
Valid Accuracy: 0.01712
Sat Nov 13 12:23:48 2021

best accuracy so far: 0.025918
Sat Nov 13 12:24:14 2021

 train accuracy so far: 0.016602
Sat Nov 13 12:25:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:26:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:30:20 2021


Validation Results
Global Steps: 200
Valid Loss: 3.47520
Valid Accuracy: 0.22673
Sat Nov 13 12:30:21 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 12:30:21 2021

best accuracy so far: 0.226731
Sat Nov 13 12:30:38 2021


Validation Results
Global Steps: 800
Valid Loss: 5.21177
Valid Accuracy: 0.03538
Sat Nov 13 12:30:39 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 12:30:39 2021

best accuracy so far: 0.035379
Sat Nov 13 12:31:39 2021

 train accuracy so far: 0.124609
Sat Nov 13 12:32:27 2021

 train accuracy so far: 0.015430
Sat Nov 13 12:32:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:32:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:36:59 2021


Validation Results
Global Steps: 400
Valid Loss: 5.55801
Valid Accuracy: 0.01632
Sat Nov 13 12:36:59 2021

best accuracy so far: 0.226731
Sat Nov 13 12:37:30 2021


Validation Results
Global Steps: 1000
Valid Loss: 6.04913
Valid Accuracy: 0.00533
Sat Nov 13 12:37:31 2021

best accuracy so far: 0.035379
Sat Nov 13 12:39:09 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:39:45 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:43:36 2021


Validation Results
Global Steps: 600
Valid Loss: 5.18600
Valid Accuracy: 0.01712
Sat Nov 13 12:43:36 2021

best accuracy so far: 0.226731
Sat Nov 13 12:44:02 2021

 train accuracy so far: 0.030078
Sat Nov 13 12:44:21 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.89899
Valid Accuracy: 0.00453
Sat Nov 13 12:44:21 2021

best accuracy so far: 0.035379
Sat Nov 13 12:45:15 2021

 train accuracy so far: 0.019922
Sat Nov 13 12:45:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:46:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:50:11 2021


Validation Results
Global Steps: 800
Valid Loss: 5.26646
Valid Accuracy: 0.03538
Sat Nov 13 12:50:11 2021

best accuracy so far: 0.226731
Sat Nov 13 12:51:09 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.28035
Valid Accuracy: 0.03538
Sat Nov 13 12:51:09 2021

best accuracy so far: 0.035379
Sat Nov 13 12:51:18 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 12:51:20 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 12:51:56 2021

 train accuracy so far: 0.023438
Sat Nov 13 12:52:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:52:30 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 12:54:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:56:46 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.18133
Valid Accuracy: 0.01472
Sat Nov 13 12:56:47 2021

best accuracy so far: 0.226731
Sat Nov 13 12:58:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 12:59:20 2021


Validation Results
Global Steps: 200
Valid Loss: 5.79121
Valid Accuracy: 0.00873
Sat Nov 13 12:59:21 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 12:59:21 2021

best accuracy so far: 0.008728
Sat Nov 13 13:00:45 2021

 train accuracy so far: 0.019727
Sat Nov 13 13:01:23 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 13:01:26 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 13:01:41 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:02:38 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 13:04:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:06:14 2021


Validation Results
Global Steps: 400
Valid Loss: 5.97201
Valid Accuracy: 0.01572
Sat Nov 13 13:06:15 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 13:06:15 2021

best accuracy so far: 0.015724
Sat Nov 13 13:08:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:09:12 2021


Validation Results
Global Steps: 200
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 13:09:12 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 13:09:12 2021

best accuracy so far: 0.006863
Sat Nov 13 13:10:26 2021

 train accuracy so far: 0.009766
Sat Nov 13 13:11:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:13:05 2021


Validation Results
Global Steps: 600
Valid Loss: 5.36202
Valid Accuracy: 0.01712
Sat Nov 13 13:13:06 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 13:13:06 2021

best accuracy so far: 0.017123
Sat Nov 13 13:13:33 2021

 train accuracy so far: 0.014258
Sat Nov 13 13:15:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:15:40 2021


Validation Results
Global Steps: 400
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 13:15:41 2021

best accuracy so far: 0.006863
Sat Nov 13 13:17:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:19:54 2021


Validation Results
Global Steps: 800
Valid Loss: 5.36155
Valid Accuracy: 0.03538
Sat Nov 13 13:19:55 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 13:19:55 2021

best accuracy so far: 0.035379
Sat Nov 13 13:21:43 2021

 train accuracy so far: 0.016797
Sat Nov 13 13:22:04 2021


Validation Results
Global Steps: 600
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 13:22:04 2021

best accuracy so far: 0.006863
Sat Nov 13 13:22:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:22:28 2021

 train accuracy so far: 0.007422
Sat Nov 13 13:24:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:26:43 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.33123
Valid Accuracy: 0.00859
Sat Nov 13 13:26:44 2021

best accuracy so far: 0.035379
Sat Nov 13 13:28:25 2021


Validation Results
Global Steps: 800
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 13:28:26 2021

best accuracy so far: 0.006863
Sat Nov 13 13:28:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:30:02 2021

 train accuracy so far: 0.006836
Sat Nov 13 13:30:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:33:33 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.23926
Valid Accuracy: 0.03538
Sat Nov 13 13:33:34 2021

best accuracy so far: 0.035379
Sat Nov 13 13:33:43 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 13:33:46 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 13:34:48 2021


Validation Results
Global Steps: 1000
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 13:34:48 2021

best accuracy so far: 0.006863
Sat Nov 13 13:34:55 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 13:36:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:37:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:41:11 2021


Validation Results
Global Steps: 1200
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 13:41:11 2021

best accuracy so far: 0.006863
Sat Nov 13 13:41:18 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 13:41:21 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 13:41:44 2021


Validation Results
Global Steps: 200
Valid Loss: 5.58566
Valid Accuracy: 0.00873
Sat Nov 13 13:41:45 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 13:41:45 2021

best accuracy so far: 0.008728
Sat Nov 13 13:42:32 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 13:43:05 2021

 train accuracy so far: 0.014648
Sat Nov 13 13:43:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:44:41 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:48:33 2021


Validation Results
Global Steps: 400
Valid Loss: 5.18950
Valid Accuracy: 0.01632
Sat Nov 13 13:48:34 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 13:48:34 2021

best accuracy so far: 0.016324
Sat Nov 13 13:49:08 2021


Validation Results
Global Steps: 200
Valid Loss: 3.75875
Valid Accuracy: 0.18049
Sat Nov 13 13:49:08 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 13:49:08 2021

best accuracy so far: 0.180492
Sat Nov 13 13:50:26 2021

 train accuracy so far: 0.124609
Sat Nov 13 13:50:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:51:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:55:25 2021


Validation Results
Global Steps: 600
Valid Loss: 5.13917
Valid Accuracy: 0.03538
Sat Nov 13 13:55:25 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 13:55:25 2021

best accuracy so far: 0.035379
Sat Nov 13 13:55:45 2021


Validation Results
Global Steps: 400
Valid Loss: 4.81520
Valid Accuracy: 0.04924
Sat Nov 13 13:55:45 2021

best accuracy so far: 0.180492
Sat Nov 13 13:55:52 2021

 train accuracy so far: 0.031055
Sat Nov 13 13:57:41 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 13:57:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:02:18 2021


Validation Results
Global Steps: 800
Valid Loss: 5.13832
Valid Accuracy: 0.03538
Sat Nov 13 14:02:18 2021

best accuracy so far: 0.035379
Sat Nov 13 14:02:24 2021


Validation Results
Global Steps: 600
Valid Loss: 5.24843
Valid Accuracy: 0.03538
Sat Nov 13 14:02:24 2021

best accuracy so far: 0.180492
Sat Nov 13 14:02:50 2021

 train accuracy so far: 0.042188
Sat Nov 13 14:04:05 2021

 train accuracy so far: 0.028516
Sat Nov 13 14:04:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:04:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:09:02 2021


Validation Results
Global Steps: 800
Valid Loss: 5.17721
Valid Accuracy: 0.03538
Sat Nov 13 14:09:03 2021

best accuracy so far: 0.180492
Sat Nov 13 14:09:08 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.18420
Valid Accuracy: 0.03538
Sat Nov 13 14:09:08 2021

best accuracy so far: 0.035379
Sat Nov 13 14:10:47 2021

 train accuracy so far: 0.027539
Sat Nov 13 14:11:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:11:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:15:40 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.14916
Valid Accuracy: 0.03538
Sat Nov 13 14:15:40 2021

best accuracy so far: 0.180492
Sat Nov 13 14:15:46 2021


Validation Results
Global Steps: 1200
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:15:47 2021

best accuracy so far: 0.035379
Sat Nov 13 14:15:59 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 14:16:01 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 14:17:10 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 14:17:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:19:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:22:18 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.13485
Valid Accuracy: 0.03538
Sat Nov 13 14:22:19 2021

best accuracy so far: 0.180492
Sat Nov 13 14:22:29 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 14:22:31 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 14:23:43 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 14:23:59 2021


Validation Results
Global Steps: 200
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:24:00 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 14:24:00 2021

best accuracy so far: 0.006863
Sat Nov 13 14:25:17 2021

 train accuracy so far: 0.009766
Sat Nov 13 14:25:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:26:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:30:17 2021


Validation Results
Global Steps: 200
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:30:17 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 14:30:17 2021

best accuracy so far: 0.006863
Sat Nov 13 14:30:45 2021


Validation Results
Global Steps: 400
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:30:45 2021

best accuracy so far: 0.006863
Sat Nov 13 14:31:31 2021

 train accuracy so far: 0.008008
Sat Nov 13 14:32:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:32:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:36:47 2021


Validation Results
Global Steps: 400
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:36:48 2021

best accuracy so far: 0.006863
Sat Nov 13 14:37:21 2021


Validation Results
Global Steps: 600
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:37:22 2021

best accuracy so far: 0.006863
Sat Nov 13 14:37:46 2021

 train accuracy so far: 0.007422
Sat Nov 13 14:38:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:39:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:43:18 2021


Validation Results
Global Steps: 600
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:43:18 2021

best accuracy so far: 0.006863
Sat Nov 13 14:43:43 2021

 train accuracy so far: 0.006641
Sat Nov 13 14:43:57 2021


Validation Results
Global Steps: 800
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:43:57 2021

best accuracy so far: 0.006863
Sat Nov 13 14:45:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:45:38 2021

 train accuracy so far: 0.006836
Sat Nov 13 14:46:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:49:48 2021


Validation Results
Global Steps: 800
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:49:49 2021

best accuracy so far: 0.006863
Sat Nov 13 14:50:35 2021


Validation Results
Global Steps: 1000
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:50:35 2021

best accuracy so far: 0.006863
Sat Nov 13 14:51:28 2021

 train accuracy so far: 0.005859
Sat Nov 13 14:51:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:52:41 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:56:19 2021


Validation Results
Global Steps: 1000
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:56:20 2021

best accuracy so far: 0.006863
Sat Nov 13 14:57:11 2021


Validation Results
Global Steps: 1200
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 14:57:12 2021

best accuracy so far: 0.006863
Sat Nov 13 14:57:24 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 14:57:26 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 14:58:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 14:58:36 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 15:00:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:02:51 2021


Validation Results
Global Steps: 1200
Valid Loss: nan
Valid Accuracy: 0.00686
Sat Nov 13 15:02:51 2021

best accuracy so far: 0.006863
Sat Nov 13 15:03:04 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 15:03:06 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 15:04:19 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 15:05:27 2021


Validation Results
Global Steps: 200
Valid Loss: 5.79121
Valid Accuracy: 0.00873
Sat Nov 13 15:05:27 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 15:05:27 2021

best accuracy so far: 0.008728
Sat Nov 13 15:06:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:06:49 2021

 train accuracy so far: 0.019727
Sat Nov 13 15:07:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:10:56 2021


Validation Results
Global Steps: 200
Valid Loss: 4.79656
Valid Accuracy: 0.04810
Sat Nov 13 15:10:57 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 15:10:57 2021

best accuracy so far: 0.048104
Sat Nov 13 15:12:15 2021

 train accuracy so far: 0.042578
Sat Nov 13 15:12:20 2021


Validation Results
Global Steps: 400
Valid Loss: 5.97201
Valid Accuracy: 0.01572
Sat Nov 13 15:12:21 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 15:12:21 2021

best accuracy so far: 0.015724
Sat Nov 13 15:13:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:14:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:17:34 2021


Validation Results
Global Steps: 400
Valid Loss: 5.23019
Valid Accuracy: 0.01539
Sat Nov 13 15:17:34 2021

best accuracy so far: 0.048104
Sat Nov 13 15:19:12 2021


Validation Results
Global Steps: 600
Valid Loss: 5.36202
Valid Accuracy: 0.01712
Sat Nov 13 15:19:13 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 15:19:13 2021

best accuracy so far: 0.017123
Sat Nov 13 15:19:40 2021

 train accuracy so far: 0.014258
Sat Nov 13 15:19:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:21:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:24:09 2021


Validation Results
Global Steps: 600
Valid Loss: 5.19383
Valid Accuracy: 0.03538
Sat Nov 13 15:24:09 2021

best accuracy so far: 0.048104
Sat Nov 13 15:24:35 2021

 train accuracy so far: 0.025000
Sat Nov 13 15:26:09 2021


Validation Results
Global Steps: 800
Valid Loss: 5.36155
Valid Accuracy: 0.03538
Sat Nov 13 15:26:10 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 15:26:10 2021

best accuracy so far: 0.035379
Sat Nov 13 15:26:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:27:59 2021

 train accuracy so far: 0.016797
Sat Nov 13 15:28:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:30:40 2021


Validation Results
Global Steps: 800
Valid Loss: 5.20355
Valid Accuracy: 0.01712
Sat Nov 13 15:30:41 2021

best accuracy so far: 0.048104
Sat Nov 13 15:32:21 2021

 train accuracy so far: 0.024805
Sat Nov 13 15:32:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:33:02 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.33123
Valid Accuracy: 0.00859
Sat Nov 13 15:33:03 2021

best accuracy so far: 0.035379
Sat Nov 13 15:35:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:37:10 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.30306
Valid Accuracy: 0.01472
Sat Nov 13 15:37:11 2021

best accuracy so far: 0.048104
Sat Nov 13 15:39:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:39:56 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.23926
Valid Accuracy: 0.03538
Sat Nov 13 15:39:56 2021

best accuracy so far: 0.035379
Sat Nov 13 15:40:09 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 15:40:11 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 15:41:22 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 15:43:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:43:38 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.37906
Valid Accuracy: 0.03538
Sat Nov 13 15:43:38 2021

best accuracy so far: 0.048104
Sat Nov 13 15:43:49 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 15:43:52 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 15:45:06 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 15:47:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:48:17 2021


Validation Results
Global Steps: 200
Valid Loss: 4.59840
Valid Accuracy: 0.08502
Sat Nov 13 15:48:18 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 15:48:18 2021

best accuracy so far: 0.085016
Sat Nov 13 15:49:40 2021

 train accuracy so far: 0.052344
Sat Nov 13 15:50:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:51:44 2021


Validation Results
Global Steps: 200
Valid Loss: 4.87270
Valid Accuracy: 0.07389
Sat Nov 13 15:51:45 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 15:51:45 2021

best accuracy so far: 0.073889
Sat Nov 13 15:53:02 2021

 train accuracy so far: 0.055469
Sat Nov 13 15:53:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:55:13 2021


Validation Results
Global Steps: 400
Valid Loss: 4.83744
Valid Accuracy: 0.05170
Sat Nov 13 15:55:13 2021

best accuracy so far: 0.085016
Sat Nov 13 15:57:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 15:58:25 2021


Validation Results
Global Steps: 400
Valid Loss: 3.17419
Valid Accuracy: 0.25518
Sat Nov 13 15:58:26 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 15:58:26 2021

best accuracy so far: 0.255180
Sat Nov 13 16:00:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:02:07 2021


Validation Results
Global Steps: 600
Valid Loss: 5.16290
Valid Accuracy: 0.03478
Sat Nov 13 16:02:07 2021

best accuracy so far: 0.085016
Sat Nov 13 16:02:34 2021

 train accuracy so far: 0.035156
Sat Nov 13 16:04:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:05:06 2021


Validation Results
Global Steps: 600
Valid Loss: 2.21646
Valid Accuracy: 0.41149
Sat Nov 13 16:05:07 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 16:05:07 2021

best accuracy so far: 0.411486
Sat Nov 13 16:05:33 2021

 train accuracy so far: 0.281055
Sat Nov 13 16:07:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:08:55 2021


Validation Results
Global Steps: 800
Valid Loss: 5.15828
Valid Accuracy: 0.03538
Sat Nov 13 16:08:56 2021

best accuracy so far: 0.085016
Sat Nov 13 16:10:43 2021

 train accuracy so far: 0.029492
Sat Nov 13 16:11:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:11:46 2021


Validation Results
Global Steps: 800
Valid Loss: 1.85287
Valid Accuracy: 0.47598
Sat Nov 13 16:11:47 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 16:11:47 2021

best accuracy so far: 0.475981
Sat Nov 13 16:13:31 2021

 train accuracy so far: 0.496875
Sat Nov 13 16:13:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:15:45 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.18635
Valid Accuracy: 0.03538
Sat Nov 13 16:15:45 2021

best accuracy so far: 0.085016
Sat Nov 13 16:18:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:18:28 2021


Validation Results
Global Steps: 1000
Valid Loss: 1.56315
Valid Accuracy: 0.54434
Sat Nov 13 16:18:28 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 16:18:28 2021

best accuracy so far: 0.544340
Sat Nov 13 16:20:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:22:35 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.16140
Valid Accuracy: 0.03538
Sat Nov 13 16:22:35 2021

best accuracy so far: 0.085016
Sat Nov 13 16:22:45 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 16:22:47 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 16:23:59 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 16:25:09 2021


Validation Results
Global Steps: 1200
Valid Loss: 1.30351
Valid Accuracy: 0.61643
Sat Nov 13 16:25:10 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 16:25:10 2021

best accuracy so far: 0.616430
Sat Nov 13 16:26:01 2021

 train accuracy so far: 0.615039
Sat Nov 13 16:26:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:27:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:30:51 2021


Validation Results
Global Steps: 200
Valid Loss: 5.09759
Valid Accuracy: 0.02978
Sat Nov 13 16:30:52 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 16:30:52 2021

best accuracy so far: 0.029782
Sat Nov 13 16:31:51 2021


Validation Results
Global Steps: 1400
Valid Loss: 1.33638
Valid Accuracy: 0.61423
Sat Nov 13 16:31:52 2021

best accuracy so far: 0.616430
Sat Nov 13 16:32:13 2021

 train accuracy so far: 0.029297
Sat Nov 13 16:33:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:34:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:37:43 2021


Validation Results
Global Steps: 400
Valid Loss: 5.21279
Valid Accuracy: 0.01306
Sat Nov 13 16:37:43 2021

best accuracy so far: 0.029782
Sat Nov 13 16:38:34 2021


Validation Results
Global Steps: 1600
Valid Loss: 1.20025
Valid Accuracy: 0.65228
Sat Nov 13 16:38:34 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 16:38:34 2021

best accuracy so far: 0.652275
Sat Nov 13 16:38:34 2021

 train accuracy so far: 0.684961
Sat Nov 13 16:39:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:40:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:44:30 2021


Validation Results
Global Steps: 600
Valid Loss: 6.17077
Valid Accuracy: 0.03538
Sat Nov 13 16:44:30 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 16:44:30 2021

best accuracy so far: 0.035379
Sat Nov 13 16:44:57 2021

 train accuracy so far: 0.018359
Sat Nov 13 16:45:14 2021


Validation Results
Global Steps: 1800
Valid Loss: 1.16853
Valid Accuracy: 0.65934
Sat Nov 13 16:45:14 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 16:45:14 2021

best accuracy so far: 0.659338
Sat Nov 13 16:46:31 2021

 train accuracy so far: 0.746875
Sat Nov 13 16:46:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:47:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:51:14 2021


Validation Results
Global Steps: 800
Valid Loss: 5.22750
Valid Accuracy: 0.01712
Sat Nov 13 16:51:14 2021

best accuracy so far: 0.035379
Sat Nov 13 16:51:53 2021


Validation Results
Global Steps: 2000
Valid Loss: 1.19603
Valid Accuracy: 0.67073
Sat Nov 13 16:51:54 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 16:51:54 2021

best accuracy so far: 0.670731
Sat Nov 13 16:53:00 2021

 train accuracy so far: 0.018555
Sat Nov 13 16:53:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:54:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 16:57:58 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.76988
Valid Accuracy: 0.01712
Sat Nov 13 16:57:58 2021

best accuracy so far: 0.035379
Sat Nov 13 16:58:35 2021


Validation Results
Global Steps: 2200
Valid Loss: 1.08188
Valid Accuracy: 0.68639
Sat Nov 13 16:58:35 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 16:58:35 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 16:58:35 2021

best accuracy so far: 0.686388
Sat Nov 13 16:58:37 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 16:59:01 2021

 train accuracy so far: 0.783594
Sat Nov 13 16:59:47 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 17:00:45 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:02:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:05:17 2021


Validation Results
Global Steps: 2400
Valid Loss: 1.13100
Valid Accuracy: 0.68586
Sat Nov 13 17:05:17 2021

best accuracy so far: 0.686388
Sat Nov 13 17:06:40 2021


Validation Results
Global Steps: 200
Valid Loss: 4.79923
Valid Accuracy: 0.05277
Sat Nov 13 17:06:40 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 17:06:40 2021

best accuracy so far: 0.052768
Sat Nov 13 17:07:01 2021

 train accuracy so far: 0.815039
Sat Nov 13 17:07:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:08:02 2021

 train accuracy so far: 0.043945
Sat Nov 13 17:08:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:11:57 2021


Validation Results
Global Steps: 2600
Valid Loss: 1.08229
Valid Accuracy: 0.70484
Sat Nov 13 17:11:58 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 17:11:58 2021

best accuracy so far: 0.704844
Sat Nov 13 17:13:31 2021


Validation Results
Global Steps: 400
Valid Loss: 5.08705
Valid Accuracy: 0.03505
Sat Nov 13 17:13:32 2021

best accuracy so far: 0.052768
Sat Nov 13 17:14:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:15:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:18:39 2021


Validation Results
Global Steps: 2800
Valid Loss: 0.98886
Valid Accuracy: 0.72823
Sat Nov 13 17:18:39 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 17:18:39 2021

best accuracy so far: 0.728230
Sat Nov 13 17:19:31 2021

 train accuracy so far: 0.848828
Sat Nov 13 17:20:20 2021


Validation Results
Global Steps: 600
Valid Loss: 5.28030
Valid Accuracy: 0.01566
Sat Nov 13 17:20:20 2021

best accuracy so far: 0.052768
Sat Nov 13 17:20:46 2021

 train accuracy so far: 0.023633
Sat Nov 13 17:20:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:22:33 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:25:20 2021


Validation Results
Global Steps: 3000
Valid Loss: 1.07350
Valid Accuracy: 0.71777
Sat Nov 13 17:25:21 2021

best accuracy so far: 0.728230
Sat Nov 13 17:27:09 2021


Validation Results
Global Steps: 800
Valid Loss: 5.17986
Valid Accuracy: 0.03505
Sat Nov 13 17:27:09 2021

best accuracy so far: 0.052768
Sat Nov 13 17:27:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:28:55 2021

 train accuracy so far: 0.023828
Sat Nov 13 17:29:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:32:01 2021


Validation Results
Global Steps: 3200
Valid Loss: 0.97196
Valid Accuracy: 0.74096
Sat Nov 13 17:32:02 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 17:32:02 2021

best accuracy so far: 0.740955
Sat Nov 13 17:32:02 2021

 train accuracy so far: 0.861523
Sat Nov 13 17:33:54 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.18981
Valid Accuracy: 0.03538
Sat Nov 13 17:33:55 2021

best accuracy so far: 0.052768
Sat Nov 13 17:34:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:36:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:38:40 2021


Validation Results
Global Steps: 3400
Valid Loss: 0.96906
Valid Accuracy: 0.74755
Sat Nov 13 17:38:41 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 17:38:41 2021

best accuracy so far: 0.747551
Sat Nov 13 17:39:58 2021

 train accuracy so far: 0.885156
Sat Nov 13 17:40:41 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.24329
Valid Accuracy: 0.03538
Sat Nov 13 17:40:42 2021

best accuracy so far: 0.052768
Sat Nov 13 17:40:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:40:55 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 17:40:58 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 17:42:10 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 17:44:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:45:20 2021


Validation Results
Global Steps: 3600
Valid Loss: 1.05837
Valid Accuracy: 0.73349
Sat Nov 13 17:45:21 2021

best accuracy so far: 0.747551
Sat Nov 13 17:47:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:49:07 2021


Validation Results
Global Steps: 200
Valid Loss: 3.47520
Valid Accuracy: 0.22673
Sat Nov 13 17:49:08 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 17:49:08 2021

best accuracy so far: 0.226731
Sat Nov 13 17:50:31 2021

 train accuracy so far: 0.124609
Sat Nov 13 17:51:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:52:02 2021


Validation Results
Global Steps: 3800
Valid Loss: 1.09813
Valid Accuracy: 0.72830
Sat Nov 13 17:52:02 2021

best accuracy so far: 0.747551
Sat Nov 13 17:52:28 2021

 train accuracy so far: 0.902734
Sat Nov 13 17:54:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:56:04 2021


Validation Results
Global Steps: 400
Valid Loss: 5.55801
Valid Accuracy: 0.01632
Sat Nov 13 17:56:04 2021

best accuracy so far: 0.226731
Sat Nov 13 17:58:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 17:58:42 2021


Validation Results
Global Steps: 4000
Valid Loss: 1.03326
Valid Accuracy: 0.74116
Sat Nov 13 17:58:42 2021

best accuracy so far: 0.747551
Sat Nov 13 18:00:25 2021

 train accuracy so far: 0.920117
Sat Nov 13 18:00:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:03:01 2021


Validation Results
Global Steps: 600
Valid Loss: 5.18600
Valid Accuracy: 0.01712
Sat Nov 13 18:03:01 2021

best accuracy so far: 0.226731
Sat Nov 13 18:03:29 2021

 train accuracy so far: 0.030078
Sat Nov 13 18:05:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:05:21 2021


Validation Results
Global Steps: 4200
Valid Loss: 1.05342
Valid Accuracy: 0.74649
Sat Nov 13 18:05:21 2021

best accuracy so far: 0.747551
Sat Nov 13 18:07:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:09:58 2021


Validation Results
Global Steps: 800
Valid Loss: 5.26646
Valid Accuracy: 0.03538
Sat Nov 13 18:09:58 2021

best accuracy so far: 0.226731
Sat Nov 13 18:11:47 2021

 train accuracy so far: 0.023438
Sat Nov 13 18:12:01 2021


Validation Results
Global Steps: 4400
Valid Loss: 1.09280
Valid Accuracy: 0.74269
Sat Nov 13 18:12:01 2021

best accuracy so far: 0.747551
Sat Nov 13 18:12:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:12:53 2021

 train accuracy so far: 0.935547
Sat Nov 13 18:14:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:16:52 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.18133
Valid Accuracy: 0.01472
Sat Nov 13 18:16:53 2021

best accuracy so far: 0.226731
Sat Nov 13 18:18:39 2021


Validation Results
Global Steps: 4600
Valid Loss: 1.10002
Valid Accuracy: 0.74475
Sat Nov 13 18:18:40 2021

best accuracy so far: 0.747551
Sat Nov 13 18:19:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:20:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:23:48 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.16549
Valid Accuracy: 0.03538
Sat Nov 13 18:23:48 2021

best accuracy so far: 0.226731
Sat Nov 13 18:24:00 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 18:24:03 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 18:25:13 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 18:25:17 2021


Validation Results
Global Steps: 4800
Valid Loss: 1.10079
Valid Accuracy: 0.76294
Sat Nov 13 18:25:17 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 18:25:17 2021

best accuracy so far: 0.762942
Sat Nov 13 18:25:17 2021

 train accuracy so far: 0.953516
Sat Nov 13 18:27:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:27:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:31:54 2021


Validation Results
Global Steps: 5000
Valid Loss: 1.09941
Valid Accuracy: 0.76061
Sat Nov 13 18:31:54 2021

best accuracy so far: 0.762942
Sat Nov 13 18:32:05 2021


Validation Results
Global Steps: 200
Valid Loss: 5.42942
Valid Accuracy: 0.00533
Sat Nov 13 18:32:06 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 18:32:06 2021

best accuracy so far: 0.005330
Sat Nov 13 18:33:10 2021

 train accuracy so far: 0.966406
Sat Nov 13 18:33:28 2021

 train accuracy so far: 0.013086
Sat Nov 13 18:34:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:34:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:38:30 2021


Validation Results
Global Steps: 5200
Valid Loss: 1.02626
Valid Accuracy: 0.77487
Sat Nov 13 18:38:31 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 18:38:31 2021

best accuracy so far: 0.774868
Sat Nov 13 18:38:59 2021


Validation Results
Global Steps: 400
Valid Loss: 5.18036
Valid Accuracy: 0.01572
Sat Nov 13 18:39:00 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 18:39:00 2021

best accuracy so far: 0.015724
Sat Nov 13 18:40:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:41:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:45:07 2021


Validation Results
Global Steps: 5400
Valid Loss: 1.06785
Valid Accuracy: 0.76927
Sat Nov 13 18:45:07 2021

best accuracy so far: 0.774868
Sat Nov 13 18:45:33 2021

 train accuracy so far: 0.970703
Sat Nov 13 18:45:52 2021


Validation Results
Global Steps: 600
Valid Loss: 5.15222
Valid Accuracy: 0.03538
Sat Nov 13 18:45:53 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 18:45:53 2021

best accuracy so far: 0.035379
Sat Nov 13 18:46:20 2021

 train accuracy so far: 0.029102
Sat Nov 13 18:47:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:48:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:51:43 2021


Validation Results
Global Steps: 5600
Valid Loss: 1.09424
Valid Accuracy: 0.77434
Sat Nov 13 18:51:43 2021

best accuracy so far: 0.774868
Sat Nov 13 18:52:46 2021


Validation Results
Global Steps: 800
Valid Loss: 5.13331
Valid Accuracy: 0.03538
Sat Nov 13 18:52:46 2021

best accuracy so far: 0.035379
Sat Nov 13 18:53:26 2021

 train accuracy so far: 0.982227
Sat Nov 13 18:53:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:54:35 2021

 train accuracy so far: 0.031445
Sat Nov 13 18:55:04 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 18:58:20 2021


Validation Results
Global Steps: 5800
Valid Loss: 1.03735
Valid Accuracy: 0.78600
Sat Nov 13 18:58:20 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 18:58:20 2021

best accuracy so far: 0.785995
Sat Nov 13 18:59:41 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.12729
Valid Accuracy: 0.03538
Sat Nov 13 18:59:41 2021

best accuracy so far: 0.035379
Sat Nov 13 19:00:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:01:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:04:55 2021


Validation Results
Global Steps: 6000
Valid Loss: 1.07395
Valid Accuracy: 0.78460
Sat Nov 13 19:04:55 2021

best accuracy so far: 0.785995
Sat Nov 13 19:05:46 2021

 train accuracy so far: 0.987695
Sat Nov 13 19:06:32 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.13367
Valid Accuracy: 0.03538
Sat Nov 13 19:06:33 2021

best accuracy so far: 0.035379
Sat Nov 13 19:07:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:07:27 2021

 train accuracy so far: 0.031836
Sat Nov 13 19:08:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:11:29 2021


Validation Results
Global Steps: 6200
Valid Loss: 1.03713
Valid Accuracy: 0.79232
Sat Nov 13 19:11:30 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 19:11:30 2021

best accuracy so far: 0.792325
Sat Nov 13 19:13:24 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.15254
Valid Accuracy: 0.03538
Sat Nov 13 19:13:24 2021

best accuracy so far: 0.035379
Sat Nov 13 19:13:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:15:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:18:05 2021


Validation Results
Global Steps: 6400
Valid Loss: 1.02974
Valid Accuracy: 0.79686
Sat Nov 13 19:18:05 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 19:18:05 2021

best accuracy so far: 0.796855
Sat Nov 13 19:18:05 2021

 train accuracy so far: 0.990625
Sat Nov 13 19:20:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:20:15 2021


Validation Results
Global Steps: 1600
Valid Loss: 5.12203
Valid Accuracy: 0.03538
Sat Nov 13 19:20:15 2021

best accuracy so far: 0.035379
Sat Nov 13 19:20:15 2021

 train accuracy so far: 0.031445
Sat Nov 13 19:22:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:24:39 2021


Validation Results
Global Steps: 6600
Valid Loss: 1.03183
Valid Accuracy: 0.79779
Sat Nov 13 19:24:40 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 19:24:40 2021

best accuracy so far: 0.797788
Sat Nov 13 19:25:57 2021

 train accuracy so far: 0.994141
Sat Nov 13 19:26:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:27:04 2021


Validation Results
Global Steps: 1800
Valid Loss: 5.12486
Valid Accuracy: 0.03538
Sat Nov 13 19:27:04 2021

best accuracy so far: 0.035379
Sat Nov 13 19:28:26 2021

 train accuracy so far: 0.033398
Sat Nov 13 19:29:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:31:15 2021


Validation Results
Global Steps: 6800
Valid Loss: 1.00152
Valid Accuracy: 0.80165
Sat Nov 13 19:31:15 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 19:31:15 2021

best accuracy so far: 0.801652
Sat Nov 13 19:33:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:33:55 2021


Validation Results
Global Steps: 2000
Valid Loss: 5.13522
Valid Accuracy: 0.03538
Sat Nov 13 19:33:55 2021

best accuracy so far: 0.035379
Sat Nov 13 19:36:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:37:51 2021


Validation Results
Global Steps: 7000
Valid Loss: 1.00896
Valid Accuracy: 0.80278
Sat Nov 13 19:37:51 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 19:37:51 2021

best accuracy so far: 0.802785
Sat Nov 13 19:38:16 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 19:38:18 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 19:39:30 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 19:40:46 2021


Validation Results
Global Steps: 2200
Valid Loss: 5.12320
Valid Accuracy: 0.03538
Sat Nov 13 19:40:47 2021

best accuracy so far: 0.035379
Sat Nov 13 19:41:14 2021

 train accuracy so far: 0.031250
Sat Nov 13 19:41:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:43:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:46:03 2021


Validation Results
Global Steps: 200
Valid Loss: 5.01479
Valid Accuracy: 0.05896
Sat Nov 13 19:46:03 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 19:46:03 2021

best accuracy so far: 0.058965
Sat Nov 13 19:47:20 2021

 train accuracy so far: 0.043945
Sat Nov 13 19:47:36 2021


Validation Results
Global Steps: 2400
Valid Loss: 5.16796
Valid Accuracy: 0.03538
Sat Nov 13 19:47:37 2021

best accuracy so far: 0.035379
Sat Nov 13 19:48:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:49:25 2021

 train accuracy so far: 0.033984
Sat Nov 13 19:49:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:52:37 2021


Validation Results
Global Steps: 400
Valid Loss: 4.47849
Valid Accuracy: 0.08235
Sat Nov 13 19:52:37 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 19:52:37 2021

best accuracy so far: 0.082351
Sat Nov 13 19:54:26 2021


Validation Results
Global Steps: 2600
Valid Loss: 5.14738
Valid Accuracy: 0.03538
Sat Nov 13 19:54:26 2021

best accuracy so far: 0.035379
Sat Nov 13 19:54:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:56:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 19:59:09 2021


Validation Results
Global Steps: 600
Valid Loss: 4.80823
Valid Accuracy: 0.06150
Sat Nov 13 19:59:09 2021

best accuracy so far: 0.082351
Sat Nov 13 19:59:34 2021

 train accuracy so far: 0.068555
Sat Nov 13 20:01:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:01:15 2021


Validation Results
Global Steps: 2800
Valid Loss: 5.15637
Valid Accuracy: 0.03538
Sat Nov 13 20:01:16 2021

best accuracy so far: 0.035379
Sat Nov 13 20:02:10 2021

 train accuracy so far: 0.030078
Sat Nov 13 20:03:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:05:40 2021


Validation Results
Global Steps: 800
Valid Loss: 4.82707
Valid Accuracy: 0.05497
Sat Nov 13 20:05:40 2021

best accuracy so far: 0.082351
Sat Nov 13 20:07:21 2021

 train accuracy so far: 0.049609
Sat Nov 13 20:07:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:08:06 2021


Validation Results
Global Steps: 3000
Valid Loss: 5.14557
Valid Accuracy: 0.03538
Sat Nov 13 20:08:06 2021

best accuracy so far: 0.035379
Sat Nov 13 20:08:21 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 20:08:23 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 20:09:35 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 20:11:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:12:09 2021


Validation Results
Global Steps: 1000
Valid Loss: 4.86735
Valid Accuracy: 0.05050
Sat Nov 13 20:12:09 2021

best accuracy so far: 0.082351
Sat Nov 13 20:14:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:16:26 2021


Validation Results
Global Steps: 200
Valid Loss: 5.09824
Valid Accuracy: 0.04024
Sat Nov 13 20:16:26 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:16:26 2021

best accuracy so far: 0.040243
Sat Nov 13 20:17:49 2021

 train accuracy so far: 0.033984
Sat Nov 13 20:18:06 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 20:18:08 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 20:18:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:19:19 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 20:21:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:23:19 2021


Validation Results
Global Steps: 400
Valid Loss: 3.99394
Valid Accuracy: 0.17230
Sat Nov 13 20:23:20 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:23:20 2021

best accuracy so far: 0.172297
Sat Nov 13 20:25:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:25:53 2021


Validation Results
Global Steps: 200
Valid Loss: 5.28922
Valid Accuracy: 0.01073
Sat Nov 13 20:25:53 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:25:53 2021

best accuracy so far: 0.010727
Sat Nov 13 20:27:10 2021

 train accuracy so far: 0.013672
Sat Nov 13 20:28:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:30:13 2021


Validation Results
Global Steps: 600
Valid Loss: 2.59346
Valid Accuracy: 0.37304
Sat Nov 13 20:30:14 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:30:14 2021

best accuracy so far: 0.373043
Sat Nov 13 20:30:41 2021

 train accuracy so far: 0.218750
Sat Nov 13 20:32:27 2021


Validation Results
Global Steps: 400
Valid Loss: 5.09793
Valid Accuracy: 0.04364
Sat Nov 13 20:32:28 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:32:28 2021

best accuracy so far: 0.043640
Sat Nov 13 20:32:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:34:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:37:08 2021


Validation Results
Global Steps: 800
Valid Loss: 1.96720
Valid Accuracy: 0.49124
Sat Nov 13 20:37:09 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:37:09 2021

best accuracy so far: 0.491239
Sat Nov 13 20:38:58 2021

 train accuracy so far: 0.466211
Sat Nov 13 20:39:03 2021


Validation Results
Global Steps: 600
Valid Loss: 4.68989
Valid Accuracy: 0.09601
Sat Nov 13 20:39:03 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:39:03 2021

best accuracy so far: 0.096009
Sat Nov 13 20:39:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:39:29 2021

 train accuracy so far: 0.056445
Sat Nov 13 20:41:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:44:02 2021


Validation Results
Global Steps: 1000
Valid Loss: 1.57733
Valid Accuracy: 0.56333
Sat Nov 13 20:44:03 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:44:03 2021

best accuracy so far: 0.563329
Sat Nov 13 20:45:38 2021


Validation Results
Global Steps: 800
Valid Loss: 4.36557
Valid Accuracy: 0.13379
Sat Nov 13 20:45:38 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:45:38 2021

best accuracy so far: 0.133786
Sat Nov 13 20:46:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:47:20 2021

 train accuracy so far: 0.117383
Sat Nov 13 20:47:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:50:55 2021


Validation Results
Global Steps: 1200
Valid Loss: 1.26327
Valid Accuracy: 0.64441
Sat Nov 13 20:50:56 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:50:56 2021

best accuracy so far: 0.644413
Sat Nov 13 20:51:50 2021

 train accuracy so far: 0.621484
Sat Nov 13 20:52:12 2021


Validation Results
Global Steps: 1000
Valid Loss: 4.23603
Valid Accuracy: 0.13745
Sat Nov 13 20:52:13 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:52:13 2021

best accuracy so far: 0.137451
Sat Nov 13 20:53:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:54:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 20:57:49 2021


Validation Results
Global Steps: 1400
Valid Loss: 1.12925
Valid Accuracy: 0.67133
Sat Nov 13 20:57:49 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 20:57:49 2021

best accuracy so far: 0.671331
Sat Nov 13 20:58:47 2021


Validation Results
Global Steps: 1200
Valid Loss: 4.25374
Valid Accuracy: 0.12393
Sat Nov 13 20:58:47 2021

best accuracy so far: 0.137451
Sat Nov 13 20:59:01 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 20:59:04 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 21:00:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:00:13 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 21:02:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:04:40 2021


Validation Results
Global Steps: 1600
Valid Loss: 1.06202
Valid Accuracy: 0.68492
Sat Nov 13 21:04:41 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:04:41 2021

best accuracy so far: 0.684922
Sat Nov 13 21:04:41 2021

 train accuracy so far: 0.716602
Sat Nov 13 21:06:47 2021


Validation Results
Global Steps: 200
Valid Loss: 5.39980
Valid Accuracy: 0.00273
Sat Nov 13 21:06:47 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:06:47 2021

best accuracy so far: 0.002732
Sat Nov 13 21:06:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:08:02 2021

 train accuracy so far: 0.009180
Sat Nov 13 21:08:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:11:34 2021


Validation Results
Global Steps: 1800
Valid Loss: 1.00050
Valid Accuracy: 0.69692
Sat Nov 13 21:11:35 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:11:35 2021

best accuracy so far: 0.696915
Sat Nov 13 21:12:56 2021

 train accuracy so far: 0.777148
Sat Nov 13 21:13:17 2021


Validation Results
Global Steps: 400
Valid Loss: 5.83348
Valid Accuracy: 0.01472
Sat Nov 13 21:13:17 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:13:17 2021

best accuracy so far: 0.014724
Sat Nov 13 21:13:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:15:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:18:27 2021


Validation Results
Global Steps: 2000
Valid Loss: 0.97168
Valid Accuracy: 0.70791
Sat Nov 13 21:18:28 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:18:28 2021

best accuracy so far: 0.707909
Sat Nov 13 21:19:46 2021


Validation Results
Global Steps: 600
Valid Loss: 5.83348
Valid Accuracy: 0.01472
Sat Nov 13 21:19:46 2021

best accuracy so far: 0.014724
Sat Nov 13 21:20:11 2021

 train accuracy so far: 0.009180
Sat Nov 13 21:20:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:21:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:25:22 2021


Validation Results
Global Steps: 2200
Valid Loss: 0.89097
Valid Accuracy: 0.73096
Sat Nov 13 21:25:23 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:25:23 2021

best accuracy so far: 0.730961
Sat Nov 13 21:25:50 2021

 train accuracy so far: 0.811914
Sat Nov 13 21:26:14 2021


Validation Results
Global Steps: 800
Valid Loss: 5.83348
Valid Accuracy: 0.01472
Sat Nov 13 21:26:15 2021

best accuracy so far: 0.014724
Sat Nov 13 21:27:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:27:53 2021

 train accuracy so far: 0.008203
Sat Nov 13 21:28:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:32:16 2021


Validation Results
Global Steps: 2400
Valid Loss: 0.95317
Valid Accuracy: 0.72896
Sat Nov 13 21:32:17 2021

best accuracy so far: 0.730961
Sat Nov 13 21:32:44 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.83348
Valid Accuracy: 0.01472
Sat Nov 13 21:32:44 2021

best accuracy so far: 0.014724
Sat Nov 13 21:34:06 2021

 train accuracy so far: 0.849219
Sat Nov 13 21:34:33 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:34:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:39:12 2021


Validation Results
Global Steps: 2600
Valid Loss: 0.84827
Valid Accuracy: 0.74262
Sat Nov 13 21:39:12 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:39:12 2021

best accuracy so far: 0.742621
Sat Nov 13 21:39:13 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.83348
Valid Accuracy: 0.01472
Sat Nov 13 21:39:13 2021

best accuracy so far: 0.014724
Sat Nov 13 21:40:02 2021

 train accuracy so far: 0.007227
Sat Nov 13 21:40:47 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 21:40:49 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 21:41:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:42:01 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 21:44:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:46:09 2021


Validation Results
Global Steps: 2800
Valid Loss: 0.82680
Valid Accuracy: 0.76061
Sat Nov 13 21:46:09 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:46:09 2021

best accuracy so far: 0.760610
Sat Nov 13 21:47:04 2021

 train accuracy so far: 0.875000
Sat Nov 13 21:48:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:48:42 2021


Validation Results
Global Steps: 200
Valid Loss: 3.58658
Valid Accuracy: 0.24679
Sat Nov 13 21:48:42 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:48:42 2021

best accuracy so far: 0.246785
Sat Nov 13 21:50:01 2021

 train accuracy so far: 0.156836
Sat Nov 13 21:50:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:53:05 2021


Validation Results
Global Steps: 3000
Valid Loss: 0.81171
Valid Accuracy: 0.76181
Sat Nov 13 21:53:06 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:53:06 2021

best accuracy so far: 0.761810
Sat Nov 13 21:55:22 2021


Validation Results
Global Steps: 400
Valid Loss: 2.92925
Valid Accuracy: 0.29909
Sat Nov 13 21:55:22 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 21:55:22 2021

best accuracy so far: 0.299087
Sat Nov 13 21:55:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 21:57:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:00:04 2021


Validation Results
Global Steps: 3200
Valid Loss: 0.78119
Valid Accuracy: 0.77454
Sat Nov 13 22:00:04 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 22:00:04 2021

best accuracy so far: 0.774535
Sat Nov 13 22:00:04 2021

 train accuracy so far: 0.892383
Sat Nov 13 22:02:03 2021


Validation Results
Global Steps: 600
Valid Loss: 2.91587
Valid Accuracy: 0.26931
Sat Nov 13 22:02:04 2021

best accuracy so far: 0.299087
Sat Nov 13 22:02:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:02:30 2021

 train accuracy so far: 0.291406
Sat Nov 13 22:04:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:07:18 2021


Validation Results
Global Steps: 3400
Valid Loss: 0.79681
Valid Accuracy: 0.76974
Sat Nov 13 22:07:18 2021

best accuracy so far: 0.774535
Sat Nov 13 22:08:45 2021

 train accuracy so far: 0.912695
Sat Nov 13 22:09:03 2021


Validation Results
Global Steps: 800
Valid Loss: 2.84425
Valid Accuracy: 0.28736
Sat Nov 13 22:09:03 2021

best accuracy so far: 0.299087
Sat Nov 13 22:09:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:10:48 2021

 train accuracy so far: 0.295898
Sat Nov 13 22:11:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:14:20 2021


Validation Results
Global Steps: 3600
Valid Loss: 0.80348
Valid Accuracy: 0.77234
Sat Nov 13 22:14:21 2021

best accuracy so far: 0.774535
Sat Nov 13 22:15:45 2021


Validation Results
Global Steps: 1000
Valid Loss: 2.56853
Valid Accuracy: 0.34399
Sat Nov 13 22:15:45 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 22:15:45 2021

best accuracy so far: 0.343994
Sat Nov 13 22:16:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:17:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:21:16 2021


Validation Results
Global Steps: 3800
Valid Loss: 0.82239
Valid Accuracy: 0.77320
Sat Nov 13 22:21:17 2021

best accuracy so far: 0.774535
Sat Nov 13 22:21:44 2021

 train accuracy so far: 0.927539
Sat Nov 13 22:22:25 2021


Validation Results
Global Steps: 1200
Valid Loss: 2.33090
Valid Accuracy: 0.37644
Sat Nov 13 22:22:26 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 22:22:26 2021

best accuracy so far: 0.376441
Sat Nov 13 22:23:18 2021

 train accuracy so far: 0.344531
Sat Nov 13 22:23:33 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:24:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:28:12 2021


Validation Results
Global Steps: 4000
Valid Loss: 0.78894
Valid Accuracy: 0.78380
Sat Nov 13 22:28:13 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 22:28:13 2021

best accuracy so far: 0.783796
Sat Nov 13 22:29:05 2021


Validation Results
Global Steps: 1400
Valid Loss: 2.29839
Valid Accuracy: 0.38430
Sat Nov 13 22:29:06 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 22:29:06 2021

best accuracy so far: 0.384303
Sat Nov 13 22:29:17 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sat Nov 13 22:29:19 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sat Nov 13 22:30:02 2021

 train accuracy so far: 0.946484
Sat Nov 13 22:30:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:30:31 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sat Nov 13 22:32:41 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:35:11 2021


Validation Results
Global Steps: 4200
Valid Loss: 0.84045
Valid Accuracy: 0.78106
Sat Nov 13 22:35:12 2021

best accuracy so far: 0.783796
Sat Nov 13 22:37:09 2021


Validation Results
Global Steps: 200
Valid Loss: 5.42942
Valid Accuracy: 0.00533
Sat Nov 13 22:37:10 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 22:37:10 2021

best accuracy so far: 0.005330
Sat Nov 13 22:37:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:38:28 2021

 train accuracy so far: 0.013086
Sat Nov 13 22:39:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:42:09 2021


Validation Results
Global Steps: 4400
Valid Loss: 0.84942
Valid Accuracy: 0.77720
Sat Nov 13 22:42:09 2021

best accuracy so far: 0.783796
Sat Nov 13 22:43:05 2021

 train accuracy so far: 0.951758
Sat Nov 13 22:43:49 2021


Validation Results
Global Steps: 400
Valid Loss: 5.18036
Valid Accuracy: 0.01572
Sat Nov 13 22:43:50 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 22:43:50 2021

best accuracy so far: 0.015724
Sat Nov 13 22:44:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:45:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:49:07 2021


Validation Results
Global Steps: 4600
Valid Loss: 0.89192
Valid Accuracy: 0.77260
Sat Nov 13 22:49:07 2021

best accuracy so far: 0.783796
Sat Nov 13 22:50:27 2021


Validation Results
Global Steps: 600
Valid Loss: 5.15222
Valid Accuracy: 0.03538
Sat Nov 13 22:50:28 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 22:50:28 2021

best accuracy so far: 0.035379
Sat Nov 13 22:50:54 2021

 train accuracy so far: 0.029102
Sat Nov 13 22:51:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:52:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:56:11 2021


Validation Results
Global Steps: 4800
Valid Loss: 0.85704
Valid Accuracy: 0.78126
Sat Nov 13 22:56:11 2021

best accuracy so far: 0.783796
Sat Nov 13 22:56:11 2021

 train accuracy so far: 0.965820
Sat Nov 13 22:57:07 2021


Validation Results
Global Steps: 800
Valid Loss: 5.13331
Valid Accuracy: 0.03538
Sat Nov 13 22:57:07 2021

best accuracy so far: 0.035379
Sat Nov 13 22:58:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 22:58:51 2021

 train accuracy so far: 0.031445
Sat Nov 13 22:59:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:03:11 2021


Validation Results
Global Steps: 5000
Valid Loss: 0.79219
Valid Accuracy: 0.80072
Sat Nov 13 23:03:11 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 23:03:11 2021

best accuracy so far: 0.800720
Sat Nov 13 23:03:46 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.12729
Valid Accuracy: 0.03538
Sat Nov 13 23:03:46 2021

best accuracy so far: 0.035379
Sat Nov 13 23:04:34 2021

 train accuracy so far: 0.969727
Sat Nov 13 23:05:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:05:55 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:10:12 2021


Validation Results
Global Steps: 5200
Valid Loss: 0.83900
Valid Accuracy: 0.79672
Sat Nov 13 23:10:12 2021

best accuracy so far: 0.800720
Sat Nov 13 23:10:25 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.13367
Valid Accuracy: 0.03538
Sat Nov 13 23:10:25 2021

best accuracy so far: 0.035379
Sat Nov 13 23:11:17 2021

 train accuracy so far: 0.031836
Sat Nov 13 23:12:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:12:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:17:04 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.15254
Valid Accuracy: 0.03538
Sat Nov 13 23:17:04 2021

best accuracy so far: 0.035379
Sat Nov 13 23:17:13 2021


Validation Results
Global Steps: 5400
Valid Loss: 0.83698
Valid Accuracy: 0.79772
Sat Nov 13 23:17:14 2021

best accuracy so far: 0.800720
Sat Nov 13 23:17:41 2021

 train accuracy so far: 0.978125
Sat Nov 13 23:19:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:19:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:23:39 2021


Validation Results
Global Steps: 1600
Valid Loss: 5.12203
Valid Accuracy: 0.03538
Sat Nov 13 23:23:39 2021

best accuracy so far: 0.035379
Sat Nov 13 23:23:39 2021

 train accuracy so far: 0.031445
Sat Nov 13 23:24:09 2021


Validation Results
Global Steps: 5600
Valid Loss: 0.83675
Valid Accuracy: 0.79772
Sat Nov 13 23:24:09 2021

best accuracy so far: 0.800720
Sat Nov 13 23:25:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:25:57 2021

 train accuracy so far: 0.983594
Sat Nov 13 23:26:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:30:13 2021


Validation Results
Global Steps: 1800
Valid Loss: 5.12486
Valid Accuracy: 0.03538
Sat Nov 13 23:30:13 2021

best accuracy so far: 0.035379
Sat Nov 13 23:31:03 2021


Validation Results
Global Steps: 5800
Valid Loss: 0.82563
Valid Accuracy: 0.80558
Sat Nov 13 23:31:04 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 23:31:04 2021

best accuracy so far: 0.805583
Sat Nov 13 23:31:31 2021

 train accuracy so far: 0.033398
Sat Nov 13 23:32:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:33:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:36:47 2021


Validation Results
Global Steps: 2000
Valid Loss: 5.13522
Valid Accuracy: 0.03538
Sat Nov 13 23:36:48 2021

best accuracy so far: 0.035379
Sat Nov 13 23:37:59 2021


Validation Results
Global Steps: 6000
Valid Loss: 0.83880
Valid Accuracy: 0.81025
Sat Nov 13 23:37:59 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 23:37:59 2021

best accuracy so far: 0.810247
Sat Nov 13 23:38:53 2021

 train accuracy so far: 0.989258
Sat Nov 13 23:38:55 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:40:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:43:19 2021


Validation Results
Global Steps: 2200
Valid Loss: 5.12320
Valid Accuracy: 0.03538
Sat Nov 13 23:43:19 2021

best accuracy so far: 0.035379
Sat Nov 13 23:43:45 2021

 train accuracy so far: 0.031250
Sat Nov 13 23:44:51 2021


Validation Results
Global Steps: 6200
Valid Loss: 0.84493
Valid Accuracy: 0.80665
Sat Nov 13 23:44:51 2021

best accuracy so far: 0.810247
Sat Nov 13 23:45:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:47:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:49:51 2021


Validation Results
Global Steps: 2400
Valid Loss: 5.16796
Valid Accuracy: 0.03538
Sat Nov 13 23:49:51 2021

best accuracy so far: 0.035379
Sat Nov 13 23:51:34 2021

 train accuracy so far: 0.033984
Sat Nov 13 23:51:44 2021


Validation Results
Global Steps: 6400
Valid Loss: 0.83166
Valid Accuracy: 0.81118
Sat Nov 13 23:51:45 2021
Saved model checkpoint to [DIR: %s]./output
Sat Nov 13 23:51:45 2021

best accuracy so far: 0.811180
Sat Nov 13 23:51:45 2021

 train accuracy so far: 0.994141
Sat Nov 13 23:52:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:54:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:56:22 2021


Validation Results
Global Steps: 2600
Valid Loss: 5.14738
Valid Accuracy: 0.03538
Sat Nov 13 23:56:23 2021

best accuracy so far: 0.035379
Sat Nov 13 23:58:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sat Nov 13 23:58:37 2021


Validation Results
Global Steps: 6600
Valid Loss: 0.87926
Valid Accuracy: 0.81018
Sat Nov 13 23:58:37 2021

best accuracy so far: 0.811180
Sat Nov 13 23:59:59 2021

 train accuracy so far: 0.994336
Sun Nov 14 00:00:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:02:54 2021


Validation Results
Global Steps: 2800
Valid Loss: 5.15637
Valid Accuracy: 0.03538
Sun Nov 14 00:02:54 2021

best accuracy so far: 0.035379
Sun Nov 14 00:03:45 2021

 train accuracy so far: 0.030078
Sun Nov 14 00:05:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:05:31 2021


Validation Results
Global Steps: 6800
Valid Loss: 0.86135
Valid Accuracy: 0.81398
Sun Nov 14 00:05:31 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 00:05:31 2021

best accuracy so far: 0.813978
Sun Nov 14 00:07:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:09:24 2021


Validation Results
Global Steps: 3000
Valid Loss: 5.14557
Valid Accuracy: 0.03538
Sun Nov 14 00:09:25 2021

best accuracy so far: 0.035379
Sun Nov 14 00:09:38 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 00:09:40 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 00:10:52 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 00:12:25 2021


Validation Results
Global Steps: 7000
Valid Loss: 0.83372
Valid Accuracy: 0.81924
Sun Nov 14 00:12:26 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 00:12:26 2021

best accuracy so far: 0.819242
Sun Nov 14 00:12:53 2021

 train accuracy so far: 0.994727
Sun Nov 14 00:13:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:14:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:17:27 2021


Validation Results
Global Steps: 200
Valid Loss: 3.47520
Valid Accuracy: 0.22673
Sun Nov 14 00:17:28 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 00:17:28 2021

best accuracy so far: 0.226731
Sun Nov 14 00:18:46 2021

 train accuracy so far: 0.124609
Sun Nov 14 00:19:19 2021


Validation Results
Global Steps: 7200
Valid Loss: 0.83694
Valid Accuracy: 0.82004
Sun Nov 14 00:19:20 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 00:19:20 2021

best accuracy so far: 0.820041
Sun Nov 14 00:19:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:21:08 2021

 train accuracy so far: 0.998047
Sun Nov 14 00:21:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:24:04 2021


Validation Results
Global Steps: 400
Valid Loss: 5.55801
Valid Accuracy: 0.01632
Sun Nov 14 00:24:04 2021

best accuracy so far: 0.226731
Sun Nov 14 00:26:12 2021


Validation Results
Global Steps: 7400
Valid Loss: 0.84749
Valid Accuracy: 0.81971
Sun Nov 14 00:26:12 2021

best accuracy so far: 0.820041
Sun Nov 14 00:26:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:28:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:30:39 2021


Validation Results
Global Steps: 600
Valid Loss: 5.18600
Valid Accuracy: 0.01712
Sun Nov 14 00:30:40 2021

best accuracy so far: 0.226731
Sun Nov 14 00:31:06 2021

 train accuracy so far: 0.030078
Sun Nov 14 00:32:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:33:04 2021


Validation Results
Global Steps: 7600
Valid Loss: 0.84060
Valid Accuracy: 0.82011
Sun Nov 14 00:33:05 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 00:33:05 2021

best accuracy so far: 0.820108
Sun Nov 14 00:33:59 2021

 train accuracy so far: 0.997070
Sun Nov 14 00:35:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:37:15 2021


Validation Results
Global Steps: 800
Valid Loss: 5.26646
Valid Accuracy: 0.03538
Sun Nov 14 00:37:15 2021

best accuracy so far: 0.226731
Sun Nov 14 00:39:00 2021

 train accuracy so far: 0.023438
Sun Nov 14 00:39:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:39:57 2021


Validation Results
Global Steps: 7800
Valid Loss: 0.84359
Valid Accuracy: 0.82231
Sun Nov 14 00:39:57 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 00:39:57 2021

best accuracy so far: 0.822307
Sun Nov 14 00:42:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:43:50 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.18133
Valid Accuracy: 0.01472
Sun Nov 14 00:43:51 2021

best accuracy so far: 0.226731
Sun Nov 14 00:46:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:46:50 2021


Validation Results
Global Steps: 8000
Valid Loss: 0.84274
Valid Accuracy: 0.82091
Sun Nov 14 00:46:50 2021

best accuracy so far: 0.822307
Sun Nov 14 00:46:50 2021

 train accuracy so far: 0.997656
Sun Nov 14 00:49:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:50:26 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.16549
Valid Accuracy: 0.03538
Sun Nov 14 00:50:27 2021

best accuracy so far: 0.226731
Sun Nov 14 00:50:38 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 00:50:40 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 00:51:52 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 00:53:43 2021


Validation Results
Global Steps: 8200
Valid Loss: 0.83581
Valid Accuracy: 0.82337
Sun Nov 14 00:53:44 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 00:53:44 2021

best accuracy so far: 0.823373
Sun Nov 14 00:54:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:55:05 2021

 train accuracy so far: 0.998047
Sun Nov 14 00:56:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 00:58:28 2021


Validation Results
Global Steps: 200
Valid Loss: 3.47520
Valid Accuracy: 0.22673
Sun Nov 14 00:58:29 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 00:58:29 2021

best accuracy so far: 0.226731
Sun Nov 14 00:59:47 2021

 train accuracy so far: 0.124609
Sun Nov 14 01:00:37 2021


Validation Results
Global Steps: 8400
Valid Loss: 0.83133
Valid Accuracy: 0.82537
Sun Nov 14 01:00:37 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 01:00:37 2021

best accuracy so far: 0.825371
Sun Nov 14 01:00:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:02:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:05:05 2021


Validation Results
Global Steps: 400
Valid Loss: 5.55801
Valid Accuracy: 0.01632
Sun Nov 14 01:05:05 2021

best accuracy so far: 0.226731
Sun Nov 14 01:07:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:07:29 2021


Validation Results
Global Steps: 8600
Valid Loss: 0.83649
Valid Accuracy: 0.82317
Sun Nov 14 01:07:30 2021

best accuracy so far: 0.825371
Sun Nov 14 01:07:57 2021

 train accuracy so far: 0.998047
Sun Nov 14 01:09:45 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:11:42 2021


Validation Results
Global Steps: 600
Valid Loss: 5.18600
Valid Accuracy: 0.01712
Sun Nov 14 01:11:42 2021

best accuracy so far: 0.226731
Sun Nov 14 01:12:08 2021

 train accuracy so far: 0.030078
Sun Nov 14 01:13:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:14:21 2021


Validation Results
Global Steps: 8800
Valid Loss: 0.83294
Valid Accuracy: 0.82510
Sun Nov 14 01:14:22 2021

best accuracy so far: 0.825371
Sun Nov 14 01:16:10 2021

 train accuracy so far: 0.998633
Sun Nov 14 01:16:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:18:18 2021


Validation Results
Global Steps: 800
Valid Loss: 5.26646
Valid Accuracy: 0.03538
Sun Nov 14 01:18:18 2021

best accuracy so far: 0.226731
Sun Nov 14 01:20:03 2021

 train accuracy so far: 0.023438
Sun Nov 14 01:20:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:21:14 2021


Validation Results
Global Steps: 9000
Valid Loss: 0.83271
Valid Accuracy: 0.82517
Sun Nov 14 01:21:14 2021

best accuracy so far: 0.825371
Sun Nov 14 01:23:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:24:54 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.18133
Valid Accuracy: 0.01472
Sun Nov 14 01:24:54 2021

best accuracy so far: 0.226731
Sun Nov 14 01:27:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:28:07 2021


Validation Results
Global Steps: 9200
Valid Loss: 0.83224
Valid Accuracy: 0.82544
Sun Nov 14 01:28:07 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 01:28:07 2021

best accuracy so far: 0.825438
Sun Nov 14 01:29:02 2021

 train accuracy so far: 0.998437
Sun Nov 14 01:30:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:31:30 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.16549
Valid Accuracy: 0.03538
Sun Nov 14 01:31:30 2021

best accuracy so far: 0.226731
Sun Nov 14 01:31:38 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 01:31:41 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 01:32:51 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 01:34:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:35:01 2021


Validation Results
Global Steps: 9400
Valid Loss: 0.83182
Valid Accuracy: 0.82510
Sun Nov 14 01:35:01 2021

best accuracy so far: 0.825438
Sun Nov 14 01:37:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:39:24 2021


Validation Results
Global Steps: 200
Valid Loss: 5.19065
Valid Accuracy: 0.03325
Sun Nov 14 01:39:25 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 01:39:25 2021

best accuracy so far: 0.033247
Sun Nov 14 01:40:41 2021

 train accuracy so far: 0.023047
Sun Nov 14 01:41:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:41:55 2021


Validation Results
Global Steps: 9600
Valid Loss: 0.83214
Valid Accuracy: 0.82510
Sun Nov 14 01:41:55 2021

best accuracy so far: 0.825438
Sun Nov 14 01:41:55 2021

 train accuracy so far: 0.998828
Sun Nov 14 01:44:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:45:58 2021


Validation Results
Global Steps: 400
Valid Loss: 4.68900
Valid Accuracy: 0.10674
Sun Nov 14 01:45:59 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 01:45:59 2021

best accuracy so far: 0.106736
Sun Nov 14 01:48:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:48:46 2021


Validation Results
Global Steps: 9800
Valid Loss: 0.83246
Valid Accuracy: 0.82517
Sun Nov 14 01:48:47 2021

best accuracy so far: 0.825438
Sun Nov 14 01:50:08 2021

 train accuracy so far: 0.999219
Sun Nov 14 01:51:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:52:31 2021


Validation Results
Global Steps: 600
Valid Loss: 4.39020
Valid Accuracy: 0.11926
Sun Nov 14 01:52:32 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 01:52:32 2021

best accuracy so far: 0.119262
Sun Nov 14 01:52:57 2021

 train accuracy so far: 0.095117
Sun Nov 14 01:54:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 01:55:39 2021


Validation Results
Global Steps: 10000
Valid Loss: 0.83245
Valid Accuracy: 0.82510
Sun Nov 14 01:55:39 2021

best accuracy so far: 0.825438
Sun Nov 14 01:55:39 2021

 train accuracy so far: 0.999219
Sun Nov 14 01:55:39 2021

Best Accuracy: 	0.825438
End Training!
Total Training Time: 	5.767939


Sun Nov 14 01:55:53 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 01:55:56 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 01:57:07 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 01:59:03 2021


Validation Results
Global Steps: 800
Valid Loss: 4.36266
Valid Accuracy: 0.11760
Sun Nov 14 01:59:03 2021

best accuracy so far: 0.119262
Sun Nov 14 01:59:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:00:44 2021

 train accuracy so far: 0.097461
Sun Nov 14 02:01:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:03:57 2021


Validation Results
Global Steps: 200
Valid Loss: 5.03921
Valid Accuracy: 0.05557
Sun Nov 14 02:03:57 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:03:57 2021

best accuracy so far: 0.055567
Sun Nov 14 02:05:19 2021

 train accuracy so far: 0.042969
Sun Nov 14 02:05:35 2021


Validation Results
Global Steps: 1000
Valid Loss: 4.47331
Valid Accuracy: 0.09194
Sun Nov 14 02:05:35 2021

best accuracy so far: 0.119262
Sun Nov 14 02:06:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:07:41 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:10:49 2021


Validation Results
Global Steps: 400
Valid Loss: 3.62112
Valid Accuracy: 0.22786
Sun Nov 14 02:10:50 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:10:50 2021

best accuracy so far: 0.227863
Sun Nov 14 02:12:07 2021


Validation Results
Global Steps: 1200
Valid Loss: 4.53496
Valid Accuracy: 0.08875
Sun Nov 14 02:12:07 2021

best accuracy so far: 0.119262
Sun Nov 14 02:12:18 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 02:12:21 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 02:13:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:13:31 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 02:15:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:17:41 2021


Validation Results
Global Steps: 600
Valid Loss: 2.39716
Valid Accuracy: 0.40223
Sun Nov 14 02:17:41 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:17:41 2021

best accuracy so far: 0.402225
Sun Nov 14 02:18:08 2021

 train accuracy so far: 0.250000
Sun Nov 14 02:19:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:20:05 2021


Validation Results
Global Steps: 200
Valid Loss: 5.19313
Valid Accuracy: 0.03738
Sun Nov 14 02:20:05 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:20:05 2021

best accuracy so far: 0.037378
Sun Nov 14 02:21:22 2021

 train accuracy so far: 0.023242
Sun Nov 14 02:22:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:24:32 2021


Validation Results
Global Steps: 800
Valid Loss: 1.83575
Valid Accuracy: 0.48871
Sun Nov 14 02:24:33 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:24:33 2021

best accuracy so far: 0.488707
Sun Nov 14 02:26:21 2021

 train accuracy so far: 0.490625
Sun Nov 14 02:26:40 2021


Validation Results
Global Steps: 400
Valid Loss: 4.69760
Valid Accuracy: 0.11280
Sun Nov 14 02:26:40 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:26:40 2021

best accuracy so far: 0.112799
Sun Nov 14 02:26:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:28:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:31:24 2021


Validation Results
Global Steps: 1000
Valid Loss: 1.46577
Valid Accuracy: 0.57699
Sun Nov 14 02:31:24 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:31:24 2021

best accuracy so far: 0.576987
Sun Nov 14 02:33:14 2021


Validation Results
Global Steps: 600
Valid Loss: 4.30199
Valid Accuracy: 0.13039
Sun Nov 14 02:33:14 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:33:14 2021

best accuracy so far: 0.130388
Sun Nov 14 02:33:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:33:40 2021

 train accuracy so far: 0.097656
Sun Nov 14 02:35:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:38:16 2021


Validation Results
Global Steps: 1200
Valid Loss: 1.21875
Valid Accuracy: 0.63449
Sun Nov 14 02:38:17 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:38:17 2021

best accuracy so far: 0.634486
Sun Nov 14 02:39:11 2021

 train accuracy so far: 0.643164
Sun Nov 14 02:39:47 2021


Validation Results
Global Steps: 800
Valid Loss: 4.40259
Valid Accuracy: 0.10887
Sun Nov 14 02:39:48 2021

best accuracy so far: 0.130388
Sun Nov 14 02:40:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:41:30 2021

 train accuracy so far: 0.104688
Sun Nov 14 02:41:55 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:45:07 2021


Validation Results
Global Steps: 1400
Valid Loss: 1.15720
Valid Accuracy: 0.65847
Sun Nov 14 02:45:07 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:45:07 2021

best accuracy so far: 0.658472
Sun Nov 14 02:46:20 2021


Validation Results
Global Steps: 1000
Valid Loss: 4.40634
Valid Accuracy: 0.09921
Sun Nov 14 02:46:21 2021

best accuracy so far: 0.130388
Sun Nov 14 02:47:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:48:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:51:59 2021


Validation Results
Global Steps: 1600
Valid Loss: 1.03188
Valid Accuracy: 0.68792
Sun Nov 14 02:52:00 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:52:00 2021

best accuracy so far: 0.687921
Sun Nov 14 02:52:00 2021

 train accuracy so far: 0.719531
Sun Nov 14 02:52:53 2021


Validation Results
Global Steps: 1200
Valid Loss: 4.54787
Valid Accuracy: 0.08082
Sun Nov 14 02:52:54 2021

best accuracy so far: 0.130388
Sun Nov 14 02:53:04 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 02:53:06 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 02:54:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:54:16 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 02:56:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 02:58:49 2021


Validation Results
Global Steps: 1800
Valid Loss: 0.97081
Valid Accuracy: 0.70431
Sun Nov 14 02:58:50 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 02:58:50 2021

best accuracy so far: 0.704311
Sun Nov 14 03:00:11 2021

 train accuracy so far: 0.782422
Sun Nov 14 03:00:48 2021


Validation Results
Global Steps: 200
Valid Loss: 5.01479
Valid Accuracy: 0.05896
Sun Nov 14 03:00:48 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 03:00:48 2021

best accuracy so far: 0.058965
Sun Nov 14 03:01:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:02:05 2021

 train accuracy so far: 0.043945
Sun Nov 14 03:02:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:05:40 2021


Validation Results
Global Steps: 2000
Valid Loss: 0.98217
Valid Accuracy: 0.70971
Sun Nov 14 03:05:41 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 03:05:41 2021

best accuracy so far: 0.709708
Sun Nov 14 03:07:21 2021


Validation Results
Global Steps: 400
Valid Loss: 4.47849
Valid Accuracy: 0.08235
Sun Nov 14 03:07:21 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 03:07:21 2021

best accuracy so far: 0.082351
Sun Nov 14 03:07:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:09:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:12:32 2021


Validation Results
Global Steps: 2200
Valid Loss: 0.92213
Valid Accuracy: 0.72576
Sun Nov 14 03:12:32 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 03:12:32 2021

best accuracy so far: 0.725765
Sun Nov 14 03:12:59 2021

 train accuracy so far: 0.812109
Sun Nov 14 03:13:53 2021


Validation Results
Global Steps: 600
Valid Loss: 4.80823
Valid Accuracy: 0.06150
Sun Nov 14 03:13:54 2021

best accuracy so far: 0.082351
Sun Nov 14 03:14:19 2021

 train accuracy so far: 0.068555
Sun Nov 14 03:14:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:16:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:19:23 2021


Validation Results
Global Steps: 2400
Valid Loss: 1.02417
Valid Accuracy: 0.72123
Sun Nov 14 03:19:23 2021

best accuracy so far: 0.725765
Sun Nov 14 03:20:24 2021


Validation Results
Global Steps: 800
Valid Loss: 4.82707
Valid Accuracy: 0.05497
Sun Nov 14 03:20:25 2021

best accuracy so far: 0.082351
Sun Nov 14 03:21:11 2021

 train accuracy so far: 0.849219
Sun Nov 14 03:21:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:22:05 2021

 train accuracy so far: 0.049609
Sun Nov 14 03:22:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:26:13 2021


Validation Results
Global Steps: 2600
Valid Loss: 0.85514
Valid Accuracy: 0.74768
Sun Nov 14 03:26:14 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 03:26:14 2021

best accuracy so far: 0.747685
Sun Nov 14 03:26:54 2021


Validation Results
Global Steps: 1000
Valid Loss: 4.86735
Valid Accuracy: 0.05050
Sun Nov 14 03:26:54 2021

best accuracy so far: 0.082351
Sun Nov 14 03:28:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:28:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:33:04 2021


Validation Results
Global Steps: 2800
Valid Loss: 0.87873
Valid Accuracy: 0.74802
Sun Nov 14 03:33:05 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 03:33:05 2021

best accuracy so far: 0.748018
Sun Nov 14 03:33:23 2021


Validation Results
Global Steps: 1200
Valid Loss: 4.99723
Valid Accuracy: 0.03258
Sun Nov 14 03:33:23 2021

best accuracy so far: 0.082351
Sun Nov 14 03:33:59 2021

 train accuracy so far: 0.872461
Sun Nov 14 03:34:13 2021

 train accuracy so far: 0.036328
Sun Nov 14 03:35:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:35:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:39:51 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.09937
Valid Accuracy: 0.03651
Sun Nov 14 03:39:51 2021

best accuracy so far: 0.082351
Sun Nov 14 03:39:56 2021


Validation Results
Global Steps: 3000
Valid Loss: 0.84905
Valid Accuracy: 0.75375
Sun Nov 14 03:39:57 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 03:39:57 2021

best accuracy so far: 0.753748
Sun Nov 14 03:41:55 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:42:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:46:18 2021


Validation Results
Global Steps: 1600
Valid Loss: 5.06807
Valid Accuracy: 0.03571
Sun Nov 14 03:46:18 2021

best accuracy so far: 0.082351
Sun Nov 14 03:46:18 2021

 train accuracy so far: 0.028125
Sun Nov 14 03:46:47 2021


Validation Results
Global Steps: 3200
Valid Loss: 0.82271
Valid Accuracy: 0.76741
Sun Nov 14 03:46:48 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 03:46:48 2021

best accuracy so far: 0.767406
Sun Nov 14 03:46:48 2021

 train accuracy so far: 0.897070
Sun Nov 14 03:48:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:49:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:52:45 2021


Validation Results
Global Steps: 1800
Valid Loss: 5.12801
Valid Accuracy: 0.03538
Sun Nov 14 03:52:45 2021

best accuracy so far: 0.082351
Sun Nov 14 03:53:39 2021


Validation Results
Global Steps: 3400
Valid Loss: 0.83871
Valid Accuracy: 0.77300
Sun Nov 14 03:53:39 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 03:53:39 2021

best accuracy so far: 0.773003
Sun Nov 14 03:54:00 2021

 train accuracy so far: 0.029297
Sun Nov 14 03:54:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:54:59 2021

 train accuracy so far: 0.915820
Sun Nov 14 03:55:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 03:59:12 2021


Validation Results
Global Steps: 2000
Valid Loss: 5.13170
Valid Accuracy: 0.03538
Sun Nov 14 03:59:12 2021

best accuracy so far: 0.082351
Sun Nov 14 04:00:30 2021


Validation Results
Global Steps: 3600
Valid Loss: 0.84879
Valid Accuracy: 0.76867
Sun Nov 14 04:00:31 2021

best accuracy so far: 0.773003
Sun Nov 14 04:01:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:02:45 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:05:39 2021


Validation Results
Global Steps: 2200
Valid Loss: 5.12925
Valid Accuracy: 0.03538
Sun Nov 14 04:05:39 2021

best accuracy so far: 0.082351
Sun Nov 14 04:05:49 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 04:05:52 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 04:07:04 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 04:07:21 2021


Validation Results
Global Steps: 3800
Valid Loss: 0.84029
Valid Accuracy: 0.77394
Sun Nov 14 04:07:22 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 04:07:22 2021

best accuracy so far: 0.773936
Sun Nov 14 04:07:48 2021

 train accuracy so far: 0.927539
Sun Nov 14 04:09:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:09:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:13:39 2021


Validation Results
Global Steps: 200
Valid Loss: 3.75875
Valid Accuracy: 0.18049
Sun Nov 14 04:13:40 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 04:13:40 2021

best accuracy so far: 0.180492
Sun Nov 14 04:14:12 2021


Validation Results
Global Steps: 4000
Valid Loss: 0.88804
Valid Accuracy: 0.76594
Sun Nov 14 04:14:12 2021

best accuracy so far: 0.773936
Sun Nov 14 04:14:58 2021

 train accuracy so far: 0.124609
Sun Nov 14 04:15:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:15:59 2021

 train accuracy so far: 0.944336
Sun Nov 14 04:16:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:20:16 2021


Validation Results
Global Steps: 400
Valid Loss: 4.81520
Valid Accuracy: 0.04924
Sun Nov 14 04:20:16 2021

best accuracy so far: 0.180492
Sun Nov 14 04:21:02 2021


Validation Results
Global Steps: 4200
Valid Loss: 0.84688
Valid Accuracy: 0.78160
Sun Nov 14 04:21:02 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 04:21:02 2021

best accuracy so far: 0.781598
Sun Nov 14 04:22:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:23:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:26:52 2021


Validation Results
Global Steps: 600
Valid Loss: 5.24843
Valid Accuracy: 0.03538
Sun Nov 14 04:26:52 2021

best accuracy so far: 0.180492
Sun Nov 14 04:27:18 2021

 train accuracy so far: 0.042188
Sun Nov 14 04:27:52 2021


Validation Results
Global Steps: 4400
Valid Loss: 0.88022
Valid Accuracy: 0.78033
Sun Nov 14 04:27:52 2021

best accuracy so far: 0.781598
Sun Nov 14 04:28:46 2021

 train accuracy so far: 0.958203
Sun Nov 14 04:29:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:30:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:33:27 2021


Validation Results
Global Steps: 800
Valid Loss: 5.17721
Valid Accuracy: 0.03538
Sun Nov 14 04:33:28 2021

best accuracy so far: 0.180492
Sun Nov 14 04:34:44 2021


Validation Results
Global Steps: 4600
Valid Loss: 0.90835
Valid Accuracy: 0.77800
Sun Nov 14 04:34:44 2021

best accuracy so far: 0.781598
Sun Nov 14 04:35:12 2021

 train accuracy so far: 0.027539
Sun Nov 14 04:35:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:36:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:40:03 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.14916
Valid Accuracy: 0.03538
Sun Nov 14 04:40:03 2021

best accuracy so far: 0.180492
Sun Nov 14 04:41:36 2021


Validation Results
Global Steps: 4800
Valid Loss: 0.85177
Valid Accuracy: 0.79239
Sun Nov 14 04:41:36 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 04:41:36 2021

best accuracy so far: 0.792391
Sun Nov 14 04:41:36 2021

 train accuracy so far: 0.966797
Sun Nov 14 04:42:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:43:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:46:39 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.13485
Valid Accuracy: 0.03538
Sun Nov 14 04:46:39 2021

best accuracy so far: 0.180492
Sun Nov 14 04:46:49 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 04:46:52 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 04:48:04 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 04:48:28 2021


Validation Results
Global Steps: 5000
Valid Loss: 0.88693
Valid Accuracy: 0.79412
Sun Nov 14 04:48:29 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 04:48:29 2021

best accuracy so far: 0.794124
Sun Nov 14 04:49:49 2021

 train accuracy so far: 0.974609
Sun Nov 14 04:50:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:50:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:54:36 2021


Validation Results
Global Steps: 200
Valid Loss: 5.09824
Valid Accuracy: 0.04024
Sun Nov 14 04:54:37 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 04:54:37 2021

best accuracy so far: 0.040243
Sun Nov 14 04:55:19 2021


Validation Results
Global Steps: 5200
Valid Loss: 0.87060
Valid Accuracy: 0.79725
Sun Nov 14 04:55:19 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 04:55:19 2021

best accuracy so far: 0.797255
Sun Nov 14 04:55:53 2021

 train accuracy so far: 0.033984
Sun Nov 14 04:56:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 04:57:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:01:11 2021


Validation Results
Global Steps: 400
Valid Loss: 3.99394
Valid Accuracy: 0.17230
Sun Nov 14 05:01:11 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:01:11 2021

best accuracy so far: 0.172297
Sun Nov 14 05:02:10 2021


Validation Results
Global Steps: 5400
Valid Loss: 0.88853
Valid Accuracy: 0.79872
Sun Nov 14 05:02:11 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:02:11 2021

best accuracy so far: 0.798721
Sun Nov 14 05:02:38 2021

 train accuracy so far: 0.984570
Sun Nov 14 05:03:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:04:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:07:44 2021


Validation Results
Global Steps: 600
Valid Loss: 2.59346
Valid Accuracy: 0.37304
Sun Nov 14 05:07:45 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:07:45 2021

best accuracy so far: 0.373043
Sun Nov 14 05:08:11 2021

 train accuracy so far: 0.218750
Sun Nov 14 05:09:01 2021


Validation Results
Global Steps: 5600
Valid Loss: 0.89713
Valid Accuracy: 0.80039
Sun Nov 14 05:09:02 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:09:02 2021

best accuracy so far: 0.800386
Sun Nov 14 05:09:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:10:50 2021

 train accuracy so far: 0.988867
Sun Nov 14 05:11:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:14:19 2021


Validation Results
Global Steps: 800
Valid Loss: 1.96720
Valid Accuracy: 0.49124
Sun Nov 14 05:14:20 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:14:20 2021

best accuracy so far: 0.491239
Sun Nov 14 05:15:54 2021


Validation Results
Global Steps: 5800
Valid Loss: 0.90938
Valid Accuracy: 0.80245
Sun Nov 14 05:15:55 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:15:55 2021

best accuracy so far: 0.802452
Sun Nov 14 05:16:02 2021

 train accuracy so far: 0.466211
Sun Nov 14 05:16:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:18:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:20:53 2021


Validation Results
Global Steps: 1000
Valid Loss: 1.57733
Valid Accuracy: 0.56333
Sun Nov 14 05:20:53 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:20:53 2021

best accuracy so far: 0.563329
Sun Nov 14 05:22:45 2021


Validation Results
Global Steps: 6000
Valid Loss: 0.90020
Valid Accuracy: 0.80232
Sun Nov 14 05:22:46 2021

best accuracy so far: 0.802452
Sun Nov 14 05:23:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:23:40 2021

 train accuracy so far: 0.991211
Sun Nov 14 05:25:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:27:27 2021


Validation Results
Global Steps: 1200
Valid Loss: 1.26327
Valid Accuracy: 0.64441
Sun Nov 14 05:27:27 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:27:27 2021

best accuracy so far: 0.644413
Sun Nov 14 05:28:19 2021

 train accuracy so far: 0.621484
Sun Nov 14 05:29:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:29:38 2021


Validation Results
Global Steps: 6200
Valid Loss: 0.88071
Valid Accuracy: 0.80885
Sun Nov 14 05:29:38 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:29:38 2021

best accuracy so far: 0.808848
Sun Nov 14 05:31:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:34:01 2021


Validation Results
Global Steps: 1400
Valid Loss: 1.12925
Valid Accuracy: 0.67133
Sun Nov 14 05:34:01 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:34:01 2021

best accuracy so far: 0.671331
Sun Nov 14 05:36:09 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:36:29 2021


Validation Results
Global Steps: 6400
Valid Loss: 0.91417
Valid Accuracy: 0.81058
Sun Nov 14 05:36:30 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:36:30 2021

best accuracy so far: 0.810580
Sun Nov 14 05:36:30 2021

 train accuracy so far: 0.995508
Sun Nov 14 05:38:45 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:40:35 2021


Validation Results
Global Steps: 1600
Valid Loss: 1.06202
Valid Accuracy: 0.68492
Sun Nov 14 05:40:36 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:40:36 2021

best accuracy so far: 0.684922
Sun Nov 14 05:40:36 2021

 train accuracy so far: 0.716602
Sun Nov 14 05:42:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:43:21 2021


Validation Results
Global Steps: 6600
Valid Loss: 0.91502
Valid Accuracy: 0.81011
Sun Nov 14 05:43:22 2021

best accuracy so far: 0.810580
Sun Nov 14 05:44:43 2021

 train accuracy so far: 0.994922
Sun Nov 14 05:45:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:47:09 2021


Validation Results
Global Steps: 1800
Valid Loss: 1.00050
Valid Accuracy: 0.69692
Sun Nov 14 05:47:10 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:47:10 2021

best accuracy so far: 0.696915
Sun Nov 14 05:48:26 2021

 train accuracy so far: 0.777148
Sun Nov 14 05:49:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:50:12 2021


Validation Results
Global Steps: 6800
Valid Loss: 0.89702
Valid Accuracy: 0.81385
Sun Nov 14 05:50:13 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:50:13 2021

best accuracy so far: 0.813845
Sun Nov 14 05:52:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:53:43 2021


Validation Results
Global Steps: 2000
Valid Loss: 0.97168
Valid Accuracy: 0.70791
Sun Nov 14 05:53:44 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:53:44 2021

best accuracy so far: 0.707909
Sun Nov 14 05:55:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 05:57:03 2021


Validation Results
Global Steps: 7000
Valid Loss: 0.87776
Valid Accuracy: 0.81618
Sun Nov 14 05:57:04 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 05:57:04 2021

best accuracy so far: 0.816177
Sun Nov 14 05:57:31 2021

 train accuracy so far: 0.995898
Sun Nov 14 05:59:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:00:17 2021


Validation Results
Global Steps: 2200
Valid Loss: 0.89097
Valid Accuracy: 0.73096
Sun Nov 14 06:00:18 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:00:18 2021

best accuracy so far: 0.730961
Sun Nov 14 06:00:43 2021

 train accuracy so far: 0.811914
Sun Nov 14 06:02:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:03:56 2021


Validation Results
Global Steps: 7200
Valid Loss: 0.88768
Valid Accuracy: 0.81771
Sun Nov 14 06:03:57 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:03:57 2021

best accuracy so far: 0.817709
Sun Nov 14 06:05:45 2021

 train accuracy so far: 0.997656
Sun Nov 14 06:06:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:06:51 2021


Validation Results
Global Steps: 2400
Valid Loss: 0.95317
Valid Accuracy: 0.72896
Sun Nov 14 06:06:52 2021

best accuracy so far: 0.730961
Sun Nov 14 06:08:34 2021

 train accuracy so far: 0.849219
Sun Nov 14 06:08:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:10:49 2021


Validation Results
Global Steps: 7400
Valid Loss: 0.88769
Valid Accuracy: 0.82051
Sun Nov 14 06:10:49 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:10:49 2021

best accuracy so far: 0.820508
Sun Nov 14 06:13:04 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:13:25 2021


Validation Results
Global Steps: 2600
Valid Loss: 0.84827
Valid Accuracy: 0.74262
Sun Nov 14 06:13:26 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:13:26 2021

best accuracy so far: 0.742621
Sun Nov 14 06:15:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:17:40 2021


Validation Results
Global Steps: 7600
Valid Loss: 0.88221
Valid Accuracy: 0.82117
Sun Nov 14 06:17:41 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:17:41 2021

best accuracy so far: 0.821174
Sun Nov 14 06:18:35 2021

 train accuracy so far: 0.998047
Sun Nov 14 06:19:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:20:00 2021


Validation Results
Global Steps: 2800
Valid Loss: 0.82680
Valid Accuracy: 0.76061
Sun Nov 14 06:20:00 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:20:00 2021

best accuracy so far: 0.760610
Sun Nov 14 06:20:51 2021

 train accuracy so far: 0.875000
Sun Nov 14 06:22:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:24:32 2021


Validation Results
Global Steps: 7800
Valid Loss: 0.89409
Valid Accuracy: 0.82044
Sun Nov 14 06:24:33 2021

best accuracy so far: 0.821174
Sun Nov 14 06:26:34 2021


Validation Results
Global Steps: 3000
Valid Loss: 0.81171
Valid Accuracy: 0.76181
Sun Nov 14 06:26:34 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:26:34 2021

best accuracy so far: 0.761810
Sun Nov 14 06:26:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:28:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:31:23 2021


Validation Results
Global Steps: 8000
Valid Loss: 0.88875
Valid Accuracy: 0.82144
Sun Nov 14 06:31:23 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:31:23 2021

best accuracy so far: 0.821440
Sun Nov 14 06:31:23 2021

 train accuracy so far: 0.998437
Sun Nov 14 06:33:08 2021


Validation Results
Global Steps: 3200
Valid Loss: 0.78119
Valid Accuracy: 0.77454
Sun Nov 14 06:33:09 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:33:09 2021

best accuracy so far: 0.774535
Sun Nov 14 06:33:09 2021

 train accuracy so far: 0.892383
Sun Nov 14 06:33:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:35:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:38:14 2021


Validation Results
Global Steps: 8200
Valid Loss: 0.88938
Valid Accuracy: 0.81931
Sun Nov 14 06:38:14 2021

best accuracy so far: 0.821440
Sun Nov 14 06:39:34 2021

 train accuracy so far: 0.999023
Sun Nov 14 06:39:42 2021


Validation Results
Global Steps: 3400
Valid Loss: 0.79681
Valid Accuracy: 0.76974
Sun Nov 14 06:39:43 2021

best accuracy so far: 0.774535
Sun Nov 14 06:40:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:40:59 2021

 train accuracy so far: 0.912695
Sun Nov 14 06:41:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:45:03 2021


Validation Results
Global Steps: 8400
Valid Loss: 0.88621
Valid Accuracy: 0.82144
Sun Nov 14 06:45:04 2021

best accuracy so far: 0.821440
Sun Nov 14 06:46:16 2021


Validation Results
Global Steps: 3600
Valid Loss: 0.80348
Valid Accuracy: 0.77234
Sun Nov 14 06:46:16 2021

best accuracy so far: 0.774535
Sun Nov 14 06:47:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:48:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:51:52 2021


Validation Results
Global Steps: 8600
Valid Loss: 0.88842
Valid Accuracy: 0.82144
Sun Nov 14 06:51:53 2021

best accuracy so far: 0.821440
Sun Nov 14 06:52:20 2021

 train accuracy so far: 0.998437
Sun Nov 14 06:52:49 2021


Validation Results
Global Steps: 3800
Valid Loss: 0.82239
Valid Accuracy: 0.77320
Sun Nov 14 06:52:49 2021

best accuracy so far: 0.774535
Sun Nov 14 06:53:15 2021

 train accuracy so far: 0.927539
Sun Nov 14 06:54:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:54:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 06:58:42 2021


Validation Results
Global Steps: 8800
Valid Loss: 0.88489
Valid Accuracy: 0.82151
Sun Nov 14 06:58:43 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:58:43 2021

best accuracy so far: 0.821507
Sun Nov 14 06:59:23 2021


Validation Results
Global Steps: 4000
Valid Loss: 0.78894
Valid Accuracy: 0.78380
Sun Nov 14 06:59:23 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 06:59:23 2021

best accuracy so far: 0.783796
Sun Nov 14 07:00:30 2021

 train accuracy so far: 0.998437
Sun Nov 14 07:00:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:01:05 2021

 train accuracy so far: 0.946484
Sun Nov 14 07:01:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:05:33 2021


Validation Results
Global Steps: 9000
Valid Loss: 0.88468
Valid Accuracy: 0.82257
Sun Nov 14 07:05:33 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 07:05:33 2021

best accuracy so far: 0.822573
Sun Nov 14 07:05:57 2021


Validation Results
Global Steps: 4200
Valid Loss: 0.84045
Valid Accuracy: 0.78106
Sun Nov 14 07:05:57 2021

best accuracy so far: 0.783796
Sun Nov 14 07:07:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:08:04 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:12:24 2021


Validation Results
Global Steps: 9200
Valid Loss: 0.88287
Valid Accuracy: 0.82204
Sun Nov 14 07:12:24 2021

best accuracy so far: 0.822573
Sun Nov 14 07:12:30 2021


Validation Results
Global Steps: 4400
Valid Loss: 0.84942
Valid Accuracy: 0.77720
Sun Nov 14 07:12:31 2021

best accuracy so far: 0.783796
Sun Nov 14 07:13:18 2021

 train accuracy so far: 0.998633
Sun Nov 14 07:13:22 2021

 train accuracy so far: 0.951758
Sun Nov 14 07:14:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:14:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:19:04 2021


Validation Results
Global Steps: 4600
Valid Loss: 0.89192
Valid Accuracy: 0.77260
Sun Nov 14 07:19:05 2021

best accuracy so far: 0.783796
Sun Nov 14 07:19:15 2021


Validation Results
Global Steps: 9400
Valid Loss: 0.88405
Valid Accuracy: 0.82184
Sun Nov 14 07:19:15 2021

best accuracy so far: 0.822573
Sun Nov 14 07:21:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:21:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:25:39 2021


Validation Results
Global Steps: 4800
Valid Loss: 0.85704
Valid Accuracy: 0.78126
Sun Nov 14 07:25:39 2021

best accuracy so far: 0.783796
Sun Nov 14 07:25:39 2021

 train accuracy so far: 0.965820
Sun Nov 14 07:26:05 2021


Validation Results
Global Steps: 9600
Valid Loss: 0.88392
Valid Accuracy: 0.82184
Sun Nov 14 07:26:06 2021

best accuracy so far: 0.822573
Sun Nov 14 07:26:06 2021

 train accuracy so far: 0.998828
Sun Nov 14 07:27:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:28:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:32:13 2021


Validation Results
Global Steps: 5000
Valid Loss: 0.79219
Valid Accuracy: 0.80072
Sun Nov 14 07:32:13 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 07:32:13 2021

best accuracy so far: 0.800720
Sun Nov 14 07:32:56 2021


Validation Results
Global Steps: 9800
Valid Loss: 0.88368
Valid Accuracy: 0.82177
Sun Nov 14 07:32:56 2021

best accuracy so far: 0.822573
Sun Nov 14 07:33:30 2021

 train accuracy so far: 0.969727
Sun Nov 14 07:34:16 2021

 train accuracy so far: 0.999414
Sun Nov 14 07:34:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:35:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:38:47 2021


Validation Results
Global Steps: 5200
Valid Loss: 0.83900
Valid Accuracy: 0.79672
Sun Nov 14 07:38:47 2021

best accuracy so far: 0.800720
Sun Nov 14 07:39:47 2021


Validation Results
Global Steps: 10000
Valid Loss: 0.88374
Valid Accuracy: 0.82171
Sun Nov 14 07:39:48 2021

best accuracy so far: 0.822573
Sun Nov 14 07:39:48 2021

 train accuracy so far: 0.999219
Sun Nov 14 07:39:48 2021

Best Accuracy: 	0.822573
End Training!
Total Training Time: 	5.711309


Sun Nov 14 07:40:01 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 07:40:03 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 07:40:55 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:41:13 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 07:43:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:45:20 2021


Validation Results
Global Steps: 5400
Valid Loss: 0.83698
Valid Accuracy: 0.79772
Sun Nov 14 07:45:20 2021

best accuracy so far: 0.800720
Sun Nov 14 07:45:46 2021

 train accuracy so far: 0.978125
Sun Nov 14 07:47:28 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:48:02 2021


Validation Results
Global Steps: 200
Valid Loss: 5.41298
Valid Accuracy: 0.00873
Sun Nov 14 07:48:03 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 07:48:03 2021

best accuracy so far: 0.008728
Sun Nov 14 07:49:23 2021

 train accuracy so far: 0.010937
Sun Nov 14 07:50:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:51:53 2021


Validation Results
Global Steps: 5600
Valid Loss: 0.83675
Valid Accuracy: 0.79772
Sun Nov 14 07:51:54 2021

best accuracy so far: 0.800720
Sun Nov 14 07:53:36 2021

 train accuracy so far: 0.983594
Sun Nov 14 07:54:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:54:49 2021


Validation Results
Global Steps: 400
Valid Loss: 7.16657
Valid Accuracy: 0.00320
Sun Nov 14 07:54:49 2021

best accuracy so far: 0.008728
Sun Nov 14 07:56:55 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 07:58:27 2021


Validation Results
Global Steps: 5800
Valid Loss: 0.82563
Valid Accuracy: 0.80558
Sun Nov 14 07:58:27 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 07:58:27 2021

best accuracy so far: 0.805583
Sun Nov 14 08:00:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:01:27 2021


Validation Results
Global Steps: 600
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 08:01:27 2021

best accuracy so far: 0.008728
Sun Nov 14 08:01:52 2021

 train accuracy so far: 0.005078
Sun Nov 14 08:03:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:05:00 2021


Validation Results
Global Steps: 6000
Valid Loss: 0.83880
Valid Accuracy: 0.81025
Sun Nov 14 08:05:01 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:05:01 2021

best accuracy so far: 0.810247
Sun Nov 14 08:05:52 2021

 train accuracy so far: 0.989258
Sun Nov 14 08:07:09 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:08:03 2021


Validation Results
Global Steps: 800
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 08:08:03 2021

best accuracy so far: 0.008728
Sun Nov 14 08:09:42 2021

 train accuracy so far: 0.006836
Sun Nov 14 08:10:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:11:34 2021


Validation Results
Global Steps: 6200
Valid Loss: 0.84493
Valid Accuracy: 0.80665
Sun Nov 14 08:11:34 2021

best accuracy so far: 0.810247
Sun Nov 14 08:13:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:14:38 2021


Validation Results
Global Steps: 1000
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 08:14:38 2021

best accuracy so far: 0.008728
Sun Nov 14 08:16:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:18:08 2021


Validation Results
Global Steps: 6400
Valid Loss: 0.83166
Valid Accuracy: 0.81118
Sun Nov 14 08:18:08 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:18:08 2021

best accuracy so far: 0.811180
Sun Nov 14 08:18:08 2021

 train accuracy so far: 0.994141
Sun Nov 14 08:20:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:21:13 2021


Validation Results
Global Steps: 1200
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 08:21:13 2021

best accuracy so far: 0.008728
Sun Nov 14 08:21:21 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 08:21:23 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 08:22:34 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 08:24:40 2021


Validation Results
Global Steps: 6600
Valid Loss: 0.87926
Valid Accuracy: 0.81018
Sun Nov 14 08:24:41 2021

best accuracy so far: 0.811180
Sun Nov 14 08:24:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:25:57 2021

 train accuracy so far: 0.994336
Sun Nov 14 08:26:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:29:25 2021


Validation Results
Global Steps: 200
Valid Loss: 5.14648
Valid Accuracy: 0.04098
Sun Nov 14 08:29:26 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:29:26 2021

best accuracy so far: 0.040975
Sun Nov 14 08:30:47 2021

 train accuracy so far: 0.025781
Sun Nov 14 08:31:14 2021


Validation Results
Global Steps: 6800
Valid Loss: 0.86135
Valid Accuracy: 0.81398
Sun Nov 14 08:31:15 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:31:15 2021

best accuracy so far: 0.813978
Sun Nov 14 08:31:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:33:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:36:19 2021


Validation Results
Global Steps: 400
Valid Loss: 4.42414
Valid Accuracy: 0.12459
Sun Nov 14 08:36:20 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:36:20 2021

best accuracy so far: 0.124592
Sun Nov 14 08:37:48 2021


Validation Results
Global Steps: 7000
Valid Loss: 0.83372
Valid Accuracy: 0.81924
Sun Nov 14 08:37:48 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:37:48 2021

best accuracy so far: 0.819242
Sun Nov 14 08:38:14 2021

 train accuracy so far: 0.994727
Sun Nov 14 08:38:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:39:55 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:43:15 2021


Validation Results
Global Steps: 600
Valid Loss: 3.09923
Valid Accuracy: 0.30608
Sun Nov 14 08:43:15 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:43:15 2021

best accuracy so far: 0.306083
Sun Nov 14 08:43:43 2021

 train accuracy so far: 0.180273
Sun Nov 14 08:44:22 2021


Validation Results
Global Steps: 7200
Valid Loss: 0.83694
Valid Accuracy: 0.82004
Sun Nov 14 08:44:22 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:44:22 2021

best accuracy so far: 0.820041
Sun Nov 14 08:45:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:46:04 2021

 train accuracy so far: 0.998047
Sun Nov 14 08:46:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:50:07 2021


Validation Results
Global Steps: 800
Valid Loss: 2.36916
Valid Accuracy: 0.41715
Sun Nov 14 08:50:08 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:50:08 2021

best accuracy so far: 0.417150
Sun Nov 14 08:50:55 2021


Validation Results
Global Steps: 7400
Valid Loss: 0.84749
Valid Accuracy: 0.81971
Sun Nov 14 08:50:55 2021

best accuracy so far: 0.820041
Sun Nov 14 08:51:56 2021

 train accuracy so far: 0.413281
Sun Nov 14 08:52:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:53:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:57:01 2021


Validation Results
Global Steps: 1000
Valid Loss: 1.82522
Valid Accuracy: 0.53028
Sun Nov 14 08:57:02 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:57:02 2021

best accuracy so far: 0.530282
Sun Nov 14 08:57:29 2021


Validation Results
Global Steps: 7600
Valid Loss: 0.84060
Valid Accuracy: 0.82011
Sun Nov 14 08:57:29 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 08:57:29 2021

best accuracy so far: 0.820108
Sun Nov 14 08:58:20 2021

 train accuracy so far: 0.997070
Sun Nov 14 08:59:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 08:59:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:03:55 2021


Validation Results
Global Steps: 1200
Valid Loss: 1.43093
Valid Accuracy: 0.61330
Sun Nov 14 09:03:55 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:03:55 2021

best accuracy so far: 0.613299
Sun Nov 14 09:04:02 2021


Validation Results
Global Steps: 7800
Valid Loss: 0.84359
Valid Accuracy: 0.82231
Sun Nov 14 09:04:03 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:04:03 2021

best accuracy so far: 0.822307
Sun Nov 14 09:04:49 2021

 train accuracy so far: 0.582031
Sun Nov 14 09:06:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:06:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:10:40 2021


Validation Results
Global Steps: 8000
Valid Loss: 0.84274
Valid Accuracy: 0.82091
Sun Nov 14 09:10:40 2021

best accuracy so far: 0.822307
Sun Nov 14 09:10:40 2021

 train accuracy so far: 0.997656
Sun Nov 14 09:10:53 2021


Validation Results
Global Steps: 1400
Valid Loss: 1.29340
Valid Accuracy: 0.64015
Sun Nov 14 09:10:54 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:10:54 2021

best accuracy so far: 0.640149
Sun Nov 14 09:12:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:13:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:17:16 2021


Validation Results
Global Steps: 8200
Valid Loss: 0.83581
Valid Accuracy: 0.82337
Sun Nov 14 09:17:16 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:17:16 2021

best accuracy so far: 0.823373
Sun Nov 14 09:17:49 2021


Validation Results
Global Steps: 1600
Valid Loss: 1.15220
Valid Accuracy: 0.67466
Sun Nov 14 09:17:50 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:17:50 2021

best accuracy so far: 0.674662
Sun Nov 14 09:17:50 2021

 train accuracy so far: 0.671680
Sun Nov 14 09:18:33 2021

 train accuracy so far: 0.998047
Sun Nov 14 09:19:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:20:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:23:53 2021


Validation Results
Global Steps: 8400
Valid Loss: 0.83133
Valid Accuracy: 0.82537
Sun Nov 14 09:23:53 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:23:53 2021

best accuracy so far: 0.825371
Sun Nov 14 09:24:46 2021


Validation Results
Global Steps: 1800
Valid Loss: 1.04253
Valid Accuracy: 0.70005
Sun Nov 14 09:24:46 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:24:46 2021

best accuracy so far: 0.700047
Sun Nov 14 09:26:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:26:09 2021

 train accuracy so far: 0.747266
Sun Nov 14 09:27:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:30:29 2021


Validation Results
Global Steps: 8600
Valid Loss: 0.83649
Valid Accuracy: 0.82317
Sun Nov 14 09:30:29 2021

best accuracy so far: 0.825371
Sun Nov 14 09:30:55 2021

 train accuracy so far: 0.998047
Sun Nov 14 09:31:43 2021


Validation Results
Global Steps: 2000
Valid Loss: 0.95214
Valid Accuracy: 0.71344
Sun Nov 14 09:31:44 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:31:44 2021

best accuracy so far: 0.713439
Sun Nov 14 09:32:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:34:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:37:05 2021


Validation Results
Global Steps: 8800
Valid Loss: 0.83294
Valid Accuracy: 0.82510
Sun Nov 14 09:37:05 2021

best accuracy so far: 0.825371
Sun Nov 14 09:38:41 2021


Validation Results
Global Steps: 2200
Valid Loss: 0.88005
Valid Accuracy: 0.73543
Sun Nov 14 09:38:42 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:38:42 2021

best accuracy so far: 0.735425
Sun Nov 14 09:38:47 2021

 train accuracy so far: 0.998633
Sun Nov 14 09:39:09 2021

 train accuracy so far: 0.797852
Sun Nov 14 09:39:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:40:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:43:41 2021


Validation Results
Global Steps: 9000
Valid Loss: 0.83271
Valid Accuracy: 0.82517
Sun Nov 14 09:43:41 2021

best accuracy so far: 0.825371
Sun Nov 14 09:45:38 2021


Validation Results
Global Steps: 2400
Valid Loss: 0.90216
Valid Accuracy: 0.73183
Sun Nov 14 09:45:38 2021

best accuracy so far: 0.735425
Sun Nov 14 09:45:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:47:27 2021

 train accuracy so far: 0.834375
Sun Nov 14 09:47:54 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:50:15 2021


Validation Results
Global Steps: 9200
Valid Loss: 0.83224
Valid Accuracy: 0.82544
Sun Nov 14 09:50:16 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:50:16 2021

best accuracy so far: 0.825438
Sun Nov 14 09:51:07 2021

 train accuracy so far: 0.998437
Sun Nov 14 09:52:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:52:34 2021


Validation Results
Global Steps: 2600
Valid Loss: 0.80673
Valid Accuracy: 0.74862
Sun Nov 14 09:52:34 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:52:34 2021

best accuracy so far: 0.748617
Sun Nov 14 09:54:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:56:51 2021


Validation Results
Global Steps: 9400
Valid Loss: 0.83182
Valid Accuracy: 0.82510
Sun Nov 14 09:56:51 2021

best accuracy so far: 0.825438
Sun Nov 14 09:58:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 09:59:28 2021


Validation Results
Global Steps: 2800
Valid Loss: 0.82091
Valid Accuracy: 0.75548
Sun Nov 14 09:59:29 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 09:59:29 2021

best accuracy so far: 0.755480
Sun Nov 14 10:00:24 2021

 train accuracy so far: 0.866602
Sun Nov 14 10:01:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:03:26 2021


Validation Results
Global Steps: 9600
Valid Loss: 0.83214
Valid Accuracy: 0.82510
Sun Nov 14 10:03:26 2021

best accuracy so far: 0.825438
Sun Nov 14 10:03:26 2021

 train accuracy so far: 0.998828
Sun Nov 14 10:05:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:06:24 2021


Validation Results
Global Steps: 3000
Valid Loss: 0.75165
Valid Accuracy: 0.77014
Sun Nov 14 10:06:25 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 10:06:25 2021

best accuracy so far: 0.770138
Sun Nov 14 10:08:41 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:10:01 2021


Validation Results
Global Steps: 9800
Valid Loss: 0.83246
Valid Accuracy: 0.82517
Sun Nov 14 10:10:01 2021

best accuracy so far: 0.825438
Sun Nov 14 10:11:18 2021

 train accuracy so far: 0.999219
Sun Nov 14 10:12:09 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:13:19 2021


Validation Results
Global Steps: 3200
Valid Loss: 0.72988
Valid Accuracy: 0.78053
Sun Nov 14 10:13:20 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 10:13:20 2021

best accuracy so far: 0.780532
Sun Nov 14 10:13:20 2021

 train accuracy so far: 0.884375
Sun Nov 14 10:15:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:16:36 2021


Validation Results
Global Steps: 10000
Valid Loss: 0.83245
Valid Accuracy: 0.82510
Sun Nov 14 10:16:37 2021

best accuracy so far: 0.825438
Sun Nov 14 10:16:37 2021

 train accuracy so far: 0.999219
Sun Nov 14 10:16:37 2021

Best Accuracy: 	0.825438
End Training!
Total Training Time: 	5.475915


Sun Nov 14 10:16:52 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 10:16:54 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 10:18:07 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 10:20:14 2021


Validation Results
Global Steps: 3400
Valid Loss: 0.72633
Valid Accuracy: 0.77787
Sun Nov 14 10:20:14 2021

best accuracy so far: 0.780532
Sun Nov 14 10:20:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:21:36 2021

 train accuracy so far: 0.904883
Sun Nov 14 10:22:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:24:42 2021


Validation Results
Global Steps: 200
Valid Loss: 5.42942
Valid Accuracy: 0.00533
Sun Nov 14 10:24:43 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 10:24:43 2021

best accuracy so far: 0.005330
Sun Nov 14 10:26:01 2021

 train accuracy so far: 0.013086
Sun Nov 14 10:26:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:27:09 2021


Validation Results
Global Steps: 3600
Valid Loss: 0.73205
Valid Accuracy: 0.78027
Sun Nov 14 10:27:09 2021

best accuracy so far: 0.780532
Sun Nov 14 10:29:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:31:19 2021


Validation Results
Global Steps: 400
Valid Loss: 5.18036
Valid Accuracy: 0.01572
Sun Nov 14 10:31:20 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 10:31:20 2021

best accuracy so far: 0.015724
Sun Nov 14 10:33:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:34:05 2021


Validation Results
Global Steps: 3800
Valid Loss: 0.71561
Valid Accuracy: 0.78793
Sun Nov 14 10:34:06 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 10:34:06 2021

best accuracy so far: 0.787927
Sun Nov 14 10:34:33 2021

 train accuracy so far: 0.918359
Sun Nov 14 10:36:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:37:56 2021


Validation Results
Global Steps: 600
Valid Loss: 5.15222
Valid Accuracy: 0.03538
Sun Nov 14 10:37:56 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 10:37:56 2021

best accuracy so far: 0.035379
Sun Nov 14 10:38:22 2021

 train accuracy so far: 0.029102
Sun Nov 14 10:40:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:41:00 2021


Validation Results
Global Steps: 4000
Valid Loss: 0.70959
Valid Accuracy: 0.79113
Sun Nov 14 10:41:01 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 10:41:01 2021

best accuracy so far: 0.791125
Sun Nov 14 10:42:50 2021

 train accuracy so far: 0.939844
Sun Nov 14 10:43:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:44:33 2021


Validation Results
Global Steps: 800
Valid Loss: 5.13331
Valid Accuracy: 0.03538
Sun Nov 14 10:44:33 2021

best accuracy so far: 0.035379
Sun Nov 14 10:46:18 2021

 train accuracy so far: 0.031445
Sun Nov 14 10:46:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:47:56 2021


Validation Results
Global Steps: 4200
Valid Loss: 0.72054
Valid Accuracy: 0.79166
Sun Nov 14 10:47:56 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 10:47:56 2021

best accuracy so far: 0.791658
Sun Nov 14 10:50:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:51:10 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.12729
Valid Accuracy: 0.03538
Sun Nov 14 10:51:10 2021

best accuracy so far: 0.035379
Sun Nov 14 10:53:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:54:52 2021


Validation Results
Global Steps: 4400
Valid Loss: 0.70082
Valid Accuracy: 0.79759
Sun Nov 14 10:54:53 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 10:54:53 2021

best accuracy so far: 0.797588
Sun Nov 14 10:55:47 2021

 train accuracy so far: 0.946094
Sun Nov 14 10:57:09 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 10:57:46 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.13367
Valid Accuracy: 0.03538
Sun Nov 14 10:57:47 2021

best accuracy so far: 0.035379
Sun Nov 14 10:58:39 2021

 train accuracy so far: 0.031836
Sun Nov 14 10:59:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:01:48 2021


Validation Results
Global Steps: 4600
Valid Loss: 0.72851
Valid Accuracy: 0.79579
Sun Nov 14 11:01:49 2021

best accuracy so far: 0.797588
Sun Nov 14 11:04:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:04:23 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.15254
Valid Accuracy: 0.03538
Sun Nov 14 11:04:23 2021

best accuracy so far: 0.035379
Sun Nov 14 11:06:33 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:08:44 2021


Validation Results
Global Steps: 4800
Valid Loss: 0.68428
Valid Accuracy: 0.80558
Sun Nov 14 11:08:45 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 11:08:45 2021

best accuracy so far: 0.805583
Sun Nov 14 11:08:45 2021

 train accuracy so far: 0.956836
Sun Nov 14 11:10:58 2021


Validation Results
Global Steps: 1600
Valid Loss: 5.12203
Valid Accuracy: 0.03538
Sun Nov 14 11:10:58 2021

best accuracy so far: 0.035379
Sun Nov 14 11:10:58 2021

 train accuracy so far: 0.031445
Sun Nov 14 11:11:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:13:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:15:41 2021


Validation Results
Global Steps: 5000
Valid Loss: 0.73081
Valid Accuracy: 0.80225
Sun Nov 14 11:15:41 2021

best accuracy so far: 0.805583
Sun Nov 14 11:17:03 2021

 train accuracy so far: 0.961328
Sun Nov 14 11:17:34 2021


Validation Results
Global Steps: 1800
Valid Loss: 5.12486
Valid Accuracy: 0.03538
Sun Nov 14 11:17:34 2021

best accuracy so far: 0.035379
Sun Nov 14 11:17:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:18:51 2021

 train accuracy so far: 0.033398
Sun Nov 14 11:19:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:22:36 2021


Validation Results
Global Steps: 5200
Valid Loss: 0.71954
Valid Accuracy: 0.80358
Sun Nov 14 11:22:37 2021

best accuracy so far: 0.805583
Sun Nov 14 11:24:08 2021


Validation Results
Global Steps: 2000
Valid Loss: 5.13522
Valid Accuracy: 0.03538
Sun Nov 14 11:24:09 2021

best accuracy so far: 0.035379
Sun Nov 14 11:24:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:26:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:29:33 2021


Validation Results
Global Steps: 5400
Valid Loss: 0.72220
Valid Accuracy: 0.80605
Sun Nov 14 11:29:34 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 11:29:34 2021

best accuracy so far: 0.806050
Sun Nov 14 11:30:02 2021

 train accuracy so far: 0.970898
Sun Nov 14 11:30:43 2021


Validation Results
Global Steps: 2200
Valid Loss: 5.12320
Valid Accuracy: 0.03538
Sun Nov 14 11:30:43 2021

best accuracy so far: 0.035379
Sun Nov 14 11:31:09 2021

 train accuracy so far: 0.031250
Sun Nov 14 11:31:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:32:53 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:36:31 2021


Validation Results
Global Steps: 5600
Valid Loss: 0.69679
Valid Accuracy: 0.81125
Sun Nov 14 11:36:31 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 11:36:31 2021

best accuracy so far: 0.811247
Sun Nov 14 11:37:18 2021


Validation Results
Global Steps: 2400
Valid Loss: 5.16796
Valid Accuracy: 0.03538
Sun Nov 14 11:37:18 2021

best accuracy so far: 0.035379
Sun Nov 14 11:38:20 2021

 train accuracy so far: 0.978320
Sun Nov 14 11:38:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:39:01 2021

 train accuracy so far: 0.033984
Sun Nov 14 11:39:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:43:27 2021


Validation Results
Global Steps: 5800
Valid Loss: 0.71780
Valid Accuracy: 0.81225
Sun Nov 14 11:43:28 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 11:43:28 2021

best accuracy so far: 0.812246
Sun Nov 14 11:43:52 2021


Validation Results
Global Steps: 2600
Valid Loss: 5.14738
Valid Accuracy: 0.03538
Sun Nov 14 11:43:52 2021

best accuracy so far: 0.035379
Sun Nov 14 11:45:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:46:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:50:24 2021


Validation Results
Global Steps: 6000
Valid Loss: 0.72945
Valid Accuracy: 0.81151
Sun Nov 14 11:50:24 2021

best accuracy so far: 0.812246
Sun Nov 14 11:50:26 2021


Validation Results
Global Steps: 2800
Valid Loss: 5.15637
Valid Accuracy: 0.03538
Sun Nov 14 11:50:27 2021

best accuracy so far: 0.035379
Sun Nov 14 11:51:18 2021

 train accuracy so far: 0.030078
Sun Nov 14 11:51:19 2021

 train accuracy so far: 0.979102
Sun Nov 14 11:52:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:52:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 11:57:01 2021


Validation Results
Global Steps: 3000
Valid Loss: 5.14557
Valid Accuracy: 0.03538
Sun Nov 14 11:57:01 2021

best accuracy so far: 0.035379
Sun Nov 14 11:57:17 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 11:57:20 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 11:57:21 2021


Validation Results
Global Steps: 6200
Valid Loss: 0.73085
Valid Accuracy: 0.80745
Sun Nov 14 11:57:21 2021

best accuracy so far: 0.812246
Sun Nov 14 11:58:30 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 11:59:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:00:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:04:16 2021


Validation Results
Global Steps: 6400
Valid Loss: 0.73032
Valid Accuracy: 0.81231
Sun Nov 14 12:04:16 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 12:04:16 2021

best accuracy so far: 0.812313
Sun Nov 14 12:04:16 2021

 train accuracy so far: 0.987305
Sun Nov 14 12:05:05 2021


Validation Results
Global Steps: 200
Valid Loss: 4.79923
Valid Accuracy: 0.05277
Sun Nov 14 12:05:06 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 12:05:06 2021

best accuracy so far: 0.052768
Sun Nov 14 12:06:23 2021

 train accuracy so far: 0.043945
Sun Nov 14 12:06:33 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:07:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:11:11 2021


Validation Results
Global Steps: 6600
Valid Loss: 0.74519
Valid Accuracy: 0.81278
Sun Nov 14 12:11:11 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 12:11:11 2021

best accuracy so far: 0.812779
Sun Nov 14 12:11:40 2021


Validation Results
Global Steps: 400
Valid Loss: 5.08705
Valid Accuracy: 0.03505
Sun Nov 14 12:11:40 2021

best accuracy so far: 0.052768
Sun Nov 14 12:12:33 2021

 train accuracy so far: 0.989844
Sun Nov 14 12:13:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:13:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:18:07 2021


Validation Results
Global Steps: 6800
Valid Loss: 0.74293
Valid Accuracy: 0.81651
Sun Nov 14 12:18:08 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 12:18:08 2021

best accuracy so far: 0.816510
Sun Nov 14 12:18:10 2021


Validation Results
Global Steps: 600
Valid Loss: 5.28030
Valid Accuracy: 0.01566
Sun Nov 14 12:18:10 2021

best accuracy so far: 0.052768
Sun Nov 14 12:18:35 2021

 train accuracy so far: 0.023633
Sun Nov 14 12:20:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:20:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:24:38 2021


Validation Results
Global Steps: 800
Valid Loss: 5.17986
Valid Accuracy: 0.03505
Sun Nov 14 12:24:39 2021

best accuracy so far: 0.052768
Sun Nov 14 12:25:04 2021


Validation Results
Global Steps: 7000
Valid Loss: 0.73494
Valid Accuracy: 0.81764
Sun Nov 14 12:25:05 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 12:25:05 2021

best accuracy so far: 0.817643
Sun Nov 14 12:25:32 2021

 train accuracy so far: 0.992383
Sun Nov 14 12:26:18 2021

 train accuracy so far: 0.023828
Sun Nov 14 12:26:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:27:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:31:06 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.18981
Valid Accuracy: 0.03538
Sun Nov 14 12:31:06 2021

best accuracy so far: 0.052768
Sun Nov 14 12:31:59 2021


Validation Results
Global Steps: 7200
Valid Loss: 0.72782
Valid Accuracy: 0.82244
Sun Nov 14 12:31:59 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 12:31:59 2021

best accuracy so far: 0.822440
Sun Nov 14 12:33:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:33:48 2021

 train accuracy so far: 0.994141
Sun Nov 14 12:34:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:37:33 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.24329
Valid Accuracy: 0.03538
Sun Nov 14 12:37:43 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 12:37:45 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 12:38:53 2021


Validation Results
Global Steps: 7400
Valid Loss: 0.73765
Valid Accuracy: 0.82104
Sun Nov 14 12:38:53 2021

best accuracy so far: 0.822440
Sun Nov 14 12:38:57 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 12:41:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:41:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:45:30 2021


Validation Results
Global Steps: 200
Valid Loss: 5.11129
Valid Accuracy: 0.04011
Sun Nov 14 12:45:31 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 12:45:31 2021

best accuracy so far: 0.040109
Sun Nov 14 12:45:46 2021


Validation Results
Global Steps: 7600
Valid Loss: 0.74542
Valid Accuracy: 0.81704
Sun Nov 14 12:45:46 2021

best accuracy so far: 0.822440
Sun Nov 14 12:46:41 2021

 train accuracy so far: 0.995703
Sun Nov 14 12:46:48 2021

 train accuracy so far: 0.032422
Sun Nov 14 12:47:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:48:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:52:06 2021


Validation Results
Global Steps: 400
Valid Loss: 4.05661
Valid Accuracy: 0.16563
Sun Nov 14 12:52:06 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 12:52:06 2021

best accuracy so far: 0.165634
Sun Nov 14 12:52:40 2021


Validation Results
Global Steps: 7800
Valid Loss: 0.74051
Valid Accuracy: 0.82091
Sun Nov 14 12:52:41 2021

best accuracy so far: 0.822440
Sun Nov 14 12:54:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:54:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 12:58:41 2021


Validation Results
Global Steps: 600
Valid Loss: 2.64755
Valid Accuracy: 0.35372
Sun Nov 14 12:58:42 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 12:58:42 2021

best accuracy so far: 0.353721
Sun Nov 14 12:59:07 2021

 train accuracy so far: 0.219727
Sun Nov 14 12:59:34 2021


Validation Results
Global Steps: 8000
Valid Loss: 0.73688
Valid Accuracy: 0.82184
Sun Nov 14 12:59:35 2021

best accuracy so far: 0.822440
Sun Nov 14 12:59:35 2021

 train accuracy so far: 0.995703
Sun Nov 14 13:00:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:01:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:05:16 2021


Validation Results
Global Steps: 800
Valid Loss: 1.92092
Valid Accuracy: 0.48804
Sun Nov 14 13:05:16 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 13:05:16 2021

best accuracy so far: 0.488041
Sun Nov 14 13:06:28 2021


Validation Results
Global Steps: 8200
Valid Loss: 0.73502
Valid Accuracy: 0.82217
Sun Nov 14 13:06:28 2021

best accuracy so far: 0.822440
Sun Nov 14 13:06:58 2021

 train accuracy so far: 0.468945
Sun Nov 14 13:07:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:07:49 2021

 train accuracy so far: 0.996680
Sun Nov 14 13:08:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:11:50 2021


Validation Results
Global Steps: 1000
Valid Loss: 1.54721
Valid Accuracy: 0.57019
Sun Nov 14 13:11:51 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 13:11:51 2021

best accuracy so far: 0.570191
Sun Nov 14 13:13:21 2021


Validation Results
Global Steps: 8400
Valid Loss: 0.73980
Valid Accuracy: 0.82297
Sun Nov 14 13:13:21 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 13:13:21 2021

best accuracy so far: 0.822973
Sun Nov 14 13:13:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:15:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:18:23 2021


Validation Results
Global Steps: 1200
Valid Loss: 1.22758
Valid Accuracy: 0.63988
Sun Nov 14 13:18:24 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 13:18:24 2021

best accuracy so far: 0.639883
Sun Nov 14 13:19:15 2021

 train accuracy so far: 0.629297
Sun Nov 14 13:20:13 2021


Validation Results
Global Steps: 8600
Valid Loss: 0.74360
Valid Accuracy: 0.82157
Sun Nov 14 13:20:14 2021

best accuracy so far: 0.822973
Sun Nov 14 13:20:31 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:20:41 2021

 train accuracy so far: 0.997070
Sun Nov 14 13:22:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:24:57 2021


Validation Results
Global Steps: 1400
Valid Loss: 1.16505
Valid Accuracy: 0.66067
Sun Nov 14 13:24:58 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 13:24:58 2021

best accuracy so far: 0.660670
Sun Nov 14 13:27:05 2021


Validation Results
Global Steps: 8800
Valid Loss: 0.73445
Valid Accuracy: 0.82497
Sun Nov 14 13:27:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:27:06 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 13:27:06 2021

best accuracy so far: 0.824972
Sun Nov 14 13:28:55 2021

 train accuracy so far: 0.997656
Sun Nov 14 13:29:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:31:31 2021


Validation Results
Global Steps: 1600
Valid Loss: 1.13745
Valid Accuracy: 0.66400
Sun Nov 14 13:31:32 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 13:31:32 2021

best accuracy so far: 0.664002
Sun Nov 14 13:31:32 2021

 train accuracy so far: 0.714258
Sun Nov 14 13:33:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:33:58 2021


Validation Results
Global Steps: 9000
Valid Loss: 0.73727
Valid Accuracy: 0.82484
Sun Nov 14 13:33:58 2021

best accuracy so far: 0.824972
Sun Nov 14 13:36:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:38:07 2021


Validation Results
Global Steps: 1800
Valid Loss: 0.94779
Valid Accuracy: 0.70811
Sun Nov 14 13:38:07 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 13:38:07 2021

best accuracy so far: 0.708108
Sun Nov 14 13:39:24 2021

 train accuracy so far: 0.768359
Sun Nov 14 13:40:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:40:54 2021


Validation Results
Global Steps: 9200
Valid Loss: 0.73747
Valid Accuracy: 0.82497
Sun Nov 14 13:40:54 2021

best accuracy so far: 0.824972
Sun Nov 14 13:41:49 2021

 train accuracy so far: 0.997461
Sun Nov 14 13:43:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:44:43 2021


Validation Results
Global Steps: 2000
Valid Loss: 0.93790
Valid Accuracy: 0.71504
Sun Nov 14 13:44:43 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 13:44:43 2021

best accuracy so far: 0.715038
Sun Nov 14 13:46:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:47:48 2021


Validation Results
Global Steps: 9400
Valid Loss: 0.73726
Valid Accuracy: 0.82484
Sun Nov 14 13:47:48 2021

best accuracy so far: 0.824972
Sun Nov 14 13:50:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:51:18 2021


Validation Results
Global Steps: 2200
Valid Loss: 0.88243
Valid Accuracy: 0.73050
Sun Nov 14 13:51:19 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 13:51:19 2021

best accuracy so far: 0.730495
Sun Nov 14 13:51:44 2021

 train accuracy so far: 0.811914
Sun Nov 14 13:53:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:54:43 2021


Validation Results
Global Steps: 9600
Valid Loss: 0.73749
Valid Accuracy: 0.82464
Sun Nov 14 13:54:44 2021

best accuracy so far: 0.824972
Sun Nov 14 13:54:44 2021

 train accuracy so far: 0.997266
Sun Nov 14 13:57:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 13:57:53 2021


Validation Results
Global Steps: 2400
Valid Loss: 0.93941
Valid Accuracy: 0.72756
Sun Nov 14 13:57:54 2021

best accuracy so far: 0.730495
Sun Nov 14 13:59:36 2021

 train accuracy so far: 0.846094
Sun Nov 14 14:00:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:01:38 2021


Validation Results
Global Steps: 9800
Valid Loss: 0.73741
Valid Accuracy: 0.82491
Sun Nov 14 14:01:38 2021

best accuracy so far: 0.824972
Sun Nov 14 14:03:00 2021

 train accuracy so far: 0.997852
Sun Nov 14 14:03:55 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:04:29 2021


Validation Results
Global Steps: 2600
Valid Loss: 0.83225
Valid Accuracy: 0.74995
Sun Nov 14 14:04:29 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 14:04:29 2021

best accuracy so far: 0.749950
Sun Nov 14 14:06:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:08:33 2021


Validation Results
Global Steps: 10000
Valid Loss: 0.73749
Valid Accuracy: 0.82497
Sun Nov 14 14:08:34 2021

best accuracy so far: 0.824972
Sun Nov 14 14:08:34 2021

 train accuracy so far: 0.999219
Sun Nov 14 14:08:34 2021

Best Accuracy: 	0.824972
End Training!
Total Training Time: 	5.766630


Sun Nov 14 14:08:48 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 14:08:50 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 14:10:02 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 14:11:04 2021


Validation Results
Global Steps: 2800
Valid Loss: 0.78835
Valid Accuracy: 0.76881
Sun Nov 14 14:11:05 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 14:11:05 2021

best accuracy so far: 0.768805
Sun Nov 14 14:11:55 2021

 train accuracy so far: 0.876172
Sun Nov 14 14:12:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:13:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:16:57 2021


Validation Results
Global Steps: 200
Valid Loss: 3.75875
Valid Accuracy: 0.18049
Sun Nov 14 14:16:58 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 14:16:58 2021

best accuracy so far: 0.180492
Sun Nov 14 14:17:39 2021


Validation Results
Global Steps: 3000
Valid Loss: 0.80419
Valid Accuracy: 0.76134
Sun Nov 14 14:17:40 2021

best accuracy so far: 0.768805
Sun Nov 14 14:18:20 2021

 train accuracy so far: 0.124609
Sun Nov 14 14:19:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:19:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:23:55 2021


Validation Results
Global Steps: 400
Valid Loss: 4.81520
Valid Accuracy: 0.04924
Sun Nov 14 14:23:55 2021

best accuracy so far: 0.180492
Sun Nov 14 14:24:15 2021


Validation Results
Global Steps: 3200
Valid Loss: 0.74470
Valid Accuracy: 0.78166
Sun Nov 14 14:24:16 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 14:24:16 2021

best accuracy so far: 0.781664
Sun Nov 14 14:24:16 2021

 train accuracy so far: 0.895508
Sun Nov 14 14:26:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:26:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:30:51 2021


Validation Results
Global Steps: 3400
Valid Loss: 0.76411
Valid Accuracy: 0.78226
Sun Nov 14 14:30:51 2021


Validation Results
Global Steps: 600
Valid Loss: 5.24843
Valid Accuracy: 0.03538
Sun Nov 14 14:30:51 2021

best accuracy so far: 0.180492
Sun Nov 14 14:30:51 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 14:30:51 2021

best accuracy so far: 0.782264
Sun Nov 14 14:31:19 2021

 train accuracy so far: 0.042188
Sun Nov 14 14:32:08 2021

 train accuracy so far: 0.914844
Sun Nov 14 14:32:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:33:09 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:37:26 2021


Validation Results
Global Steps: 3600
Valid Loss: 0.85479
Valid Accuracy: 0.76041
Sun Nov 14 14:37:27 2021

best accuracy so far: 0.782264
Sun Nov 14 14:37:47 2021


Validation Results
Global Steps: 800
Valid Loss: 5.17721
Valid Accuracy: 0.03538
Sun Nov 14 14:37:47 2021

best accuracy so far: 0.180492
Sun Nov 14 14:39:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:39:37 2021

 train accuracy so far: 0.027539
Sun Nov 14 14:40:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:44:02 2021


Validation Results
Global Steps: 3800
Valid Loss: 0.81236
Valid Accuracy: 0.77240
Sun Nov 14 14:44:02 2021

best accuracy so far: 0.782264
Sun Nov 14 14:44:28 2021

 train accuracy so far: 0.927734
Sun Nov 14 14:44:41 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.14916
Valid Accuracy: 0.03538
Sun Nov 14 14:44:42 2021

best accuracy so far: 0.180492
Sun Nov 14 14:46:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:47:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:50:38 2021


Validation Results
Global Steps: 4000
Valid Loss: 0.81007
Valid Accuracy: 0.77907
Sun Nov 14 14:50:38 2021

best accuracy so far: 0.782264
Sun Nov 14 14:51:39 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.13485
Valid Accuracy: 0.03538
Sun Nov 14 14:51:39 2021

best accuracy so far: 0.180492
Sun Nov 14 14:51:48 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 14:51:51 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 14:52:20 2021

 train accuracy so far: 0.940625
Sun Nov 14 14:52:45 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:53:01 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 14:55:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:57:11 2021


Validation Results
Global Steps: 4200
Valid Loss: 0.81690
Valid Accuracy: 0.78007
Sun Nov 14 14:57:12 2021

best accuracy so far: 0.782264
Sun Nov 14 14:59:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 14:59:48 2021


Validation Results
Global Steps: 200
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 14:59:49 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 14:59:49 2021

best accuracy so far: 0.006863
Sun Nov 14 15:01:06 2021

 train accuracy so far: 0.008008
Sun Nov 14 15:01:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:03:46 2021


Validation Results
Global Steps: 4400
Valid Loss: 0.81125
Valid Accuracy: 0.78453
Sun Nov 14 15:03:47 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 15:03:47 2021

best accuracy so far: 0.784529
Sun Nov 14 15:04:38 2021

 train accuracy so far: 0.955664
Sun Nov 14 15:05:55 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:06:36 2021


Validation Results
Global Steps: 400
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 15:06:36 2021

best accuracy so far: 0.006863
Sun Nov 14 15:08:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:10:25 2021


Validation Results
Global Steps: 4600
Valid Loss: 0.83874
Valid Accuracy: 0.78946
Sun Nov 14 15:10:25 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 15:10:25 2021

best accuracy so far: 0.789460
Sun Nov 14 15:12:33 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:13:26 2021


Validation Results
Global Steps: 600
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 15:13:27 2021

best accuracy so far: 0.006863
Sun Nov 14 15:13:53 2021

 train accuracy so far: 0.006641
Sun Nov 14 15:15:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:17:02 2021


Validation Results
Global Steps: 4800
Valid Loss: 0.83847
Valid Accuracy: 0.78993
Sun Nov 14 15:17:03 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 15:17:03 2021

best accuracy so far: 0.789926
Sun Nov 14 15:17:03 2021

 train accuracy so far: 0.965430
Sun Nov 14 15:19:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:20:18 2021


Validation Results
Global Steps: 800
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 15:20:18 2021

best accuracy so far: 0.006863
Sun Nov 14 15:22:03 2021

 train accuracy so far: 0.005859
Sun Nov 14 15:22:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:23:41 2021


Validation Results
Global Steps: 5000
Valid Loss: 0.83453
Valid Accuracy: 0.79672
Sun Nov 14 15:23:42 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 15:23:42 2021

best accuracy so far: 0.796722
Sun Nov 14 15:24:59 2021

 train accuracy so far: 0.972070
Sun Nov 14 15:25:50 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:27:09 2021


Validation Results
Global Steps: 1000
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 15:27:09 2021

best accuracy so far: 0.006863
Sun Nov 14 15:29:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:31:22 2021


Validation Results
Global Steps: 5200
Valid Loss: 0.83974
Valid Accuracy: 0.79919
Sun Nov 14 15:31:22 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 15:31:22 2021

best accuracy so far: 0.799187
Sun Nov 14 15:33:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:34:43 2021


Validation Results
Global Steps: 1200
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 15:34:43 2021

best accuracy so far: 0.006863
Sun Nov 14 15:34:54 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 15:34:56 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 15:36:10 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 15:38:00 2021


Validation Results
Global Steps: 5400
Valid Loss: 0.85715
Valid Accuracy: 0.79599
Sun Nov 14 15:38:01 2021

best accuracy so far: 0.799187
Sun Nov 14 15:38:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:38:26 2021

 train accuracy so far: 0.979102
Sun Nov 14 15:40:09 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:43:06 2021


Validation Results
Global Steps: 200
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 15:43:07 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 15:43:07 2021

best accuracy so far: 0.006863
Sun Nov 14 15:44:26 2021

 train accuracy so far: 0.008008
Sun Nov 14 15:44:40 2021


Validation Results
Global Steps: 5600
Valid Loss: 0.84092
Valid Accuracy: 0.80072
Sun Nov 14 15:44:40 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 15:44:40 2021

best accuracy so far: 0.800720
Sun Nov 14 15:45:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:46:23 2021

 train accuracy so far: 0.985156
Sun Nov 14 15:46:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:49:59 2021


Validation Results
Global Steps: 400
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 15:49:59 2021

best accuracy so far: 0.006863
Sun Nov 14 15:51:18 2021


Validation Results
Global Steps: 5800
Valid Loss: 0.83808
Valid Accuracy: 0.80545
Sun Nov 14 15:51:19 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 15:51:19 2021

best accuracy so far: 0.805450
Sun Nov 14 15:52:09 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:53:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 15:57:03 2021


Validation Results
Global Steps: 600
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 15:57:04 2021

best accuracy so far: 0.006863
Sun Nov 14 15:57:31 2021

 train accuracy so far: 0.006641
Sun Nov 14 15:58:10 2021


Validation Results
Global Steps: 6000
Valid Loss: 0.84189
Valid Accuracy: 0.80991
Sun Nov 14 15:58:11 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 15:58:11 2021

best accuracy so far: 0.809914
Sun Nov 14 15:59:02 2021

 train accuracy so far: 0.989258
Sun Nov 14 15:59:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:00:19 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:04:01 2021


Validation Results
Global Steps: 800
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 16:04:01 2021

best accuracy so far: 0.006863
Sun Nov 14 16:04:53 2021


Validation Results
Global Steps: 6200
Valid Loss: 0.83704
Valid Accuracy: 0.80991
Sun Nov 14 16:04:53 2021

best accuracy so far: 0.809914
Sun Nov 14 16:05:47 2021

 train accuracy so far: 0.005859
Sun Nov 14 16:06:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:07:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:10:54 2021


Validation Results
Global Steps: 1000
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 16:10:55 2021

best accuracy so far: 0.006863
Sun Nov 14 16:11:31 2021


Validation Results
Global Steps: 6400
Valid Loss: 0.85130
Valid Accuracy: 0.81251
Sun Nov 14 16:11:32 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:11:32 2021

best accuracy so far: 0.812512
Sun Nov 14 16:11:32 2021

 train accuracy so far: 0.994336
Sun Nov 14 16:13:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:13:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:17:46 2021


Validation Results
Global Steps: 1200
Valid Loss: nan
Valid Accuracy: 0.00686
Sun Nov 14 16:17:47 2021

best accuracy so far: 0.006863
Sun Nov 14 16:17:59 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 16:18:02 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 16:18:11 2021


Validation Results
Global Steps: 6600
Valid Loss: 0.84826
Valid Accuracy: 0.81231
Sun Nov 14 16:18:11 2021

best accuracy so far: 0.812512
Sun Nov 14 16:19:13 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 16:19:28 2021

 train accuracy so far: 0.993555
Sun Nov 14 16:20:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:21:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:24:48 2021


Validation Results
Global Steps: 6800
Valid Loss: 0.85655
Valid Accuracy: 0.81131
Sun Nov 14 16:24:48 2021

best accuracy so far: 0.812512
Sun Nov 14 16:26:08 2021


Validation Results
Global Steps: 200
Valid Loss: 5.21724
Valid Accuracy: 0.02732
Sun Nov 14 16:26:08 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:26:08 2021

best accuracy so far: 0.027317
Sun Nov 14 16:26:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:27:31 2021

 train accuracy so far: 0.019531
Sun Nov 14 16:28:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:31:25 2021


Validation Results
Global Steps: 7000
Valid Loss: 0.83854
Valid Accuracy: 0.81551
Sun Nov 14 16:31:26 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:31:26 2021

best accuracy so far: 0.815511
Sun Nov 14 16:31:52 2021

 train accuracy so far: 0.995703
Sun Nov 14 16:33:06 2021


Validation Results
Global Steps: 400
Valid Loss: 4.84196
Valid Accuracy: 0.08128
Sun Nov 14 16:33:06 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:33:06 2021

best accuracy so far: 0.081285
Sun Nov 14 16:33:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:35:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:38:02 2021


Validation Results
Global Steps: 7200
Valid Loss: 0.83793
Valid Accuracy: 0.81884
Sun Nov 14 16:38:03 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:38:03 2021

best accuracy so far: 0.818842
Sun Nov 14 16:39:45 2021

 train accuracy so far: 0.997070
Sun Nov 14 16:40:04 2021


Validation Results
Global Steps: 600
Valid Loss: 3.90668
Valid Accuracy: 0.21480
Sun Nov 14 16:40:05 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:40:05 2021

best accuracy so far: 0.214804
Sun Nov 14 16:40:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:40:32 2021

 train accuracy so far: 0.110937
Sun Nov 14 16:42:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:44:39 2021


Validation Results
Global Steps: 7400
Valid Loss: 0.84172
Valid Accuracy: 0.81898
Sun Nov 14 16:44:40 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:44:40 2021

best accuracy so far: 0.818975
Sun Nov 14 16:46:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:47:01 2021


Validation Results
Global Steps: 800
Valid Loss: 3.10651
Valid Accuracy: 0.30775
Sun Nov 14 16:47:01 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:47:01 2021

best accuracy so far: 0.307749
Sun Nov 14 16:48:50 2021

 train accuracy so far: 0.300586
Sun Nov 14 16:49:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:51:17 2021


Validation Results
Global Steps: 7600
Valid Loss: 0.83847
Valid Accuracy: 0.82151
Sun Nov 14 16:51:18 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:51:18 2021

best accuracy so far: 0.821507
Sun Nov 14 16:52:09 2021

 train accuracy so far: 0.997461
Sun Nov 14 16:53:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:53:58 2021


Validation Results
Global Steps: 1000
Valid Loss: 2.50245
Valid Accuracy: 0.40969
Sun Nov 14 16:53:58 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:53:58 2021

best accuracy so far: 0.409688
Sun Nov 14 16:56:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 16:57:53 2021


Validation Results
Global Steps: 7800
Valid Loss: 0.84486
Valid Accuracy: 0.82177
Sun Nov 14 16:57:54 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 16:57:54 2021

best accuracy so far: 0.821774
Sun Nov 14 17:00:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:00:54 2021


Validation Results
Global Steps: 1200
Valid Loss: 2.01504
Valid Accuracy: 0.50410
Sun Nov 14 17:00:54 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 17:00:54 2021

best accuracy so far: 0.504098
Sun Nov 14 17:01:49 2021

 train accuracy so far: 0.463086
Sun Nov 14 17:03:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:04:32 2021


Validation Results
Global Steps: 8000
Valid Loss: 0.84634
Valid Accuracy: 0.82137
Sun Nov 14 17:04:32 2021

best accuracy so far: 0.821774
Sun Nov 14 17:04:32 2021

 train accuracy so far: 0.997266
Sun Nov 14 17:06:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:07:55 2021


Validation Results
Global Steps: 1400
Valid Loss: 1.73623
Valid Accuracy: 0.56380
Sun Nov 14 17:07:56 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 17:07:56 2021

best accuracy so far: 0.563795
Sun Nov 14 17:10:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:11:10 2021


Validation Results
Global Steps: 8200
Valid Loss: 0.84124
Valid Accuracy: 0.82344
Sun Nov 14 17:11:10 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 17:11:10 2021

best accuracy so far: 0.823439
Sun Nov 14 17:12:27 2021

 train accuracy so far: 0.998242
Sun Nov 14 17:13:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:14:57 2021


Validation Results
Global Steps: 1600
Valid Loss: 1.49698
Valid Accuracy: 0.61203
Sun Nov 14 17:14:58 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 17:14:58 2021

best accuracy so far: 0.612033
Sun Nov 14 17:14:58 2021

 train accuracy so far: 0.577539
Sun Nov 14 17:17:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:17:49 2021


Validation Results
Global Steps: 8400
Valid Loss: 0.83871
Valid Accuracy: 0.82337
Sun Nov 14 17:17:49 2021

best accuracy so far: 0.823439
Sun Nov 14 17:19:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:22:03 2021


Validation Results
Global Steps: 1800
Valid Loss: 1.34585
Valid Accuracy: 0.64595
Sun Nov 14 17:22:04 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 17:22:04 2021

best accuracy so far: 0.645946
Sun Nov 14 17:23:27 2021

 train accuracy so far: 0.668750
Sun Nov 14 17:24:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:24:28 2021


Validation Results
Global Steps: 8600
Valid Loss: 0.84528
Valid Accuracy: 0.81984
Sun Nov 14 17:24:28 2021

best accuracy so far: 0.823439
Sun Nov 14 17:24:54 2021

 train accuracy so far: 0.998242
Sun Nov 14 17:26:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:29:08 2021


Validation Results
Global Steps: 2000
Valid Loss: 1.20915
Valid Accuracy: 0.66973
Sun Nov 14 17:29:08 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 17:29:08 2021

best accuracy so far: 0.669731
Sun Nov 14 17:31:07 2021


Validation Results
Global Steps: 8800
Valid Loss: 0.84391
Valid Accuracy: 0.82251
Sun Nov 14 17:31:07 2021

best accuracy so far: 0.823439
Sun Nov 14 17:31:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:32:50 2021

 train accuracy so far: 0.998242
Sun Nov 14 17:33:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:36:02 2021


Validation Results
Global Steps: 2200
Valid Loss: 1.15109
Valid Accuracy: 0.67819
Sun Nov 14 17:36:02 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 17:36:02 2021

best accuracy so far: 0.678193
Sun Nov 14 17:36:29 2021

 train accuracy so far: 0.728516
Sun Nov 14 17:37:41 2021


Validation Results
Global Steps: 9000
Valid Loss: 0.84266
Valid Accuracy: 0.82291
Sun Nov 14 17:37:42 2021

best accuracy so far: 0.823439
Sun Nov 14 17:38:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:39:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:42:55 2021


Validation Results
Global Steps: 2400
Valid Loss: 1.05494
Valid Accuracy: 0.70078
Sun Nov 14 17:42:56 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 17:42:56 2021

best accuracy so far: 0.700780
Sun Nov 14 17:44:16 2021


Validation Results
Global Steps: 9200
Valid Loss: 0.84260
Valid Accuracy: 0.82177
Sun Nov 14 17:44:16 2021

best accuracy so far: 0.823439
Sun Nov 14 17:44:44 2021

 train accuracy so far: 0.771094
Sun Nov 14 17:45:07 2021

 train accuracy so far: 0.998828
Sun Nov 14 17:45:11 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:46:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:49:48 2021


Validation Results
Global Steps: 2600
Valid Loss: 0.97935
Valid Accuracy: 0.71437
Sun Nov 14 17:49:48 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 17:49:48 2021

best accuracy so far: 0.714371
Sun Nov 14 17:50:50 2021


Validation Results
Global Steps: 9400
Valid Loss: 0.84242
Valid Accuracy: 0.82184
Sun Nov 14 17:50:50 2021

best accuracy so far: 0.823439
Sun Nov 14 17:52:04 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:52:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:56:41 2021


Validation Results
Global Steps: 2800
Valid Loss: 0.90696
Valid Accuracy: 0.73403
Sun Nov 14 17:56:42 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 17:56:42 2021

best accuracy so far: 0.734026
Sun Nov 14 17:57:25 2021


Validation Results
Global Steps: 9600
Valid Loss: 0.84258
Valid Accuracy: 0.82224
Sun Nov 14 17:57:25 2021

best accuracy so far: 0.823439
Sun Nov 14 17:57:25 2021

 train accuracy so far: 0.998828
Sun Nov 14 17:57:36 2021

 train accuracy so far: 0.804883
Sun Nov 14 17:58:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 17:59:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:03:36 2021


Validation Results
Global Steps: 3000
Valid Loss: 0.84982
Valid Accuracy: 0.74915
Sun Nov 14 18:03:37 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:03:37 2021

best accuracy so far: 0.749151
Sun Nov 14 18:04:00 2021


Validation Results
Global Steps: 9800
Valid Loss: 0.84243
Valid Accuracy: 0.82237
Sun Nov 14 18:04:00 2021

best accuracy so far: 0.823439
Sun Nov 14 18:05:16 2021

 train accuracy so far: 0.999414
Sun Nov 14 18:05:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:06:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:10:29 2021


Validation Results
Global Steps: 3200
Valid Loss: 0.84070
Valid Accuracy: 0.75528
Sun Nov 14 18:10:30 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:10:30 2021

best accuracy so far: 0.755280
Sun Nov 14 18:10:30 2021

 train accuracy so far: 0.830469
Sun Nov 14 18:10:34 2021


Validation Results
Global Steps: 10000
Valid Loss: 0.84245
Valid Accuracy: 0.82231
Sun Nov 14 18:10:35 2021

best accuracy so far: 0.823439
Sun Nov 14 18:10:35 2021

 train accuracy so far: 0.999219
Sun Nov 14 18:10:35 2021

Best Accuracy: 	0.823439
End Training!
Total Training Time: 	5.527361


Sun Nov 14 18:10:50 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 18:10:52 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 18:12:02 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 18:12:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:14:08 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:17:21 2021


Validation Results
Global Steps: 3400
Valid Loss: 0.80595
Valid Accuracy: 0.75874
Sun Nov 14 18:17:21 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:17:21 2021

best accuracy so far: 0.758745
Sun Nov 14 18:18:34 2021


Validation Results
Global Steps: 200
Valid Loss: 4.95523
Valid Accuracy: 0.05363
Sun Nov 14 18:18:35 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:18:35 2021

best accuracy so far: 0.053634
Sun Nov 14 18:18:43 2021

 train accuracy so far: 0.856641
Sun Nov 14 18:19:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:19:51 2021

 train accuracy so far: 0.049219
Sun Nov 14 18:20:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:24:21 2021


Validation Results
Global Steps: 3600
Valid Loss: 0.79032
Valid Accuracy: 0.76567
Sun Nov 14 18:24:21 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:24:21 2021

best accuracy so far: 0.765674
Sun Nov 14 18:25:15 2021


Validation Results
Global Steps: 400
Valid Loss: 3.85593
Valid Accuracy: 0.14358
Sun Nov 14 18:25:15 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:25:15 2021

best accuracy so far: 0.143581
Sun Nov 14 18:26:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:27:23 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:31:17 2021


Validation Results
Global Steps: 3800
Valid Loss: 0.75692
Valid Accuracy: 0.77360
Sun Nov 14 18:31:18 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:31:18 2021

best accuracy so far: 0.773603
Sun Nov 14 18:31:45 2021

 train accuracy so far: 0.881250
Sun Nov 14 18:31:51 2021


Validation Results
Global Steps: 600
Valid Loss: 3.22417
Valid Accuracy: 0.22866
Sun Nov 14 18:31:52 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:31:52 2021

best accuracy so far: 0.228663
Sun Nov 14 18:32:17 2021

 train accuracy so far: 0.169141
Sun Nov 14 18:33:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:33:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:38:11 2021


Validation Results
Global Steps: 4000
Valid Loss: 0.76387
Valid Accuracy: 0.77354
Sun Nov 14 18:38:12 2021

best accuracy so far: 0.773603
Sun Nov 14 18:38:27 2021


Validation Results
Global Steps: 800
Valid Loss: 3.05363
Valid Accuracy: 0.27417
Sun Nov 14 18:38:28 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:38:28 2021

best accuracy so far: 0.274169
Sun Nov 14 18:40:00 2021

 train accuracy so far: 0.901367
Sun Nov 14 18:40:10 2021

 train accuracy so far: 0.298242
Sun Nov 14 18:40:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:40:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:45:04 2021


Validation Results
Global Steps: 1000
Valid Loss: 2.52606
Valid Accuracy: 0.36984
Sun Nov 14 18:45:04 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:45:04 2021

best accuracy so far: 0.369845
Sun Nov 14 18:45:05 2021


Validation Results
Global Steps: 4200
Valid Loss: 0.74934
Valid Accuracy: 0.77553
Sun Nov 14 18:45:06 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:45:06 2021

best accuracy so far: 0.775535
Sun Nov 14 18:47:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:47:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:51:40 2021


Validation Results
Global Steps: 1200
Valid Loss: 2.30949
Valid Accuracy: 0.40849
Sun Nov 14 18:51:40 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:51:40 2021

best accuracy so far: 0.408488
Sun Nov 14 18:51:59 2021


Validation Results
Global Steps: 4400
Valid Loss: 0.71611
Valid Accuracy: 0.78600
Sun Nov 14 18:51:59 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:51:59 2021

best accuracy so far: 0.785995
Sun Nov 14 18:52:32 2021

 train accuracy so far: 0.403320
Sun Nov 14 18:52:54 2021

 train accuracy so far: 0.911914
Sun Nov 14 18:53:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:54:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 18:58:16 2021


Validation Results
Global Steps: 1400
Valid Loss: 2.19180
Valid Accuracy: 0.43581
Sun Nov 14 18:58:17 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:58:17 2021

best accuracy so far: 0.435805
Sun Nov 14 18:58:54 2021


Validation Results
Global Steps: 4600
Valid Loss: 0.71604
Valid Accuracy: 0.78759
Sun Nov 14 18:58:55 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 18:58:55 2021

best accuracy so far: 0.787594
Sun Nov 14 19:00:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:01:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:04:53 2021


Validation Results
Global Steps: 1600
Valid Loss: 2.00181
Valid Accuracy: 0.48404
Sun Nov 14 19:04:53 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:04:53 2021

best accuracy so far: 0.484043
Sun Nov 14 19:04:53 2021

 train accuracy so far: 0.453516
Sun Nov 14 19:05:48 2021


Validation Results
Global Steps: 4800
Valid Loss: 0.71410
Valid Accuracy: 0.78926
Sun Nov 14 19:05:49 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:05:49 2021

best accuracy so far: 0.789260
Sun Nov 14 19:05:49 2021

 train accuracy so far: 0.927930
Sun Nov 14 19:07:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:08:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:11:29 2021


Validation Results
Global Steps: 1800
Valid Loss: 2.02304
Valid Accuracy: 0.48717
Sun Nov 14 19:11:30 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:11:30 2021

best accuracy so far: 0.487174
Sun Nov 14 19:12:43 2021


Validation Results
Global Steps: 5000
Valid Loss: 0.71315
Valid Accuracy: 0.78646
Sun Nov 14 19:12:44 2021

best accuracy so far: 0.789260
Sun Nov 14 19:12:46 2021

 train accuracy so far: 0.524414
Sun Nov 14 19:13:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:14:05 2021

 train accuracy so far: 0.937695
Sun Nov 14 19:14:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:18:05 2021


Validation Results
Global Steps: 2000
Valid Loss: 1.89465
Valid Accuracy: 0.52389
Sun Nov 14 19:18:05 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:18:05 2021

best accuracy so far: 0.523886
Sun Nov 14 19:18:15 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 19:18:18 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 19:19:30 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 19:19:36 2021


Validation Results
Global Steps: 5200
Valid Loss: 0.70137
Valid Accuracy: 0.79392
Sun Nov 14 19:19:36 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:19:36 2021

best accuracy so far: 0.793924
Sun Nov 14 19:21:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:21:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:26:04 2021


Validation Results
Global Steps: 200
Valid Loss: 5.21724
Valid Accuracy: 0.02732
Sun Nov 14 19:26:05 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:26:05 2021

best accuracy so far: 0.027317
Sun Nov 14 19:26:29 2021


Validation Results
Global Steps: 5400
Valid Loss: 0.67201
Valid Accuracy: 0.79845
Sun Nov 14 19:26:30 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:26:30 2021

best accuracy so far: 0.798454
Sun Nov 14 19:26:57 2021

 train accuracy so far: 0.944727
Sun Nov 14 19:27:21 2021

 train accuracy so far: 0.019531
Sun Nov 14 19:28:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:28:46 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:32:40 2021


Validation Results
Global Steps: 400
Valid Loss: 4.84196
Valid Accuracy: 0.08128
Sun Nov 14 19:32:40 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:32:40 2021

best accuracy so far: 0.081285
Sun Nov 14 19:33:24 2021


Validation Results
Global Steps: 5600
Valid Loss: 0.65273
Valid Accuracy: 0.80638
Sun Nov 14 19:33:25 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:33:25 2021

best accuracy so far: 0.806383
Sun Nov 14 19:34:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:35:13 2021

 train accuracy so far: 0.956445
Sun Nov 14 19:35:40 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:39:15 2021


Validation Results
Global Steps: 600
Valid Loss: 3.90668
Valid Accuracy: 0.21480
Sun Nov 14 19:39:15 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:39:15 2021

best accuracy so far: 0.214804
Sun Nov 14 19:39:41 2021

 train accuracy so far: 0.110937
Sun Nov 14 19:40:18 2021


Validation Results
Global Steps: 5800
Valid Loss: 0.72038
Valid Accuracy: 0.79046
Sun Nov 14 19:40:19 2021

best accuracy so far: 0.806383
Sun Nov 14 19:41:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:42:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:45:50 2021


Validation Results
Global Steps: 800
Valid Loss: 3.10651
Valid Accuracy: 0.30775
Sun Nov 14 19:45:51 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:45:51 2021

best accuracy so far: 0.307749
Sun Nov 14 19:47:13 2021


Validation Results
Global Steps: 6000
Valid Loss: 0.65276
Valid Accuracy: 0.80925
Sun Nov 14 19:47:13 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:47:13 2021

best accuracy so far: 0.809248
Sun Nov 14 19:47:33 2021

 train accuracy so far: 0.300586
Sun Nov 14 19:47:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:48:08 2021

 train accuracy so far: 0.957812
Sun Nov 14 19:49:29 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:52:26 2021


Validation Results
Global Steps: 1000
Valid Loss: 2.50245
Valid Accuracy: 0.40969
Sun Nov 14 19:52:27 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:52:27 2021

best accuracy so far: 0.409688
Sun Nov 14 19:54:08 2021


Validation Results
Global Steps: 6200
Valid Loss: 0.66742
Valid Accuracy: 0.80425
Sun Nov 14 19:54:09 2021

best accuracy so far: 0.809248
Sun Nov 14 19:54:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:56:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 19:59:03 2021


Validation Results
Global Steps: 1200
Valid Loss: 2.01504
Valid Accuracy: 0.50410
Sun Nov 14 19:59:03 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 19:59:03 2021

best accuracy so far: 0.504098
Sun Nov 14 19:59:55 2021

 train accuracy so far: 0.463086
Sun Nov 14 20:01:04 2021


Validation Results
Global Steps: 6400
Valid Loss: 0.66534
Valid Accuracy: 0.80638
Sun Nov 14 20:01:05 2021

best accuracy so far: 0.809248
Sun Nov 14 20:01:05 2021

 train accuracy so far: 0.965234
Sun Nov 14 20:01:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:03:21 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:05:40 2021


Validation Results
Global Steps: 1400
Valid Loss: 1.73623
Valid Accuracy: 0.56380
Sun Nov 14 20:05:41 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:05:41 2021

best accuracy so far: 0.563795
Sun Nov 14 20:07:48 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:08:00 2021


Validation Results
Global Steps: 6600
Valid Loss: 0.67571
Valid Accuracy: 0.80765
Sun Nov 14 20:08:00 2021

best accuracy so far: 0.809248
Sun Nov 14 20:09:23 2021

 train accuracy so far: 0.967187
Sun Nov 14 20:10:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:12:18 2021


Validation Results
Global Steps: 1600
Valid Loss: 1.49698
Valid Accuracy: 0.61203
Sun Nov 14 20:12:19 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:12:19 2021

best accuracy so far: 0.612033
Sun Nov 14 20:12:19 2021

 train accuracy so far: 0.577539
Sun Nov 14 20:14:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:15:04 2021


Validation Results
Global Steps: 6800
Valid Loss: 0.67090
Valid Accuracy: 0.80598
Sun Nov 14 20:15:04 2021

best accuracy so far: 0.809248
Sun Nov 14 20:17:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:18:55 2021


Validation Results
Global Steps: 1800
Valid Loss: 1.34585
Valid Accuracy: 0.64595
Sun Nov 14 20:18:55 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:18:55 2021

best accuracy so far: 0.645946
Sun Nov 14 20:20:12 2021

 train accuracy so far: 0.668750
Sun Nov 14 20:21:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:21:57 2021


Validation Results
Global Steps: 7000
Valid Loss: 0.65620
Valid Accuracy: 0.81071
Sun Nov 14 20:21:58 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:21:58 2021

best accuracy so far: 0.810714
Sun Nov 14 20:22:25 2021

 train accuracy so far: 0.974219
Sun Nov 14 20:24:14 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:25:29 2021


Validation Results
Global Steps: 2000
Valid Loss: 1.20915
Valid Accuracy: 0.66973
Sun Nov 14 20:25:30 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:25:30 2021

best accuracy so far: 0.669731
Sun Nov 14 20:27:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:28:50 2021


Validation Results
Global Steps: 7200
Valid Loss: 0.65650
Valid Accuracy: 0.81464
Sun Nov 14 20:28:51 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:28:51 2021

best accuracy so far: 0.814645
Sun Nov 14 20:30:39 2021

 train accuracy so far: 0.978711
Sun Nov 14 20:31:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:32:04 2021


Validation Results
Global Steps: 2200
Valid Loss: 1.15109
Valid Accuracy: 0.67819
Sun Nov 14 20:32:05 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:32:05 2021

best accuracy so far: 0.678193
Sun Nov 14 20:32:30 2021

 train accuracy so far: 0.728516
Sun Nov 14 20:34:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:35:45 2021


Validation Results
Global Steps: 7400
Valid Loss: 0.66047
Valid Accuracy: 0.81178
Sun Nov 14 20:35:45 2021

best accuracy so far: 0.814645
Sun Nov 14 20:38:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:38:39 2021


Validation Results
Global Steps: 2400
Valid Loss: 1.05494
Valid Accuracy: 0.70078
Sun Nov 14 20:38:39 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:38:39 2021

best accuracy so far: 0.700780
Sun Nov 14 20:40:21 2021

 train accuracy so far: 0.771094
Sun Nov 14 20:40:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:42:40 2021


Validation Results
Global Steps: 7600
Valid Loss: 0.65640
Valid Accuracy: 0.81325
Sun Nov 14 20:42:40 2021

best accuracy so far: 0.814645
Sun Nov 14 20:43:34 2021

 train accuracy so far: 0.980078
Sun Nov 14 20:44:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:45:14 2021


Validation Results
Global Steps: 2600
Valid Loss: 0.97935
Valid Accuracy: 0.71437
Sun Nov 14 20:45:15 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:45:15 2021

best accuracy so far: 0.714371
Sun Nov 14 20:47:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:49:35 2021


Validation Results
Global Steps: 7800
Valid Loss: 0.66046
Valid Accuracy: 0.81305
Sun Nov 14 20:49:35 2021

best accuracy so far: 0.814645
Sun Nov 14 20:51:49 2021


Validation Results
Global Steps: 2800
Valid Loss: 0.90696
Valid Accuracy: 0.73403
Sun Nov 14 20:51:50 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:51:50 2021

best accuracy so far: 0.734026
Sun Nov 14 20:51:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:52:41 2021

 train accuracy so far: 0.804883
Sun Nov 14 20:53:57 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 20:56:30 2021


Validation Results
Global Steps: 8000
Valid Loss: 0.66333
Valid Accuracy: 0.81484
Sun Nov 14 20:56:31 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:56:31 2021

best accuracy so far: 0.814844
Sun Nov 14 20:56:31 2021

 train accuracy so far: 0.982031
Sun Nov 14 20:58:24 2021


Validation Results
Global Steps: 3000
Valid Loss: 0.84982
Valid Accuracy: 0.74915
Sun Nov 14 20:58:25 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 20:58:25 2021

best accuracy so far: 0.749151
Sun Nov 14 20:58:47 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:00:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:03:26 2021


Validation Results
Global Steps: 8200
Valid Loss: 0.65122
Valid Accuracy: 0.81744
Sun Nov 14 21:03:26 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 21:03:26 2021

best accuracy so far: 0.817443
Sun Nov 14 21:04:48 2021

 train accuracy so far: 0.983984
Sun Nov 14 21:05:00 2021


Validation Results
Global Steps: 3200
Valid Loss: 0.84070
Valid Accuracy: 0.75528
Sun Nov 14 21:05:00 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 21:05:00 2021

best accuracy so far: 0.755280
Sun Nov 14 21:05:00 2021

 train accuracy so far: 0.830469
Sun Nov 14 21:05:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:07:07 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:10:20 2021


Validation Results
Global Steps: 8400
Valid Loss: 0.65927
Valid Accuracy: 0.81444
Sun Nov 14 21:10:21 2021

best accuracy so far: 0.817443
Sun Nov 14 21:11:34 2021


Validation Results
Global Steps: 3400
Valid Loss: 0.80595
Valid Accuracy: 0.75874
Sun Nov 14 21:11:35 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 21:11:35 2021

best accuracy so far: 0.758745
Sun Nov 14 21:12:37 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:12:51 2021

 train accuracy so far: 0.856641
Sun Nov 14 21:13:42 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:17:16 2021


Validation Results
Global Steps: 8600
Valid Loss: 0.66278
Valid Accuracy: 0.81411
Sun Nov 14 21:17:16 2021

best accuracy so far: 0.817443
Sun Nov 14 21:17:44 2021

 train accuracy so far: 0.985742
Sun Nov 14 21:18:09 2021


Validation Results
Global Steps: 3600
Valid Loss: 0.79032
Valid Accuracy: 0.76567
Sun Nov 14 21:18:10 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 21:18:10 2021

best accuracy so far: 0.765674
Sun Nov 14 21:19:32 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:20:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:24:11 2021


Validation Results
Global Steps: 8800
Valid Loss: 0.65373
Valid Accuracy: 0.81718
Sun Nov 14 21:24:12 2021

best accuracy so far: 0.817443
Sun Nov 14 21:24:45 2021


Validation Results
Global Steps: 3800
Valid Loss: 0.75692
Valid Accuracy: 0.77360
Sun Nov 14 21:24:45 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 21:24:45 2021

best accuracy so far: 0.773603
Sun Nov 14 21:25:11 2021

 train accuracy so far: 0.881250
Sun Nov 14 21:26:00 2021

 train accuracy so far: 0.988086
Sun Nov 14 21:26:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:26:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:31:06 2021


Validation Results
Global Steps: 9000
Valid Loss: 0.65440
Valid Accuracy: 0.81651
Sun Nov 14 21:31:06 2021

best accuracy so far: 0.817443
Sun Nov 14 21:31:20 2021


Validation Results
Global Steps: 4000
Valid Loss: 0.76387
Valid Accuracy: 0.77354
Sun Nov 14 21:31:20 2021

best accuracy so far: 0.773603
Sun Nov 14 21:33:02 2021

 train accuracy so far: 0.901367
Sun Nov 14 21:33:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:33:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:37:55 2021


Validation Results
Global Steps: 4200
Valid Loss: 0.74934
Valid Accuracy: 0.77553
Sun Nov 14 21:37:55 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 21:37:55 2021

best accuracy so far: 0.775535
Sun Nov 14 21:38:01 2021


Validation Results
Global Steps: 9200
Valid Loss: 0.65551
Valid Accuracy: 0.81671
Sun Nov 14 21:38:01 2021

best accuracy so far: 0.817443
Sun Nov 14 21:38:55 2021

 train accuracy so far: 0.986719
Sun Nov 14 21:40:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:40:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:44:31 2021


Validation Results
Global Steps: 4400
Valid Loss: 0.71611
Valid Accuracy: 0.78600
Sun Nov 14 21:44:31 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 21:44:31 2021

best accuracy so far: 0.785995
Sun Nov 14 21:44:56 2021


Validation Results
Global Steps: 9400
Valid Loss: 0.65542
Valid Accuracy: 0.81684
Sun Nov 14 21:44:56 2021

best accuracy so far: 0.817443
Sun Nov 14 21:45:22 2021

 train accuracy so far: 0.911914
Sun Nov 14 21:46:38 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:47:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:51:07 2021


Validation Results
Global Steps: 4600
Valid Loss: 0.71604
Valid Accuracy: 0.78759
Sun Nov 14 21:51:07 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 21:51:07 2021

best accuracy so far: 0.787594
Sun Nov 14 21:51:50 2021


Validation Results
Global Steps: 9600
Valid Loss: 0.65546
Valid Accuracy: 0.81738
Sun Nov 14 21:51:51 2021

best accuracy so far: 0.817443
Sun Nov 14 21:51:51 2021

 train accuracy so far: 0.989062
Sun Nov 14 21:53:15 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:54:06 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 21:57:43 2021


Validation Results
Global Steps: 4800
Valid Loss: 0.71410
Valid Accuracy: 0.78926
Sun Nov 14 21:57:43 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 21:57:43 2021

best accuracy so far: 0.789260
Sun Nov 14 21:57:43 2021

 train accuracy so far: 0.927930
Sun Nov 14 21:58:45 2021


Validation Results
Global Steps: 9800
Valid Loss: 0.65522
Valid Accuracy: 0.81704
Sun Nov 14 21:58:45 2021

best accuracy so far: 0.817443
Sun Nov 14 21:59:51 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:00:07 2021

 train accuracy so far: 0.990039
Sun Nov 14 22:01:01 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:04:19 2021


Validation Results
Global Steps: 5000
Valid Loss: 0.71315
Valid Accuracy: 0.78646
Sun Nov 14 22:04:19 2021

best accuracy so far: 0.789260
Sun Nov 14 22:05:36 2021

 train accuracy so far: 0.937695
Sun Nov 14 22:05:40 2021


Validation Results
Global Steps: 10000
Valid Loss: 0.65519
Valid Accuracy: 0.81711
Sun Nov 14 22:05:40 2021

best accuracy so far: 0.817443
Sun Nov 14 22:05:40 2021

 train accuracy so far: 0.986719
Sun Nov 14 22:05:40 2021

Best Accuracy: 	0.817443
End Training!
Total Training Time: 	5.774355


Sun Nov 14 22:05:56 2021


Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: True
Sun Nov 14 22:05:59 2021

activation: !!python/name:torch.nn.modules.activation.ReLU ''
attention_dropout_rate: 0.1
classifier: token
conv_bias: false
dropout_rate: 0.1
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_dim: 1152
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stochastic_depth_rate: 0.1
stride: 2
transformer: {}

Training parameters Namespace(data_root='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/butterfly200', dataset='butterfly200', decay_type='cosine', device=device(type='cuda'), eval_batch_size=8, eval_every=200, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=-1, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14/7x2', momentum=0.5, n_gpu=1, name='sample_run', nprocs=1, num_steps=10000, optimizer='SGD', output_dir='./output', pretrain=True, pretrained_dir='/media/lirunze/6318bdfc-100a-4fef-9824-1d0f386abf3c/xh/datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_btf.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M
Sun Nov 14 22:06:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:07:10 2021



***** Running training *****
  Total optimization steps = 10000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
Sun Nov 14 22:09:27 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:10:54 2021


Validation Results
Global Steps: 5200
Valid Loss: 0.70137
Valid Accuracy: 0.79392
Sun Nov 14 22:10:55 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 22:10:55 2021

best accuracy so far: 0.793924
Sun Nov 14 22:13:03 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:14:05 2021


Validation Results
Global Steps: 200
Valid Loss: 5.42942
Valid Accuracy: 0.00533
Sun Nov 14 22:14:05 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 22:14:05 2021

best accuracy so far: 0.005330
Sun Nov 14 22:15:27 2021

 train accuracy so far: 0.013086
Sun Nov 14 22:16:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:17:30 2021


Validation Results
Global Steps: 5400
Valid Loss: 0.67201
Valid Accuracy: 0.79845
Sun Nov 14 22:17:31 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 22:17:31 2021

best accuracy so far: 0.798454
Sun Nov 14 22:17:56 2021

 train accuracy so far: 0.944727
Sun Nov 14 22:19:39 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:20:59 2021


Validation Results
Global Steps: 400
Valid Loss: 5.18036
Valid Accuracy: 0.01572
Sun Nov 14 22:21:00 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 22:21:00 2021

best accuracy so far: 0.015724
Sun Nov 14 22:23:16 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:24:05 2021


Validation Results
Global Steps: 5600
Valid Loss: 0.65273
Valid Accuracy: 0.80638
Sun Nov 14 22:24:06 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 22:24:06 2021

best accuracy so far: 0.806383
Sun Nov 14 22:25:48 2021

 train accuracy so far: 0.956445
Sun Nov 14 22:26:13 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:27:53 2021


Validation Results
Global Steps: 600
Valid Loss: 5.15222
Valid Accuracy: 0.03538
Sun Nov 14 22:27:53 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 22:27:53 2021

best accuracy so far: 0.035379
Sun Nov 14 22:28:21 2021

 train accuracy so far: 0.029102
Sun Nov 14 22:30:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:30:40 2021


Validation Results
Global Steps: 5800
Valid Loss: 0.72038
Valid Accuracy: 0.79046
Sun Nov 14 22:30:41 2021

best accuracy so far: 0.806383
Sun Nov 14 22:32:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:34:45 2021


Validation Results
Global Steps: 800
Valid Loss: 5.13331
Valid Accuracy: 0.03538
Sun Nov 14 22:34:46 2021

best accuracy so far: 0.035379
Sun Nov 14 22:36:35 2021

 train accuracy so far: 0.031445
Sun Nov 14 22:37:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:37:16 2021


Validation Results
Global Steps: 6000
Valid Loss: 0.65276
Valid Accuracy: 0.80925
Sun Nov 14 22:37:16 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 22:37:16 2021

best accuracy so far: 0.809248
Sun Nov 14 22:38:08 2021

 train accuracy so far: 0.957812
Sun Nov 14 22:39:24 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:41:39 2021


Validation Results
Global Steps: 1000
Valid Loss: 5.12729
Valid Accuracy: 0.03538
Sun Nov 14 22:41:39 2021

best accuracy so far: 0.035379
Sun Nov 14 22:43:51 2021


Validation Results
Global Steps: 6200
Valid Loss: 0.66742
Valid Accuracy: 0.80425
Sun Nov 14 22:43:51 2021

best accuracy so far: 0.809248
Sun Nov 14 22:43:56 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:45:59 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:48:32 2021


Validation Results
Global Steps: 1200
Valid Loss: 5.13367
Valid Accuracy: 0.03538
Sun Nov 14 22:48:32 2021

best accuracy so far: 0.035379
Sun Nov 14 22:49:27 2021

 train accuracy so far: 0.031836
Sun Nov 14 22:50:27 2021


Validation Results
Global Steps: 6400
Valid Loss: 0.66534
Valid Accuracy: 0.80638
Sun Nov 14 22:50:27 2021

best accuracy so far: 0.809248
Sun Nov 14 22:50:27 2021

 train accuracy so far: 0.965234
Sun Nov 14 22:50:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:52:35 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:55:25 2021


Validation Results
Global Steps: 1400
Valid Loss: 5.15254
Valid Accuracy: 0.03538
Sun Nov 14 22:55:26 2021

best accuracy so far: 0.035379
Sun Nov 14 22:57:02 2021


Validation Results
Global Steps: 6600
Valid Loss: 0.67571
Valid Accuracy: 0.80765
Sun Nov 14 22:57:03 2021

best accuracy so far: 0.809248
Sun Nov 14 22:57:43 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 22:58:19 2021

 train accuracy so far: 0.967187
Sun Nov 14 22:59:10 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:02:17 2021


Validation Results
Global Steps: 1600
Valid Loss: 5.12203
Valid Accuracy: 0.03538
Sun Nov 14 23:02:17 2021

best accuracy so far: 0.035379
Sun Nov 14 23:02:17 2021

 train accuracy so far: 0.031445
Sun Nov 14 23:03:36 2021


Validation Results
Global Steps: 6800
Valid Loss: 0.67090
Valid Accuracy: 0.80598
Sun Nov 14 23:03:36 2021

best accuracy so far: 0.809248
Sun Nov 14 23:04:33 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:05:44 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:09:06 2021


Validation Results
Global Steps: 1800
Valid Loss: 5.12486
Valid Accuracy: 0.03538
Sun Nov 14 23:09:06 2021

best accuracy so far: 0.035379
Sun Nov 14 23:10:10 2021


Validation Results
Global Steps: 7000
Valid Loss: 0.65620
Valid Accuracy: 0.81071
Sun Nov 14 23:10:10 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 23:10:10 2021

best accuracy so far: 0.810714
Sun Nov 14 23:10:28 2021

 train accuracy so far: 0.033398
Sun Nov 14 23:10:36 2021

 train accuracy so far: 0.974219
Sun Nov 14 23:11:22 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:12:18 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:15:57 2021


Validation Results
Global Steps: 2000
Valid Loss: 5.13522
Valid Accuracy: 0.03538
Sun Nov 14 23:15:57 2021

best accuracy so far: 0.035379
Sun Nov 14 23:16:44 2021


Validation Results
Global Steps: 7200
Valid Loss: 0.65650
Valid Accuracy: 0.81464
Sun Nov 14 23:16:45 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 23:16:45 2021

best accuracy so far: 0.814645
Sun Nov 14 23:18:12 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:18:26 2021

 train accuracy so far: 0.978711
Sun Nov 14 23:18:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:22:44 2021


Validation Results
Global Steps: 2200
Valid Loss: 5.12320
Valid Accuracy: 0.03538
Sun Nov 14 23:22:45 2021

best accuracy so far: 0.035379
Sun Nov 14 23:23:12 2021

 train accuracy so far: 0.031250
Sun Nov 14 23:23:18 2021


Validation Results
Global Steps: 7400
Valid Loss: 0.66047
Valid Accuracy: 0.81178
Sun Nov 14 23:23:18 2021

best accuracy so far: 0.814645
Sun Nov 14 23:25:00 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:25:25 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:29:33 2021


Validation Results
Global Steps: 2400
Valid Loss: 5.16796
Valid Accuracy: 0.03538
Sun Nov 14 23:29:34 2021

best accuracy so far: 0.035379
Sun Nov 14 23:29:51 2021


Validation Results
Global Steps: 7600
Valid Loss: 0.65640
Valid Accuracy: 0.81325
Sun Nov 14 23:29:51 2021

best accuracy so far: 0.814645
Sun Nov 14 23:30:42 2021

 train accuracy so far: 0.980078
Sun Nov 14 23:31:21 2021

 train accuracy so far: 0.033984
Sun Nov 14 23:31:49 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:31:58 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:36:19 2021


Validation Results
Global Steps: 2600
Valid Loss: 5.14738
Valid Accuracy: 0.03538
Sun Nov 14 23:36:20 2021

best accuracy so far: 0.035379
Sun Nov 14 23:36:23 2021


Validation Results
Global Steps: 7800
Valid Loss: 0.66046
Valid Accuracy: 0.81305
Sun Nov 14 23:36:24 2021

best accuracy so far: 0.814645
Sun Nov 14 23:38:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:38:34 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:42:56 2021


Validation Results
Global Steps: 8000
Valid Loss: 0.66333
Valid Accuracy: 0.81484
Sun Nov 14 23:42:57 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 23:42:57 2021

best accuracy so far: 0.814844
Sun Nov 14 23:42:57 2021

 train accuracy so far: 0.982031
Sun Nov 14 23:43:05 2021


Validation Results
Global Steps: 2800
Valid Loss: 5.15637
Valid Accuracy: 0.03538
Sun Nov 14 23:43:05 2021

best accuracy so far: 0.035379
Sun Nov 14 23:43:59 2021

 train accuracy so far: 0.030078
Sun Nov 14 23:45:04 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:45:20 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:49:30 2021


Validation Results
Global Steps: 8200
Valid Loss: 0.65122
Valid Accuracy: 0.81744
Sun Nov 14 23:49:31 2021
Saved model checkpoint to [DIR: %s]./output
Sun Nov 14 23:49:31 2021

best accuracy so far: 0.817443
Sun Nov 14 23:49:52 2021


Validation Results
Global Steps: 3000
Valid Loss: 5.14557
Valid Accuracy: 0.03538
Sun Nov 14 23:49:52 2021

best accuracy so far: 0.035379
Sun Nov 14 23:50:46 2021

 train accuracy so far: 0.983984
Sun Nov 14 23:51:36 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Sun Nov 14 23:55:56 2021


Validation Results
Global Steps: 8400
Valid Loss: 0.65927
Valid Accuracy: 0.81444
Sun Nov 14 23:55:56 2021

best accuracy so far: 0.817443
Sun Nov 14 23:58:02 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Mon Nov 15 00:02:21 2021


Validation Results
Global Steps: 8600
Valid Loss: 0.66278
Valid Accuracy: 0.81411
Mon Nov 15 00:02:21 2021

best accuracy so far: 0.817443
Mon Nov 15 00:02:46 2021

 train accuracy so far: 0.985742
Mon Nov 15 00:04:26 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Mon Nov 15 00:08:46 2021


Validation Results
Global Steps: 8800
Valid Loss: 0.65373
Valid Accuracy: 0.81718
Mon Nov 15 00:08:46 2021

best accuracy so far: 0.817443
Mon Nov 15 00:10:27 2021

 train accuracy so far: 0.988086
Mon Nov 15 00:10:52 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Mon Nov 15 00:15:11 2021


Validation Results
Global Steps: 9000
Valid Loss: 0.65440
Valid Accuracy: 0.81651
Mon Nov 15 00:15:12 2021

best accuracy so far: 0.817443
Mon Nov 15 00:17:17 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Mon Nov 15 00:21:35 2021


Validation Results
Global Steps: 9200
Valid Loss: 0.65551
Valid Accuracy: 0.81671
Mon Nov 15 00:21:36 2021

best accuracy so far: 0.817443
Mon Nov 15 00:22:26 2021

 train accuracy so far: 0.986719
Mon Nov 15 00:23:41 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Mon Nov 15 00:27:59 2021


Validation Results
Global Steps: 9400
Valid Loss: 0.65542
Valid Accuracy: 0.81684
Mon Nov 15 00:27:59 2021

best accuracy so far: 0.817443
Mon Nov 15 00:30:05 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Mon Nov 15 00:34:24 2021


Validation Results
Global Steps: 9600
Valid Loss: 0.65546
Valid Accuracy: 0.81738
Mon Nov 15 00:34:24 2021

best accuracy so far: 0.817443
Mon Nov 15 00:34:24 2021

 train accuracy so far: 0.989062
Mon Nov 15 00:36:30 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Mon Nov 15 00:40:49 2021


Validation Results
Global Steps: 9800
Valid Loss: 0.65522
Valid Accuracy: 0.81704
Mon Nov 15 00:40:49 2021

best accuracy so far: 0.817443
Mon Nov 15 00:42:05 2021

 train accuracy so far: 0.990039
Mon Nov 15 00:42:55 2021


***** Running Validation *****
  Num steps = 1877
  Batch size = 8
Mon Nov 15 00:47:13 2021


Validation Results
Global Steps: 10000
Valid Loss: 0.65519
Valid Accuracy: 0.81711
Mon Nov 15 00:47:13 2021

best accuracy so far: 0.817443
Mon Nov 15 00:47:13 2021

 train accuracy so far: 0.986719
Mon Nov 15 00:47:14 2021

Best Accuracy: 	0.817443
End Training!
Total Training Time: 	5.462088



{
    "optimizer": {
        "_name": "SGD",
        "learning_rate": 0.12,
        "weight_decay": 0,
        "momentum": 0.5
    }
}

Validation Results
Global Steps: 10000
Valid Loss: 0.83245
Valid Accuracy: 0.82510
Sun Nov 14 10:16:37 2021

best accuracy so far: 0.825438
Sun Nov 14 10:16:37 2021

 train accuracy so far: 0.999219
Sun Nov 14 10:16:37 2021

Best Accuracy: 	0.825438
End Training!
Total Training Time: 	5.475915

