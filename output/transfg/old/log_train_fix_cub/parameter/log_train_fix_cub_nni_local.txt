

Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M


***** Running training *****
  Total optimization steps = 15000
  Instantaneous batch size per GPU = 12
  Total train batch size (w. parallel, distributed & accumulation) = 12
  Total train batch size (w. parallel, distributed & accumulation) = 12
  Gradient Accumulation steps = 1

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 200
Valid Loss: 5.31639
Valid Accuracy: 0.00708Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.007076
 train accuracy so far: 0.006191

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 400
Valid Loss: 5.02165
Valid Accuracy: 0.02399Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.023990
 train accuracy so far: 0.018742

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 600
Valid Loss: 4.34055
Valid Accuracy: 0.07974Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.079738
 train accuracy so far: 0.080991

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 800
Valid Loss: 3.62471
Valid Accuracy: 0.15982Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.159821
 train accuracy so far: 0.214692

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1000
Valid Loss: 3.10852
Valid Accuracy: 0.27598Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.275975

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1200
Valid Loss: 2.71577
Valid Accuracy: 0.35554Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.355540
 train accuracy so far: 0.344210

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1400
Valid Loss: 2.33038
Valid Accuracy: 0.42389Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.423887
 train accuracy so far: 0.466031

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1600
Valid Loss: 2.13943
Valid Accuracy: 0.46617Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.466172
 train accuracy so far: 0.576640

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1800
Valid Loss: 1.89463
Valid Accuracy: 0.53383Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.533828
 train accuracy so far: 0.665830

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2000
Valid Loss: 1.61975
Valid Accuracy: 0.59631Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.596307

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2200
Valid Loss: 1.52798
Valid Accuracy: 0.61184Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.611840
 train accuracy so far: 0.729920

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2400
Valid Loss: 1.44507
Valid Accuracy: 0.62409Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.624094
 train accuracy so far: 0.778447

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2600
Valid Loss: 1.35929
Valid Accuracy: 0.64826Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.648257
 train accuracy so far: 0.817269

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2800
Valid Loss: 1.23314
Valid Accuracy: 0.67397Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.673973
 train accuracy so far: 0.855589

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3000
Valid Loss: 1.21083
Valid Accuracy: 0.68347Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.683466

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3200
Valid Loss: 1.29794
Valid Accuracy: 0.65740
best accuracy so far: 0.683466
 train accuracy so far: 0.885375

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3400
Valid Loss: 1.12443
Valid Accuracy: 0.69537Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.695375
 train accuracy so far: 0.899766

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3600
Valid Loss: 1.17480
Valid Accuracy: 0.69468
best accuracy so far: 0.695375
 train accuracy so far: 0.922189

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3800
Valid Loss: 1.10726
Valid Accuracy: 0.70763Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.707629
 train accuracy so far: 0.933735

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4000
Valid Loss: 1.12292
Valid Accuracy: 0.69917
best accuracy so far: 0.707629

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4200
Valid Loss: 1.06625
Valid Accuracy: 0.71729Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.717294
 train accuracy so far: 0.950134

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4400
Valid Loss: 1.04846
Valid Accuracy: 0.72748Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.727477
 train accuracy so far: 0.962349

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4600
Valid Loss: 1.06115
Valid Accuracy: 0.72316
best accuracy so far: 0.727477
 train accuracy so far: 0.971386

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4800
Valid Loss: 1.04402
Valid Accuracy: 0.72730
best accuracy so far: 0.727477
 train accuracy so far: 0.979752

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5000
Valid Loss: 1.12302
Valid Accuracy: 0.70901
best accuracy so far: 0.727477

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5200
Valid Loss: 1.09181
Valid Accuracy: 0.71971
best accuracy so far: 0.727477
 train accuracy so far: 0.982597

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5400
Valid Loss: 1.05767
Valid Accuracy: 0.73611Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.736106
 train accuracy so far: 0.983936

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5600
Valid Loss: 1.04980
Valid Accuracy: 0.73438
best accuracy so far: 0.736106
 train accuracy so far: 0.989793

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5800
Valid Loss: 1.10367
Valid Accuracy: 0.72713
best accuracy so far: 0.736106
 train accuracy so far: 0.991968

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6000
Valid Loss: 1.03391
Valid Accuracy: 0.74059Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.740594

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6200
Valid Loss: 1.07590
Valid Accuracy: 0.73593
best accuracy so far: 0.740594
 train accuracy so far: 0.994645

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6400
Valid Loss: 1.07622
Valid Accuracy: 0.74059
best accuracy so far: 0.740594
 train accuracy so far: 0.994645

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6600
Valid Loss: 1.03878
Valid Accuracy: 0.74663Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.746634
 train accuracy so far: 0.995984

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6800
Valid Loss: 1.09610
Valid Accuracy: 0.74163
best accuracy so far: 0.746634
 train accuracy so far: 0.996486

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7000
Valid Loss: 1.06724
Valid Accuracy: 0.74750Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.747497

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7200
Valid Loss: 1.05234
Valid Accuracy: 0.75198Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.751985
 train accuracy so far: 0.997490

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7400
Valid Loss: 1.06603
Valid Accuracy: 0.74698
best accuracy so far: 0.751985
 train accuracy so far: 0.998327

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7600
Valid Loss: 1.04754
Valid Accuracy: 0.75544Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.755437
 train accuracy so far: 0.998661

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7800
Valid Loss: 1.04260
Valid Accuracy: 0.75630Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.756300
 train accuracy so far: 0.998159

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8000
Valid Loss: 1.06374
Valid Accuracy: 0.75406
best accuracy so far: 0.756300

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8200
Valid Loss: 1.05569
Valid Accuracy: 0.75682Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.756817
 train accuracy so far: 0.999163

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8400
Valid Loss: 1.07144
Valid Accuracy: 0.75561
best accuracy so far: 0.756817
 train accuracy so far: 0.999498

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8600
Valid Loss: 1.03840
Valid Accuracy: 0.75803Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.758026
 train accuracy so far: 0.999665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8800
Valid Loss: 1.04934
Valid Accuracy: 0.76044Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.760442
 train accuracy so far: 0.999665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9000
Valid Loss: 1.03062
Valid Accuracy: 0.76389Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.763894

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9200
Valid Loss: 1.03872
Valid Accuracy: 0.76355
best accuracy so far: 0.763894
 train accuracy so far: 0.999665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9400
Valid Loss: 1.04750
Valid Accuracy: 0.76424Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.764239
 train accuracy so far: 0.999498

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9600
Valid Loss: 1.01673
Valid Accuracy: 0.77062Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.770625
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9800
Valid Loss: 1.01302
Valid Accuracy: 0.76890
best accuracy so far: 0.770625
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10000
Valid Loss: 1.03208
Valid Accuracy: 0.76821
best accuracy so far: 0.770625

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10200
Valid Loss: 1.01301
Valid Accuracy: 0.77062
best accuracy so far: 0.770625
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10400
Valid Loss: 1.02369
Valid Accuracy: 0.77132Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.771315
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10600
Valid Loss: 1.01956
Valid Accuracy: 0.76959
best accuracy so far: 0.771315
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10800
Valid Loss: 1.00540
Valid Accuracy: 0.77339Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.773386
 train accuracy so far: 0.999498

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11000
Valid Loss: 1.01768
Valid Accuracy: 0.77080
best accuracy so far: 0.773386

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11200
Valid Loss: 1.01201
Valid Accuracy: 0.77270
best accuracy so far: 0.773386
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11400
Valid Loss: 1.02176
Valid Accuracy: 0.77149
best accuracy so far: 0.773386
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11600
Valid Loss: 1.01229
Valid Accuracy: 0.77132
best accuracy so far: 0.773386
 train accuracy so far: 0.999665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11800
Valid Loss: 1.01037
Valid Accuracy: 0.77166
best accuracy so far: 0.773386
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12000
Valid Loss: 1.01065
Valid Accuracy: 0.77149
best accuracy so far: 0.773386

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12200
Valid Loss: 1.02733
Valid Accuracy: 0.77339
best accuracy so far: 0.773386
 train accuracy so far: 0.999665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12400
Valid Loss: 1.01482
Valid Accuracy: 0.77321
best accuracy so far: 0.773386
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12600
Valid Loss: 1.00782
Valid Accuracy: 0.77528Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.775285
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12800
Valid Loss: 1.01497
Valid Accuracy: 0.77563Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.775630
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13000
Valid Loss: 1.00743
Valid Accuracy: 0.77442
best accuracy so far: 0.775630
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13200
Valid Loss: 1.01066
Valid Accuracy: 0.77321
best accuracy so far: 0.775630

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13400
Valid Loss: 1.00941
Valid Accuracy: 0.77390
best accuracy so far: 0.775630
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13600
Valid Loss: 1.00926
Valid Accuracy: 0.77356
best accuracy so far: 0.775630
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13800
Valid Loss: 1.00772
Valid Accuracy: 0.77390
best accuracy so far: 0.775630
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14000
Valid Loss: 1.00742
Valid Accuracy: 0.77442
best accuracy so far: 0.775630
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14200
Valid Loss: 1.00781
Valid Accuracy: 0.77356
best accuracy so far: 0.775630

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14400
Valid Loss: 1.00759
Valid Accuracy: 0.77425
best accuracy so far: 0.775630
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14600
Valid Loss: 1.00785
Valid Accuracy: 0.77425
best accuracy so far: 0.775630
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14800
Valid Loss: 1.00783
Valid Accuracy: 0.77425
best accuracy so far: 0.775630
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 15000
Valid Loss: 1.00790
Valid Accuracy: 0.77425
best accuracy so far: 0.775630
 train accuracy so far: 1.000000
Best Accuracy: 	0.775630
End Training!
Total Training Time: 	0.772958



Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M


***** Running training *****
  Total optimization steps = 15000
  Instantaneous batch size per GPU = 12
  Total train batch size (w. parallel, distributed & accumulation) = 12
  Total train batch size (w. parallel, distributed & accumulation) = 12
  Gradient Accumulation steps = 1

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 100
Valid Loss: 5.36766
Valid Accuracy: 0.00846Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.008457

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 200
Valid Loss: 5.31410
Valid Accuracy: 0.00932Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.009320
 train accuracy so far: 0.005187

Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M


***** Running training *****
  Total optimization steps = 15000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 100
Valid Loss: 5.36503
Valid Accuracy: 0.00518Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.005178
 train accuracy so far: 0.006517

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 200
Valid Loss: 5.31391
Valid Accuracy: 0.00880Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.008802

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 300
Valid Loss: 5.18995
Valid Accuracy: 0.01571Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.015706
 train accuracy so far: 0.012366

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 400
Valid Loss: 4.90192
Valid Accuracy: 0.03245Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.032447

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 500
Valid Loss: 4.55890
Valid Accuracy: 0.05230Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.052295
 train accuracy so far: 0.046290

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 600
Valid Loss: 4.10564
Valid Accuracy: 0.08768Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.087677

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 700
Valid Loss: 3.73664
Valid Accuracy: 0.15878Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.158785
 train accuracy so far: 0.126671

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 800
Valid Loss: 3.51022
Valid Accuracy: 0.19054Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.190542

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 900
Valid Loss: 3.15780
Valid Accuracy: 0.26286Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.262858
 train accuracy so far: 0.249833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1000
Valid Loss: 2.88597
Valid Accuracy: 0.30756Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.307560

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1100
Valid Loss: 2.66339
Valid Accuracy: 0.35709Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.357094
 train accuracy so far: 0.357787

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1200
Valid Loss: 2.49098
Valid Accuracy: 0.39230Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.392302

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1300
Valid Loss: 2.34734
Valid Accuracy: 0.42561Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.425613
 train accuracy so far: 0.467747

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1400
Valid Loss: 2.14991
Valid Accuracy: 0.47204Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.472040
 train accuracy so far: 0.562166

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1500
Valid Loss: 1.99142
Valid Accuracy: 0.50466Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.504660

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1600
Valid Loss: 1.86755
Valid Accuracy: 0.53366Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.533656
 train accuracy so far: 0.640876

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1700
Valid Loss: 1.74804
Valid Accuracy: 0.56800Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.568001

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1800
Valid Loss: 1.63673
Valid Accuracy: 0.58923Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.589230
 train accuracy so far: 0.699198

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1900
Valid Loss: 1.61348
Valid Accuracy: 0.59234Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.592337

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2000
Valid Loss: 1.57317
Valid Accuracy: 0.60804Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.608043
 train accuracy so far: 0.757520

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2100
Valid Loss: 1.49341
Valid Accuracy: 0.62340Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.623404

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2200
Valid Loss: 1.47836
Valid Accuracy: 0.61546
best accuracy so far: 0.623404
 train accuracy so far: 0.783757

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2300
Valid Loss: 1.38700
Valid Accuracy: 0.64239Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.642389

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2400
Valid Loss: 1.30884
Valid Accuracy: 0.66414Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.664135
 train accuracy so far: 0.828209

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2500
Valid Loss: 1.24370
Valid Accuracy: 0.67777Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.677770

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2600
Valid Loss: 1.25843
Valid Accuracy: 0.68070Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.680704
 train accuracy so far: 0.854111

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2700
Valid Loss: 1.25999
Valid Accuracy: 0.66569
best accuracy so far: 0.680704

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2800
Valid Loss: 1.24548
Valid Accuracy: 0.67932
best accuracy so far: 0.680704
 train accuracy so far: 0.879178

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2900
Valid Loss: 1.16957
Valid Accuracy: 0.68588Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.685882
 train accuracy so far: 0.899900

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3000
Valid Loss: 1.19431
Valid Accuracy: 0.68554
best accuracy so far: 0.685882

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3100
Valid Loss: 1.11339
Valid Accuracy: 0.70832Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.708319
 train accuracy so far: 0.913269

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3200
Valid Loss: 1.12810
Valid Accuracy: 0.69883
best accuracy so far: 0.708319

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3300
Valid Loss: 1.20901
Valid Accuracy: 0.68070
best accuracy so far: 0.708319
 train accuracy so far: 0.932320

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3400
Valid Loss: 1.15654
Valid Accuracy: 0.69676
best accuracy so far: 0.708319

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3500
Valid Loss: 1.21462
Valid Accuracy: 0.68554
best accuracy so far: 0.708319
 train accuracy so far: 0.945020

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3600
Valid Loss: 1.07133
Valid Accuracy: 0.71695Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.716949

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3700
Valid Loss: 1.23775
Valid Accuracy: 0.67777
best accuracy so far: 0.716949
 train accuracy so far: 0.956049

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3800
Valid Loss: 1.09331
Valid Accuracy: 0.71574
best accuracy so far: 0.716949

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3900
Valid Loss: 1.07082
Valid Accuracy: 0.71177
best accuracy so far: 0.716949
 train accuracy so far: 0.966578

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4000
Valid Loss: 1.13789
Valid Accuracy: 0.70884
best accuracy so far: 0.716949

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4100
Valid Loss: 1.16598
Valid Accuracy: 0.70176
best accuracy so far: 0.716949
 train accuracy so far: 0.974766

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4200
Valid Loss: 1.10668
Valid Accuracy: 0.70866
best accuracy so far: 0.716949

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4300
Valid Loss: 1.13826
Valid Accuracy: 0.70935
best accuracy so far: 0.716949
 train accuracy so far: 0.977106

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4400
Valid Loss: 1.06763
Valid Accuracy: 0.72592Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.725923
 train accuracy so far: 0.984793

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4500
Valid Loss: 1.12070
Valid Accuracy: 0.71867
best accuracy so far: 0.725923

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4600
Valid Loss: 1.12130
Valid Accuracy: 0.71367
best accuracy so far: 0.725923
 train accuracy so far: 0.985127

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4700
Valid Loss: 1.14766
Valid Accuracy: 0.71919
best accuracy so far: 0.725923

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4800
Valid Loss: 1.11306
Valid Accuracy: 0.71609
best accuracy so far: 0.725923
 train accuracy so far: 0.988135

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4900
Valid Loss: 1.12256
Valid Accuracy: 0.71850
best accuracy so far: 0.725923

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5000
Valid Loss: 1.08382
Valid Accuracy: 0.72627Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.726269
 train accuracy so far: 0.989138

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5100
Valid Loss: 1.09272
Valid Accuracy: 0.72541
best accuracy so far: 0.726269

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5200
Valid Loss: 1.14902
Valid Accuracy: 0.72023
best accuracy so far: 0.726269
 train accuracy so far: 0.990809

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5300
Valid Loss: 1.11681
Valid Accuracy: 0.72834Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.728340

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5400
Valid Loss: 1.16218
Valid Accuracy: 0.72040
best accuracy so far: 0.728340
 train accuracy so far: 0.993483

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5500
Valid Loss: 1.12576
Valid Accuracy: 0.73041Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.730411

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5600
Valid Loss: 1.13579
Valid Accuracy: 0.72955
best accuracy so far: 0.730411
 train accuracy so far: 0.993316

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5700
Valid Loss: 1.15159
Valid Accuracy: 0.72472
best accuracy so far: 0.730411
 train accuracy so far: 0.996992

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5800
Valid Loss: 1.08443
Valid Accuracy: 0.74146Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.741457

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5900
Valid Loss: 1.11526
Valid Accuracy: 0.73300
best accuracy so far: 0.741457
 train accuracy so far: 0.996491

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6000
Valid Loss: 1.19711
Valid Accuracy: 0.71936
best accuracy so far: 0.741457

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6100
Valid Loss: 1.10852
Valid Accuracy: 0.73956
best accuracy so far: 0.741457
 train accuracy so far: 0.998329

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6200
Valid Loss: 1.15421
Valid Accuracy: 0.73421
best accuracy so far: 0.741457

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6300
Valid Loss: 1.11372
Valid Accuracy: 0.74059
best accuracy so far: 0.741457
 train accuracy so far: 0.998329

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6400
Valid Loss: 1.13954
Valid Accuracy: 0.73352
best accuracy so far: 0.741457

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6500
Valid Loss: 1.11416
Valid Accuracy: 0.74111
best accuracy so far: 0.741457
 train accuracy so far: 0.997326

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6600
Valid Loss: 1.09513
Valid Accuracy: 0.74629Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.746289

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6700
Valid Loss: 1.11046
Valid Accuracy: 0.74353
best accuracy so far: 0.746289
 train accuracy so far: 0.997493

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6800
Valid Loss: 1.10805
Valid Accuracy: 0.74974Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.749741

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6900
Valid Loss: 1.14631
Valid Accuracy: 0.73956
best accuracy so far: 0.749741
 train accuracy so far: 0.999164

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7000
Valid Loss: 1.12228
Valid Accuracy: 0.74025
best accuracy so far: 0.749741

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7100
Valid Loss: 1.10400
Valid Accuracy: 0.75181Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.751812
 train accuracy so far: 0.999332

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7200
Valid Loss: 1.08251
Valid Accuracy: 0.75647Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.756472
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7300
Valid Loss: 1.09545
Valid Accuracy: 0.74991
best accuracy so far: 0.756472

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7400
Valid Loss: 1.03623
Valid Accuracy: 0.75941Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.759406
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7500
Valid Loss: 1.08768
Valid Accuracy: 0.75388
best accuracy so far: 0.759406

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7600
Valid Loss: 1.09455
Valid Accuracy: 0.75337
best accuracy so far: 0.759406
 train accuracy so far: 0.999332

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7700
Valid Loss: 1.08415
Valid Accuracy: 0.75457
best accuracy so far: 0.759406

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7800
Valid Loss: 1.05487
Valid Accuracy: 0.76079Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.760787
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7900
Valid Loss: 1.09908
Valid Accuracy: 0.75544
best accuracy so far: 0.760787

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8000
Valid Loss: 1.08095
Valid Accuracy: 0.75354
best accuracy so far: 0.760787
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8100
Valid Loss: 1.08614
Valid Accuracy: 0.75854
best accuracy so far: 0.760787

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8200
Valid Loss: 1.04724
Valid Accuracy: 0.75941
best accuracy so far: 0.760787
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8300
Valid Loss: 1.09253
Valid Accuracy: 0.76027
best accuracy so far: 0.760787

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8400
Valid Loss: 1.05549
Valid Accuracy: 0.76596Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.765965
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8500
Valid Loss: 1.07614
Valid Accuracy: 0.75751
best accuracy so far: 0.765965

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8600
Valid Loss: 1.07345
Valid Accuracy: 0.75906
best accuracy so far: 0.765965
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8700
Valid Loss: 1.04317
Valid Accuracy: 0.76648Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.766483
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8800
Valid Loss: 1.09759
Valid Accuracy: 0.76010
best accuracy so far: 0.766483

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8900
Valid Loss: 1.05714
Valid Accuracy: 0.76372
best accuracy so far: 0.766483
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9000
Valid Loss: 1.06916
Valid Accuracy: 0.75975
best accuracy so far: 0.766483

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9100
Valid Loss: 1.06211
Valid Accuracy: 0.76407
best accuracy so far: 0.766483
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9200
Valid Loss: 1.06286
Valid Accuracy: 0.76752Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.767518

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9300
Valid Loss: 1.06000
Valid Accuracy: 0.76717
best accuracy so far: 0.767518
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9400
Valid Loss: 1.06827
Valid Accuracy: 0.76786Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.767863

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9500
Valid Loss: 1.06150
Valid Accuracy: 0.76562
best accuracy so far: 0.767863
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9600
Valid Loss: 1.07068
Valid Accuracy: 0.76545
best accuracy so far: 0.767863

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9700
Valid Loss: 1.05885
Valid Accuracy: 0.76562
best accuracy so far: 0.767863
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9800
Valid Loss: 1.07854
Valid Accuracy: 0.76217
best accuracy so far: 0.767863

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9900
Valid Loss: 1.07531
Valid Accuracy: 0.76303
best accuracy so far: 0.767863
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10000
Valid Loss: 1.07693
Valid Accuracy: 0.76096
best accuracy so far: 0.767863
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10100
Valid Loss: 1.08339
Valid Accuracy: 0.76044
best accuracy so far: 0.767863

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10200
Valid Loss: 1.06109
Valid Accuracy: 0.76924Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.769244
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10300
Valid Loss: 1.07900
Valid Accuracy: 0.76182
best accuracy so far: 0.769244

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10400
Valid Loss: 1.06066
Valid Accuracy: 0.76769
best accuracy so far: 0.769244
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10500
Valid Loss: 1.06796
Valid Accuracy: 0.76562
best accuracy so far: 0.769244

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10600
Valid Loss: 1.05680
Valid Accuracy: 0.76821
best accuracy so far: 0.769244
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10700
Valid Loss: 1.05637
Valid Accuracy: 0.77011Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.770107

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10800
Valid Loss: 1.05163
Valid Accuracy: 0.77028Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.770280
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10900
Valid Loss: 1.06338
Valid Accuracy: 0.76735
best accuracy so far: 0.770280

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11000
Valid Loss: 1.05841
Valid Accuracy: 0.76890
best accuracy so far: 0.770280
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11100
Valid Loss: 1.06551
Valid Accuracy: 0.76821
best accuracy so far: 0.770280

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11200
Valid Loss: 1.05509
Valid Accuracy: 0.76942
best accuracy so far: 0.770280
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11300
Valid Loss: 1.06628
Valid Accuracy: 0.76838
best accuracy so far: 0.770280

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11400
Valid Loss: 1.05412
Valid Accuracy: 0.76907
best accuracy so far: 0.770280
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11500
Valid Loss: 1.06424
Valid Accuracy: 0.76786
best accuracy so far: 0.770280
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11600
Valid Loss: 1.05158
Valid Accuracy: 0.77028
best accuracy so far: 0.770280

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11700
Valid Loss: 1.05810
Valid Accuracy: 0.76769
best accuracy so far: 0.770280
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11800
Valid Loss: 1.05606
Valid Accuracy: 0.76976
best accuracy so far: 0.770280

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11900
Valid Loss: 1.05426
Valid Accuracy: 0.77149Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.771488
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12000
Valid Loss: 1.06296
Valid Accuracy: 0.76579
best accuracy so far: 0.771488

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12100
Valid Loss: 1.05572
Valid Accuracy: 0.76873
best accuracy so far: 0.771488
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12200
Valid Loss: 1.05794
Valid Accuracy: 0.76959
best accuracy so far: 0.771488

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12300
Valid Loss: 1.05583
Valid Accuracy: 0.77080
best accuracy so far: 0.771488
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12400
Valid Loss: 1.05551
Valid Accuracy: 0.77080
best accuracy so far: 0.771488

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12500
Valid Loss: 1.05065
Valid Accuracy: 0.77201Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12600
Valid Loss: 1.05397
Valid Accuracy: 0.77097
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12700
Valid Loss: 1.05432
Valid Accuracy: 0.77028
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12800
Valid Loss: 1.05556
Valid Accuracy: 0.77028
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12900
Valid Loss: 1.05110
Valid Accuracy: 0.76976
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13000
Valid Loss: 1.05699
Valid Accuracy: 0.76924
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13100
Valid Loss: 1.05609
Valid Accuracy: 0.76959
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13200
Valid Loss: 1.05285
Valid Accuracy: 0.76959
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13300
Valid Loss: 1.05192
Valid Accuracy: 0.76959
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13400
Valid Loss: 1.05123
Valid Accuracy: 0.76993
best accuracy so far: 0.772006
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13500
Valid Loss: 1.05321
Valid Accuracy: 0.76855
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13600
Valid Loss: 1.05300
Valid Accuracy: 0.76976
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13700
Valid Loss: 1.05436
Valid Accuracy: 0.76942
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13800
Valid Loss: 1.05468
Valid Accuracy: 0.76993
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13900
Valid Loss: 1.05479
Valid Accuracy: 0.76993
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14000
Valid Loss: 1.05621
Valid Accuracy: 0.76924
best accuracy so far: 0.772006
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14100
Valid Loss: 1.05684
Valid Accuracy: 0.76907
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14200
Valid Loss: 1.05660
Valid Accuracy: 0.76873
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14300
Valid Loss: 1.05696
Valid Accuracy: 0.76890
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14400
Valid Loss: 1.05625
Valid Accuracy: 0.76890
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14500
Valid Loss: 1.05622
Valid Accuracy: 0.76838
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14600
Valid Loss: 1.05584
Valid Accuracy: 0.76855
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14700
Valid Loss: 1.05590
Valid Accuracy: 0.76873
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14800
Valid Loss: 1.05588
Valid Accuracy: 0.76924
best accuracy so far: 0.772006

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14900
Valid Loss: 1.05574
Valid Accuracy: 0.76890
best accuracy so far: 0.772006
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 15000
Valid Loss: 1.05578
Valid Accuracy: 0.76907
best accuracy so far: 0.772006
 train accuracy so far: 1.000000
Best Accuracy: 	0.772006
End Training!
Total Training Time: 	1.089462



Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M


***** Running training *****
  Total optimization steps = 15000
  Instantaneous batch size per GPU = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 100
Valid Loss: 5.37247
Valid Accuracy: 0.00518Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.005178

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 200
Valid Loss: 5.33497
Valid Accuracy: 0.00777Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.007767

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 300
Valid Loss: 5.29903
Valid Accuracy: 0.00915Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.009147
 train accuracy so far: 0.005849

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 400
Valid Loss: 5.20799
Valid Accuracy: 0.01225Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.012254

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 500
Valid Loss: 5.05567
Valid Accuracy: 0.02209Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.022092

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 600
Valid Loss: 4.84344
Valid Accuracy: 0.03590Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.035899

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 700
Valid Loss: 4.50077
Valid Accuracy: 0.05022Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.050224
 train accuracy so far: 0.024900

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 800
Valid Loss: 4.35053
Valid Accuracy: 0.06489Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.064895

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 900
Valid Loss: 4.02949
Valid Accuracy: 0.10097Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.100967

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1000
Valid Loss: 3.72205
Valid Accuracy: 0.13618Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.136175

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1100
Valid Loss: 3.55773
Valid Accuracy: 0.15827Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.158267
 train accuracy so far: 0.103777

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1200
Valid Loss: 3.39213
Valid Accuracy: 0.18433Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.184329

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1300
Valid Loss: 3.22273
Valid Accuracy: 0.21401Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.214014

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1400
Valid Loss: 3.06953
Valid Accuracy: 0.25457Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.254574
 train accuracy so far: 0.241979

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1500
Valid Loss: 2.86575
Valid Accuracy: 0.29030Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.290300

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1600
Valid Loss: 2.76476
Valid Accuracy: 0.30980Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.309803

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1700
Valid Loss: 2.66118
Valid Accuracy: 0.32154Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.321540

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1800
Valid Loss: 2.52901
Valid Accuracy: 0.36831Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.368312
 train accuracy so far: 0.383356

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1900
Valid Loss: 2.29920
Valid Accuracy: 0.41353Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.413531

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2000
Valid Loss: 2.22220
Valid Accuracy: 0.42717Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.427166

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2100
Valid Loss: 2.12953
Valid Accuracy: 0.45426Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.454263

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2200
Valid Loss: 2.00382
Valid Accuracy: 0.48844Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.488436
 train accuracy so far: 0.522894

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2300
Valid Loss: 1.90353
Valid Accuracy: 0.50380Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.503797

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2400
Valid Loss: 1.86875
Valid Accuracy: 0.51346Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.513462

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2500
Valid Loss: 1.78671
Valid Accuracy: 0.53935Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.539351

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2600
Valid Loss: 1.74720
Valid Accuracy: 0.54867Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.548671
 train accuracy so far: 0.630348

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2700
Valid Loss: 1.72171
Valid Accuracy: 0.54194
best accuracy so far: 0.548671

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2800
Valid Loss: 1.59129
Valid Accuracy: 0.58750Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.587504

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2900
Valid Loss: 1.54052
Valid Accuracy: 0.59907Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.599068
 train accuracy so far: 0.717747

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3000
Valid Loss: 1.51305
Valid Accuracy: 0.60614Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.606144

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3100
Valid Loss: 1.68461
Valid Accuracy: 0.57111
best accuracy so far: 0.606144

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3200
Valid Loss: 1.46098
Valid Accuracy: 0.62237Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.622368

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3300
Valid Loss: 1.41929
Valid Accuracy: 0.62375Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.623749
 train accuracy so far: 0.775735

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3400
Valid Loss: 1.38037
Valid Accuracy: 0.62858Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.628581

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3500
Valid Loss: 1.39442
Valid Accuracy: 0.63169Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.631688

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3600
Valid Loss: 1.45779
Valid Accuracy: 0.60770
best accuracy so far: 0.631688

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3700
Valid Loss: 1.34396
Valid Accuracy: 0.63669Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.636693
 train accuracy so far: 0.824365

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3800
Valid Loss: 1.34837
Valid Accuracy: 0.64066Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.640663

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3900
Valid Loss: 1.29279
Valid Accuracy: 0.65689Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.656886

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4000
Valid Loss: 1.34371
Valid Accuracy: 0.64981
best accuracy so far: 0.656886

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4100
Valid Loss: 1.29017
Valid Accuracy: 0.65430
best accuracy so far: 0.656886
 train accuracy so far: 0.861965

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4200
Valid Loss: 1.34574
Valid Accuracy: 0.64153
best accuracy so far: 0.656886

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4300
Valid Loss: 1.28863
Valid Accuracy: 0.65154
best accuracy so far: 0.656886

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4400
Valid Loss: 1.33427
Valid Accuracy: 0.64791
best accuracy so far: 0.656886
 train accuracy so far: 0.893382

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4500
Valid Loss: 1.23978
Valid Accuracy: 0.67604Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.676044

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4600
Valid Loss: 1.27327
Valid Accuracy: 0.66500
best accuracy so far: 0.676044

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4700
Valid Loss: 1.18554
Valid Accuracy: 0.68778Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.687780

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4800
Valid Loss: 1.27756
Valid Accuracy: 0.66845
best accuracy so far: 0.687780
 train accuracy so far: 0.920956

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4900
Valid Loss: 1.23905
Valid Accuracy: 0.67898
best accuracy so far: 0.687780

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5000
Valid Loss: 1.28600
Valid Accuracy: 0.67138
best accuracy so far: 0.687780

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5100
Valid Loss: 1.30584
Valid Accuracy: 0.65551
best accuracy so far: 0.687780

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5200
Valid Loss: 1.28015
Valid Accuracy: 0.67466
best accuracy so far: 0.687780
 train accuracy so far: 0.939505

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5300
Valid Loss: 1.22335
Valid Accuracy: 0.68519
best accuracy so far: 0.687780

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5400
Valid Loss: 1.23466
Valid Accuracy: 0.68312
best accuracy so far: 0.687780

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5500
Valid Loss: 1.27434
Valid Accuracy: 0.67121
best accuracy so far: 0.687780

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5600
Valid Loss: 1.24500
Valid Accuracy: 0.68571
best accuracy so far: 0.687780
 train accuracy so far: 0.954378

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5700
Valid Loss: 1.23999
Valid Accuracy: 0.68433
best accuracy so far: 0.687780

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5800
Valid Loss: 1.18378
Valid Accuracy: 0.69123Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.691232

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5900
Valid Loss: 1.34437
Valid Accuracy: 0.67138
best accuracy so far: 0.691232
 train accuracy so far: 0.967079

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6000
Valid Loss: 1.28297
Valid Accuracy: 0.67225
best accuracy so far: 0.691232

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6100
Valid Loss: 1.25703
Valid Accuracy: 0.68260
best accuracy so far: 0.691232

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6200
Valid Loss: 1.20900
Valid Accuracy: 0.69934Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.699344

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6300
Valid Loss: 1.22158
Valid Accuracy: 0.69917
best accuracy so far: 0.699344
 train accuracy so far: 0.972259

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6400
Valid Loss: 1.19375
Valid Accuracy: 0.70608Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.706075

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6500
Valid Loss: 1.27726
Valid Accuracy: 0.68416
best accuracy so far: 0.706075

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6600
Valid Loss: 1.22697
Valid Accuracy: 0.69365
best accuracy so far: 0.706075

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6700
Valid Loss: 1.21011
Valid Accuracy: 0.70694Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.706938
 train accuracy so far: 0.981785

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6800
Valid Loss: 1.24414
Valid Accuracy: 0.69606
best accuracy so far: 0.706938

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6900
Valid Loss: 1.19547
Valid Accuracy: 0.70987Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.709872

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7000
Valid Loss: 1.20722
Valid Accuracy: 0.70228
best accuracy so far: 0.709872

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7100
Valid Loss: 1.23683
Valid Accuracy: 0.70383
best accuracy so far: 0.709872
 train accuracy so far: 0.985795

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7200
Valid Loss: 1.18197
Valid Accuracy: 0.70694
best accuracy so far: 0.709872

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7300
Valid Loss: 1.19763
Valid Accuracy: 0.70435
best accuracy so far: 0.709872

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7400
Valid Loss: 1.24398
Valid Accuracy: 0.70469
best accuracy so far: 0.709872
 train accuracy so far: 0.989472

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7500
Valid Loss: 1.25943
Valid Accuracy: 0.70728
best accuracy so far: 0.709872

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7600
Valid Loss: 1.17619
Valid Accuracy: 0.72178Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.721781

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7700
Valid Loss: 1.16155
Valid Accuracy: 0.72178
best accuracy so far: 0.721781

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7800
Valid Loss: 1.21490
Valid Accuracy: 0.71350
best accuracy so far: 0.721781
 train accuracy so far: 0.991310

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7900
Valid Loss: 1.15631
Valid Accuracy: 0.72644Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.726441

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8000
Valid Loss: 1.18234
Valid Accuracy: 0.72144
best accuracy so far: 0.726441

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8100
Valid Loss: 1.24663
Valid Accuracy: 0.71177
best accuracy so far: 0.726441

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8200
Valid Loss: 1.17259
Valid Accuracy: 0.73041Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.730411
 train accuracy so far: 0.996324

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8300
Valid Loss: 1.20006
Valid Accuracy: 0.72178
best accuracy so far: 0.730411

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8400
Valid Loss: 1.16871
Valid Accuracy: 0.72368
best accuracy so far: 0.730411

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8500
Valid Loss: 1.20021
Valid Accuracy: 0.72230
best accuracy so far: 0.730411

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8600
Valid Loss: 1.22501
Valid Accuracy: 0.72109
best accuracy so far: 0.730411
 train accuracy so far: 0.996992

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8700
Valid Loss: 1.15896
Valid Accuracy: 0.73024
best accuracy so far: 0.730411

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8800
Valid Loss: 1.15035
Valid Accuracy: 0.73300Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.733000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8900
Valid Loss: 1.19199
Valid Accuracy: 0.73265
best accuracy so far: 0.733000
 train accuracy so far: 0.996992

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9000
Valid Loss: 1.21630
Valid Accuracy: 0.73093
best accuracy so far: 0.733000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9100
Valid Loss: 1.16542
Valid Accuracy: 0.73835Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.738350

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9200
Valid Loss: 1.13423
Valid Accuracy: 0.74163Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.741629

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9300
Valid Loss: 1.17770
Valid Accuracy: 0.73473
best accuracy so far: 0.741629
 train accuracy so far: 0.998162

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9400
Valid Loss: 1.19267
Valid Accuracy: 0.73438
best accuracy so far: 0.741629

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9500
Valid Loss: 1.18703
Valid Accuracy: 0.73835
best accuracy so far: 0.741629

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9600
Valid Loss: 1.18340
Valid Accuracy: 0.73438
best accuracy so far: 0.741629

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9700
Valid Loss: 1.15521
Valid Accuracy: 0.74128
best accuracy so far: 0.741629
 train accuracy so far: 0.998663

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9800
Valid Loss: 1.16095
Valid Accuracy: 0.73835
best accuracy so far: 0.741629

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9900
Valid Loss: 1.14677
Valid Accuracy: 0.74146
best accuracy so far: 0.741629

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10000
Valid Loss: 1.17285
Valid Accuracy: 0.74008
best accuracy so far: 0.741629
 train accuracy so far: 0.999164

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10100
Valid Loss: 1.16430
Valid Accuracy: 0.74249Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.742492

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10200
Valid Loss: 1.20335
Valid Accuracy: 0.73334
best accuracy so far: 0.742492

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10300
Valid Loss: 1.10335
Valid Accuracy: 0.74715Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.747152

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10400
Valid Loss: 1.13600
Valid Accuracy: 0.74422
best accuracy so far: 0.747152
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10500
Valid Loss: 1.18794
Valid Accuracy: 0.73956
best accuracy so far: 0.747152

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10600
Valid Loss: 1.16002
Valid Accuracy: 0.74543
best accuracy so far: 0.747152

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10700
Valid Loss: 1.12543
Valid Accuracy: 0.74681
best accuracy so far: 0.747152

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10800
Valid Loss: 1.13761
Valid Accuracy: 0.74508
best accuracy so far: 0.747152
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10900
Valid Loss: 1.13679
Valid Accuracy: 0.74957Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.749569

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11000
Valid Loss: 1.12952
Valid Accuracy: 0.75112Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.751122

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11100
Valid Loss: 1.13976
Valid Accuracy: 0.74974
best accuracy so far: 0.751122

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11200
Valid Loss: 1.13919
Valid Accuracy: 0.75164Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.751640
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11300
Valid Loss: 1.13362
Valid Accuracy: 0.75112
best accuracy so far: 0.751640

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11400
Valid Loss: 1.11564
Valid Accuracy: 0.75319Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.753193

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11500
Valid Loss: 1.12750
Valid Accuracy: 0.75216
best accuracy so far: 0.753193
 train accuracy so far: 0.999164

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11600
Valid Loss: 1.13967
Valid Accuracy: 0.75216
best accuracy so far: 0.753193

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11700
Valid Loss: 1.14042
Valid Accuracy: 0.74888
best accuracy so far: 0.753193

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11800
Valid Loss: 1.10098
Valid Accuracy: 0.75526Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.755264

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11900
Valid Loss: 1.12139
Valid Accuracy: 0.75181
best accuracy so far: 0.755264
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12000
Valid Loss: 1.12935
Valid Accuracy: 0.75095
best accuracy so far: 0.755264

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12100
Valid Loss: 1.13217
Valid Accuracy: 0.75233
best accuracy so far: 0.755264

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12200
Valid Loss: 1.10592
Valid Accuracy: 0.75699Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.756990

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12300
Valid Loss: 1.10843
Valid Accuracy: 0.75457
best accuracy so far: 0.756990
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12400
Valid Loss: 1.13102
Valid Accuracy: 0.75475
best accuracy so far: 0.756990

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12500
Valid Loss: 1.12125
Valid Accuracy: 0.75354
best accuracy so far: 0.756990

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12600
Valid Loss: 1.11900
Valid Accuracy: 0.75544
best accuracy so far: 0.756990

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12700
Valid Loss: 1.11435
Valid Accuracy: 0.75440
best accuracy so far: 0.756990
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12800
Valid Loss: 1.12350
Valid Accuracy: 0.75406
best accuracy so far: 0.756990

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12900
Valid Loss: 1.12143
Valid Accuracy: 0.75440
best accuracy so far: 0.756990

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13000
Valid Loss: 1.11464
Valid Accuracy: 0.75734Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.757335
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13100
Valid Loss: 1.11701
Valid Accuracy: 0.75785Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.757853

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13200
Valid Loss: 1.12570
Valid Accuracy: 0.75285
best accuracy so far: 0.757853

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13300
Valid Loss: 1.10845
Valid Accuracy: 0.75682
best accuracy so far: 0.757853

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13400
Valid Loss: 1.10665
Valid Accuracy: 0.75854Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.758543
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13500
Valid Loss: 1.11018
Valid Accuracy: 0.75820
best accuracy so far: 0.758543

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13600
Valid Loss: 1.11200
Valid Accuracy: 0.75734
best accuracy so far: 0.758543

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13700
Valid Loss: 1.10666
Valid Accuracy: 0.75958Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.759579

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13800
Valid Loss: 1.10834
Valid Accuracy: 0.75734
best accuracy so far: 0.759579
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13900
Valid Loss: 1.11205
Valid Accuracy: 0.75682
best accuracy so far: 0.759579

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14000
Valid Loss: 1.11101
Valid Accuracy: 0.75837
best accuracy so far: 0.759579

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14100
Valid Loss: 1.11084
Valid Accuracy: 0.75734
best accuracy so far: 0.759579

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14200
Valid Loss: 1.11072
Valid Accuracy: 0.75768
best accuracy so far: 0.759579
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14300
Valid Loss: 1.11261
Valid Accuracy: 0.75716
best accuracy so far: 0.759579

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14400
Valid Loss: 1.11179
Valid Accuracy: 0.75699
best accuracy so far: 0.759579

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14500
Valid Loss: 1.11128
Valid Accuracy: 0.75751
best accuracy so far: 0.759579
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14600
Valid Loss: 1.11155
Valid Accuracy: 0.75751
best accuracy so far: 0.759579

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14700
Valid Loss: 1.11187
Valid Accuracy: 0.75734
best accuracy so far: 0.759579

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14800
Valid Loss: 1.11179
Valid Accuracy: 0.75734
best accuracy so far: 0.759579

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14900
Valid Loss: 1.11177
Valid Accuracy: 0.75751
best accuracy so far: 0.759579
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 15000
Valid Loss: 1.11170
Valid Accuracy: 0.75734
best accuracy so far: 0.759579
 train accuracy so far: 1.000000
Best Accuracy: 	0.759579
End Training!
Total Training Time: 	0.845971



Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M

Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M


***** Running training *****
  Total optimization steps = 15000
  Instantaneous batch size per GPU = 12
  Total train batch size (w. parallel, distributed & accumulation) = 12
  Total train batch size (w. parallel, distributed & accumulation) = 12
  Gradient Accumulation steps = 1

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 200
Valid Loss: 5.34309
Valid Accuracy: 0.00656Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.006559
 train accuracy so far: 0.004853

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 400
Valid Loss: 5.11308
Valid Accuracy: 0.02071Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.020711
 train accuracy so far: 0.014893

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 600
Valid Loss: 4.53536
Valid Accuracy: 0.05609Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.056093
 train accuracy so far: 0.058735

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 800
Valid Loss: 4.00261
Valid Accuracy: 0.10079Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.100794
 train accuracy so far: 0.155455

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1000
Valid Loss: 3.37820
Valid Accuracy: 0.21074Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.210735

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1200
Valid Loss: 2.89389
Valid Accuracy: 0.29997Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.299965
 train accuracy so far: 0.292336

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1400
Valid Loss: 2.56443
Valid Accuracy: 0.36693Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.366931
 train accuracy so far: 0.410141

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1600
Valid Loss: 2.24989
Valid Accuracy: 0.44563Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.445633
 train accuracy so far: 0.525602

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1800
Valid Loss: 2.02639
Valid Accuracy: 0.49499Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.494995
 train accuracy so far: 0.613788

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2000
Valid Loss: 1.78998
Valid Accuracy: 0.55057Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.550570

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2200
Valid Loss: 1.69092
Valid Accuracy: 0.57387Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.573870
 train accuracy so far: 0.694612

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2400
Valid Loss: 1.51242
Valid Accuracy: 0.60839Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.608388
 train accuracy so far: 0.751673

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2600
Valid Loss: 1.44860
Valid Accuracy: 0.62064Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.620642
 train accuracy so far: 0.799531

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2800
Valid Loss: 1.36529
Valid Accuracy: 0.63807Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.638074
 train accuracy so far: 0.824297

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3000
Valid Loss: 1.37264
Valid Accuracy: 0.64049Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.640490

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3200
Valid Loss: 1.50966
Valid Accuracy: 0.60442
best accuracy so far: 0.640490
 train accuracy so far: 0.865462

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3400
Valid Loss: 1.30112
Valid Accuracy: 0.65154Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.651536
 train accuracy so far: 0.892905

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3600
Valid Loss: 1.27928
Valid Accuracy: 0.66793Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.667932
 train accuracy so far: 0.912149

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3800
Valid Loss: 1.27919
Valid Accuracy: 0.66051
best accuracy so far: 0.667932
 train accuracy so far: 0.933568

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4000
Valid Loss: 1.22594
Valid Accuracy: 0.67484Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.674836

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4200
Valid Loss: 1.12857
Valid Accuracy: 0.70003Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.700035
 train accuracy so far: 0.947959

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4400
Valid Loss: 1.13857
Valid Accuracy: 0.69762
best accuracy so far: 0.700035
 train accuracy so far: 0.955489

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4600
Valid Loss: 1.17832
Valid Accuracy: 0.69762
best accuracy so far: 0.700035
 train accuracy so far: 0.964023

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4800
Valid Loss: 1.12592
Valid Accuracy: 0.70228Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.702278
 train accuracy so far: 0.971386

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5000
Valid Loss: 1.15550
Valid Accuracy: 0.70124
best accuracy so far: 0.702278

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5200
Valid Loss: 1.17364
Valid Accuracy: 0.69710
best accuracy so far: 0.702278
 train accuracy so far: 0.978079

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5400
Valid Loss: 1.17515
Valid Accuracy: 0.70469Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.704695
 train accuracy so far: 0.984940

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5600
Valid Loss: 1.15157
Valid Accuracy: 0.70849Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.708492
 train accuracy so far: 0.986780

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5800
Valid Loss: 1.23830
Valid Accuracy: 0.69727
best accuracy so far: 0.708492
 train accuracy so far: 0.989625

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6000
Valid Loss: 1.17308
Valid Accuracy: 0.71350Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.713497

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6200
Valid Loss: 1.17163
Valid Accuracy: 0.71988Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.719883
 train accuracy so far: 0.993641

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6400
Valid Loss: 1.15020
Valid Accuracy: 0.72730Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.727304
 train accuracy so far: 0.993307

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6600
Valid Loss: 1.15680
Valid Accuracy: 0.71609
best accuracy so far: 0.727304
 train accuracy so far: 0.995482

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6800
Valid Loss: 1.12134
Valid Accuracy: 0.73127Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.731274
 train accuracy so far: 0.995984

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7000
Valid Loss: 1.10690
Valid Accuracy: 0.73196Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.731964

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7200
Valid Loss: 1.18695
Valid Accuracy: 0.72437
best accuracy so far: 0.731964
 train accuracy so far: 0.997657

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7400
Valid Loss: 1.15133
Valid Accuracy: 0.72972
best accuracy so far: 0.731964
 train accuracy so far: 0.998159

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7600
Valid Loss: 1.11984
Valid Accuracy: 0.73386Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.733863
 train accuracy so far: 0.998327

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7800
Valid Loss: 1.11662
Valid Accuracy: 0.74059Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.740594
 train accuracy so far: 0.998494

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8000
Valid Loss: 1.11634
Valid Accuracy: 0.74439Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.744391

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8200
Valid Loss: 1.14814
Valid Accuracy: 0.74353
best accuracy so far: 0.744391
 train accuracy so far: 0.999331

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8400
Valid Loss: 1.09709
Valid Accuracy: 0.75129Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.751294
 train accuracy so far: 0.999665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8600
Valid Loss: 1.11169
Valid Accuracy: 0.74784
best accuracy so far: 0.751294
 train accuracy so far: 0.999163

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8800
Valid Loss: 1.12439
Valid Accuracy: 0.74784
best accuracy so far: 0.751294
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9000
Valid Loss: 1.12500
Valid Accuracy: 0.74646
best accuracy so far: 0.751294

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9200
Valid Loss: 1.11147
Valid Accuracy: 0.75095
best accuracy so far: 0.751294
 train accuracy so far: 0.999665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9400
Valid Loss: 1.08535
Valid Accuracy: 0.75578Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.755782
 train accuracy so far: 0.999665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9600
Valid Loss: 1.10270
Valid Accuracy: 0.75216
best accuracy so far: 0.755782
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9800
Valid Loss: 1.11429
Valid Accuracy: 0.75457
best accuracy so far: 0.755782
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10000
Valid Loss: 1.11345
Valid Accuracy: 0.75268
best accuracy so far: 0.755782

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10200
Valid Loss: 1.13919
Valid Accuracy: 0.74871
best accuracy so far: 0.755782
 train accuracy so far: 0.999498

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10400
Valid Loss: 1.13291
Valid Accuracy: 0.74871
best accuracy so far: 0.755782
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10600
Valid Loss: 1.11271
Valid Accuracy: 0.75268
best accuracy so far: 0.755782
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10800
Valid Loss: 1.11065
Valid Accuracy: 0.75906Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.759061
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11000
Valid Loss: 1.11067
Valid Accuracy: 0.75716
best accuracy so far: 0.759061

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11200
Valid Loss: 1.11325
Valid Accuracy: 0.75613
best accuracy so far: 0.759061
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11400
Valid Loss: 1.10808
Valid Accuracy: 0.75699
best accuracy so far: 0.759061
 train accuracy so far: 0.999665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11600
Valid Loss: 1.10521
Valid Accuracy: 0.75595
best accuracy so far: 0.759061
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11800
Valid Loss: 1.10097
Valid Accuracy: 0.75889
best accuracy so far: 0.759061
 train accuracy so far: 0.999665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12000
Valid Loss: 1.11150
Valid Accuracy: 0.75371
best accuracy so far: 0.759061

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12200
Valid Loss: 1.11033
Valid Accuracy: 0.75457
best accuracy so far: 0.759061
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12400
Valid Loss: 1.11021
Valid Accuracy: 0.75561
best accuracy so far: 0.759061
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12600
Valid Loss: 1.09348
Valid Accuracy: 0.76010Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.760097
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12800
Valid Loss: 1.10518
Valid Accuracy: 0.75854
best accuracy so far: 0.760097
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13000
Valid Loss: 1.10038
Valid Accuracy: 0.76044Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.760442
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13200
Valid Loss: 1.10403
Valid Accuracy: 0.75889
best accuracy so far: 0.760442

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13400
Valid Loss: 1.10268
Valid Accuracy: 0.75768
best accuracy so far: 0.760442
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13600
Valid Loss: 1.09895
Valid Accuracy: 0.75923
best accuracy so far: 0.760442
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13800
Valid Loss: 1.09870
Valid Accuracy: 0.75923
best accuracy so far: 0.760442
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14000
Valid Loss: 1.09902
Valid Accuracy: 0.75975
best accuracy so far: 0.760442
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14200
Valid Loss: 1.09977
Valid Accuracy: 0.75872
best accuracy so far: 0.760442

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14400
Valid Loss: 1.09863
Valid Accuracy: 0.75872
best accuracy so far: 0.760442
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14600
Valid Loss: 1.09922
Valid Accuracy: 0.75837
best accuracy so far: 0.760442
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14800
Valid Loss: 1.09892
Valid Accuracy: 0.75889
best accuracy so far: 0.760442
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 15000
Valid Loss: 1.09899
Valid Accuracy: 0.75906
best accuracy so far: 0.760442
 train accuracy so far: 1.000000
Best Accuracy: 	0.760442
End Training!
Total Training Time: 	1.632511



Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M


***** Running training *****
  Total optimization steps = 15000
  Instantaneous batch size per GPU = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 100
Valid Loss: 5.38236
Valid Accuracy: 0.00552Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.005523

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 200
Valid Loss: 5.33974
Valid Accuracy: 0.00915Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.009147

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 300
Valid Loss: 5.24114
Valid Accuracy: 0.01329Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.013290
 train accuracy so far: 0.008523

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 400
Valid Loss: 5.09900
Valid Accuracy: 0.01881Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.018813

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 500
Valid Loss: 4.90439
Valid Accuracy: 0.03297Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.032965

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 600
Valid Loss: 4.64978
Valid Accuracy: 0.04574Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.045737

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 700
Valid Loss: 4.40187
Valid Accuracy: 0.06766Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.067656
 train accuracy so far: 0.031918

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 800
Valid Loss: 4.15607
Valid Accuracy: 0.08492Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.084915

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 900
Valid Loss: 3.88799
Valid Accuracy: 0.11823Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.118226

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1000
Valid Loss: 3.67124
Valid Accuracy: 0.14877Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.148775

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1100
Valid Loss: 3.49769
Valid Accuracy: 0.17725Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.177252
 train accuracy so far: 0.134358

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1200
Valid Loss: 3.34728
Valid Accuracy: 0.19658Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.196583

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1300
Valid Loss: 3.10838
Valid Accuracy: 0.24940Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.249396

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1400
Valid Loss: 2.90234
Valid Accuracy: 0.29254Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.292544
 train accuracy so far: 0.272059

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1500
Valid Loss: 2.78795
Valid Accuracy: 0.31999Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.319986

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1600
Valid Loss: 2.66965
Valid Accuracy: 0.35071Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.350708

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1700
Valid Loss: 2.49552
Valid Accuracy: 0.37798Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.377977

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1800
Valid Loss: 2.44995
Valid Accuracy: 0.39679Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.396790
 train accuracy so far: 0.418282

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1900
Valid Loss: 2.26718
Valid Accuracy: 0.43735Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.437349

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2000
Valid Loss: 2.14652
Valid Accuracy: 0.46773Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.467725

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2100
Valid Loss: 2.03372
Valid Accuracy: 0.48637Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.486365

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2200
Valid Loss: 1.89266
Valid Accuracy: 0.53521Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.535209
 train accuracy so far: 0.546457

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2300
Valid Loss: 1.82035
Valid Accuracy: 0.54988Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.549879

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2400
Valid Loss: 1.80357
Valid Accuracy: 0.54591
best accuracy so far: 0.549879

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2500
Valid Loss: 1.69924
Valid Accuracy: 0.58164Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.581636

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2600
Valid Loss: 1.65017
Valid Accuracy: 0.58353Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.583535
 train accuracy so far: 0.651404

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2700
Valid Loss: 1.61932
Valid Accuracy: 0.58958Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.589575

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2800
Valid Loss: 1.58537
Valid Accuracy: 0.60062Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.600621

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2900
Valid Loss: 1.49003
Valid Accuracy: 0.61978Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.619779
 train accuracy so far: 0.724265

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3000
Valid Loss: 1.47434
Valid Accuracy: 0.62996Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.629962

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3100
Valid Loss: 1.48110
Valid Accuracy: 0.62289
best accuracy so far: 0.629962

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3200
Valid Loss: 1.39113
Valid Accuracy: 0.64705Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.647049

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3300
Valid Loss: 1.41680
Valid Accuracy: 0.63324
best accuracy so far: 0.647049
 train accuracy so far: 0.784258

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3400
Valid Loss: 1.32247
Valid Accuracy: 0.64998Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.649983

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3500
Valid Loss: 1.30648
Valid Accuracy: 0.66362Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.663618

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3600
Valid Loss: 1.36481
Valid Accuracy: 0.63497
best accuracy so far: 0.663618

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3700
Valid Loss: 1.24147
Valid Accuracy: 0.67397Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.673973
 train accuracy so far: 0.819686

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3800
Valid Loss: 1.23104
Valid Accuracy: 0.67656Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.676562

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3900
Valid Loss: 1.20139
Valid Accuracy: 0.68070Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.680704

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4000
Valid Loss: 1.21686
Valid Accuracy: 0.68019
best accuracy so far: 0.680704

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4100
Valid Loss: 1.25077
Valid Accuracy: 0.67466
best accuracy so far: 0.680704
 train accuracy so far: 0.858623

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4200
Valid Loss: 1.24674
Valid Accuracy: 0.66672
best accuracy so far: 0.680704

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4300
Valid Loss: 1.21160
Valid Accuracy: 0.68122Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.681222

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4400
Valid Loss: 1.20695
Valid Accuracy: 0.68398Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.683983
 train accuracy so far: 0.882687

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4500
Valid Loss: 1.17360
Valid Accuracy: 0.68657Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.686572

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4600
Valid Loss: 1.15073
Valid Accuracy: 0.69537Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.695375

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4700
Valid Loss: 1.14698
Valid Accuracy: 0.69520
best accuracy so far: 0.695375

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4800
Valid Loss: 1.19268
Valid Accuracy: 0.68364
best accuracy so far: 0.695375
 train accuracy so far: 0.909425

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4900
Valid Loss: 1.14180
Valid Accuracy: 0.69210
best accuracy so far: 0.695375

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5000
Valid Loss: 1.13589
Valid Accuracy: 0.70418Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.704177

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5100
Valid Loss: 1.19565
Valid Accuracy: 0.68605
best accuracy so far: 0.704177

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5200
Valid Loss: 1.13715
Valid Accuracy: 0.70021
best accuracy so far: 0.704177
 train accuracy so far: 0.931818

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5300
Valid Loss: 1.11807
Valid Accuracy: 0.71281Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.712806

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5400
Valid Loss: 1.14315
Valid Accuracy: 0.69934
best accuracy so far: 0.712806

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5500
Valid Loss: 1.15787
Valid Accuracy: 0.69969
best accuracy so far: 0.712806

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5600
Valid Loss: 1.13363
Valid Accuracy: 0.70297
best accuracy so far: 0.712806
 train accuracy so far: 0.947694

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5700
Valid Loss: 1.10276
Valid Accuracy: 0.71125
best accuracy so far: 0.712806

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5800
Valid Loss: 1.13459
Valid Accuracy: 0.70090
best accuracy so far: 0.712806

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5900
Valid Loss: 1.18093
Valid Accuracy: 0.69641
best accuracy so far: 0.712806
 train accuracy so far: 0.961063

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6000
Valid Loss: 1.13381
Valid Accuracy: 0.70728
best accuracy so far: 0.712806

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6100
Valid Loss: 1.07621
Valid Accuracy: 0.72989Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.729893

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6200
Valid Loss: 1.10465
Valid Accuracy: 0.71695
best accuracy so far: 0.729893

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6300
Valid Loss: 1.08502
Valid Accuracy: 0.71867
best accuracy so far: 0.729893
 train accuracy so far: 0.970254

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6400
Valid Loss: 1.09031
Valid Accuracy: 0.72299
best accuracy so far: 0.729893

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6500
Valid Loss: 1.14187
Valid Accuracy: 0.71160
best accuracy so far: 0.729893

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6600
Valid Loss: 1.13713
Valid Accuracy: 0.70072
best accuracy so far: 0.729893

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6700
Valid Loss: 1.07642
Valid Accuracy: 0.72920
best accuracy so far: 0.729893
 train accuracy so far: 0.977941

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6800
Valid Loss: 1.11093
Valid Accuracy: 0.71074
best accuracy so far: 0.729893

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6900
Valid Loss: 1.13322
Valid Accuracy: 0.71056
best accuracy so far: 0.729893

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7000
Valid Loss: 1.14067
Valid Accuracy: 0.70677
best accuracy so far: 0.729893

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7100
Valid Loss: 1.14101
Valid Accuracy: 0.70935
best accuracy so far: 0.729893
 train accuracy so far: 0.984459

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7200
Valid Loss: 1.10147
Valid Accuracy: 0.71936
best accuracy so far: 0.729893

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7300
Valid Loss: 1.02457
Valid Accuracy: 0.73300Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.733000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7400
Valid Loss: 1.13039
Valid Accuracy: 0.72351
best accuracy so far: 0.733000
 train accuracy so far: 0.987132

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7500
Valid Loss: 1.08107
Valid Accuracy: 0.73145
best accuracy so far: 0.733000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7600
Valid Loss: 1.08065
Valid Accuracy: 0.73386Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.733863

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7700
Valid Loss: 1.06589
Valid Accuracy: 0.73783Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.737832

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7800
Valid Loss: 1.07849
Valid Accuracy: 0.73231
best accuracy so far: 0.737832
 train accuracy so far: 0.990307

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7900
Valid Loss: 1.07170
Valid Accuracy: 0.73576
best accuracy so far: 0.737832

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8000
Valid Loss: 1.07279
Valid Accuracy: 0.73818Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.738177

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8100
Valid Loss: 1.09557
Valid Accuracy: 0.73265
best accuracy so far: 0.738177

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8200
Valid Loss: 1.08100
Valid Accuracy: 0.73887Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.738868
 train accuracy so far: 0.994151

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8300
Valid Loss: 1.09157
Valid Accuracy: 0.72782
best accuracy so far: 0.738868

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8400
Valid Loss: 1.09228
Valid Accuracy: 0.73455
best accuracy so far: 0.738868

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8500
Valid Loss: 1.03916
Valid Accuracy: 0.74474Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.744736

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8600
Valid Loss: 1.10476
Valid Accuracy: 0.73386
best accuracy so far: 0.744736
 train accuracy so far: 0.995655

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8700
Valid Loss: 1.03462
Valid Accuracy: 0.74629Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.746289

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8800
Valid Loss: 1.01309
Valid Accuracy: 0.75526Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.755264

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8900
Valid Loss: 1.06885
Valid Accuracy: 0.74318
best accuracy so far: 0.755264
 train accuracy so far: 0.996658

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9000
Valid Loss: 1.09999
Valid Accuracy: 0.73939
best accuracy so far: 0.755264

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9100
Valid Loss: 1.02422
Valid Accuracy: 0.75578Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.755782

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9200
Valid Loss: 1.07895
Valid Accuracy: 0.74474
best accuracy so far: 0.755782

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9300
Valid Loss: 1.02840
Valid Accuracy: 0.75475
best accuracy so far: 0.755782
 train accuracy so far: 0.997493

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9400
Valid Loss: 1.06489
Valid Accuracy: 0.74370
best accuracy so far: 0.755782

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9500
Valid Loss: 1.08916
Valid Accuracy: 0.74318
best accuracy so far: 0.755782

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9600
Valid Loss: 1.05020
Valid Accuracy: 0.75388
best accuracy so far: 0.755782

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9700
Valid Loss: 1.04607
Valid Accuracy: 0.75147
best accuracy so far: 0.755782
 train accuracy so far: 0.997828

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9800
Valid Loss: 1.05222
Valid Accuracy: 0.74974
best accuracy so far: 0.755782

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9900
Valid Loss: 1.05100
Valid Accuracy: 0.74974
best accuracy so far: 0.755782

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10000
Valid Loss: 1.03044
Valid Accuracy: 0.75509
best accuracy so far: 0.755782
 train accuracy so far: 0.998162

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10100
Valid Loss: 1.05279
Valid Accuracy: 0.75820Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.758198

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10200
Valid Loss: 1.02807
Valid Accuracy: 0.75716
best accuracy so far: 0.758198

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10300
Valid Loss: 0.99755
Valid Accuracy: 0.76182Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.761823

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10400
Valid Loss: 1.07556
Valid Accuracy: 0.75268
best accuracy so far: 0.761823
 train accuracy so far: 0.999164

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10500
Valid Loss: 1.02862
Valid Accuracy: 0.76148
best accuracy so far: 0.761823

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10600
Valid Loss: 1.03621
Valid Accuracy: 0.75889
best accuracy so far: 0.761823

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10700
Valid Loss: 1.04663
Valid Accuracy: 0.75492
best accuracy so far: 0.761823

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10800
Valid Loss: 1.04299
Valid Accuracy: 0.75734
best accuracy so far: 0.761823
 train accuracy so far: 0.999332

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10900
Valid Loss: 1.03119
Valid Accuracy: 0.76269Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.762686

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11000
Valid Loss: 1.03718
Valid Accuracy: 0.75975
best accuracy so far: 0.762686

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11100
Valid Loss: 1.02557
Valid Accuracy: 0.76424Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.764239

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11200
Valid Loss: 1.02096
Valid Accuracy: 0.76389
best accuracy so far: 0.764239
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11300
Valid Loss: 1.02291
Valid Accuracy: 0.76251
best accuracy so far: 0.764239

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11400
Valid Loss: 1.02430
Valid Accuracy: 0.76510Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.765102

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11500
Valid Loss: 1.01455
Valid Accuracy: 0.76907Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.769071
 train accuracy so far: 0.998997

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11600
Valid Loss: 1.01976
Valid Accuracy: 0.76545
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11700
Valid Loss: 1.00509
Valid Accuracy: 0.76838
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11800
Valid Loss: 0.99978
Valid Accuracy: 0.76631
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11900
Valid Loss: 1.02368
Valid Accuracy: 0.76804
best accuracy so far: 0.769071
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12000
Valid Loss: 1.02972
Valid Accuracy: 0.76666
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12100
Valid Loss: 1.00435
Valid Accuracy: 0.76821
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12200
Valid Loss: 1.01897
Valid Accuracy: 0.76614
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12300
Valid Loss: 1.01652
Valid Accuracy: 0.76838
best accuracy so far: 0.769071
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12400
Valid Loss: 1.01893
Valid Accuracy: 0.77080Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.770797

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12500
Valid Loss: 1.01435
Valid Accuracy: 0.76924
best accuracy so far: 0.770797

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12600
Valid Loss: 1.01062
Valid Accuracy: 0.77252Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.772523

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12700
Valid Loss: 1.01134
Valid Accuracy: 0.77287Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.772868
 train accuracy so far: 0.999332

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12800
Valid Loss: 1.00643
Valid Accuracy: 0.77442Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.774422

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12900
Valid Loss: 1.00772
Valid Accuracy: 0.77114
best accuracy so far: 0.774422

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13000
Valid Loss: 1.01045
Valid Accuracy: 0.77045
best accuracy so far: 0.774422
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13100
Valid Loss: 1.00849
Valid Accuracy: 0.77373
best accuracy so far: 0.774422

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13200
Valid Loss: 1.01150
Valid Accuracy: 0.77252
best accuracy so far: 0.774422

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13300
Valid Loss: 1.00302
Valid Accuracy: 0.77477Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.774767

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13400
Valid Loss: 1.00828
Valid Accuracy: 0.77252
best accuracy so far: 0.774767
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13500
Valid Loss: 1.00604
Valid Accuracy: 0.77252
best accuracy so far: 0.774767

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13600
Valid Loss: 1.00097
Valid Accuracy: 0.77425
best accuracy so far: 0.774767

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13700
Valid Loss: 1.00043
Valid Accuracy: 0.77528Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.775285

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13800
Valid Loss: 1.00087
Valid Accuracy: 0.77477
best accuracy so far: 0.775285
 train accuracy so far: 0.999164

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13900
Valid Loss: 1.00141
Valid Accuracy: 0.77528
best accuracy so far: 0.775285

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14000
Valid Loss: 1.00101
Valid Accuracy: 0.77408
best accuracy so far: 0.775285

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14100
Valid Loss: 1.00012
Valid Accuracy: 0.77667Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.776666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14200
Valid Loss: 1.00221
Valid Accuracy: 0.77546
best accuracy so far: 0.776666
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14300
Valid Loss: 1.00197
Valid Accuracy: 0.77408
best accuracy so far: 0.776666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14400
Valid Loss: 1.00064
Valid Accuracy: 0.77546
best accuracy so far: 0.776666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14500
Valid Loss: 1.00085
Valid Accuracy: 0.77546
best accuracy so far: 0.776666
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14600
Valid Loss: 1.00152
Valid Accuracy: 0.77511
best accuracy so far: 0.776666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14700
Valid Loss: 1.00116
Valid Accuracy: 0.77528
best accuracy so far: 0.776666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14800
Valid Loss: 1.00149
Valid Accuracy: 0.77511
best accuracy so far: 0.776666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14900
Valid Loss: 1.00158
Valid Accuracy: 0.77511
best accuracy so far: 0.776666
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 15000
Valid Loss: 1.00156
Valid Accuracy: 0.77528
best accuracy so far: 0.776666
 train accuracy so far: 1.000000
Best Accuracy: 	0.776666
End Training!
Total Training Time: 	1.723606



Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M


***** Running training *****
  Total optimization steps = 15000
  Instantaneous batch size per GPU = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
 train accuracy so far: 0.007019

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 200
Valid Loss: 5.32210
Valid Accuracy: 0.01053Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.010528
 train accuracy so far: 0.010361

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 400
Valid Loss: 5.05414
Valid Accuracy: 0.02658Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.026579
 train accuracy so far: 0.033757

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 600
Valid Loss: 4.38585
Valid Accuracy: 0.07180Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.071798
 train accuracy so far: 0.098262

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 800
Valid Loss: 3.71864
Valid Accuracy: 0.16741Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.167415
 train accuracy so far: 0.198362

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1000
Valid Loss: 3.14191
Valid Accuracy: 0.26907Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.269071
 train accuracy so far: 0.305983

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1200
Valid Loss: 2.74885
Valid Accuracy: 0.34812Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.348119
 train accuracy so far: 0.410595

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1400
Valid Loss: 2.41443
Valid Accuracy: 0.42095Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.420953
 train accuracy so far: 0.497828

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1600
Valid Loss: 2.13592
Valid Accuracy: 0.48895Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.488954
 train accuracy so far: 0.581049

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1800
Valid Loss: 1.87192
Valid Accuracy: 0.55316Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.553158
 train accuracy so far: 0.638035

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2000
Valid Loss: 1.77642
Valid Accuracy: 0.57560Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.575595
 train accuracy so far: 0.693182

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2200
Valid Loss: 1.61031
Valid Accuracy: 0.60062Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.600621
 train accuracy so far: 0.743483

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2400
Valid Loss: 1.46258
Valid Accuracy: 0.63997Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.639972
 train accuracy so far: 0.778242

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2600
Valid Loss: 1.35007
Valid Accuracy: 0.66327Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.663272
 train accuracy so far: 0.810996

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2800
Valid Loss: 1.24064
Valid Accuracy: 0.69089Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.690887
 train accuracy so far: 0.837901
 train accuracy so far: 0.857787

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3000
Valid Loss: 1.21655
Valid Accuracy: 0.68554
best accuracy so far: 0.690887
 train accuracy so far: 0.882019

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3200
Valid Loss: 1.18587
Valid Accuracy: 0.68882
best accuracy so far: 0.690887
 train accuracy so far: 0.897393

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3400
Valid Loss: 1.16533
Valid Accuracy: 0.69814Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.698136
 train accuracy so far: 0.918616

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3600
Valid Loss: 1.12752
Valid Accuracy: 0.71004Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.710045
 train accuracy so far: 0.933155

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3800
Valid Loss: 1.04989
Valid Accuracy: 0.72523Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.725233
 train accuracy so far: 0.939840

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4000
Valid Loss: 1.12086
Valid Accuracy: 0.70435
best accuracy so far: 0.725233
 train accuracy so far: 0.951872

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4200
Valid Loss: 1.09897
Valid Accuracy: 0.71350
best accuracy so far: 0.725233
 train accuracy so far: 0.959057

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4400
Valid Loss: 1.02093
Valid Accuracy: 0.73058Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.730583
 train accuracy so far: 0.967747

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4600
Valid Loss: 1.10603
Valid Accuracy: 0.70866
best accuracy so far: 0.730583
 train accuracy so far: 0.972761

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4800
Valid Loss: 1.07736
Valid Accuracy: 0.71798
best accuracy so far: 0.730583
 train accuracy so far: 0.975602

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5000
Valid Loss: 1.07101
Valid Accuracy: 0.72178
best accuracy so far: 0.730583
 train accuracy so far: 0.981952

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5200
Valid Loss: 1.07500
Valid Accuracy: 0.71954
best accuracy so far: 0.730583
 train accuracy so far: 0.985461

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5400
Valid Loss: 1.09819
Valid Accuracy: 0.71954
best accuracy so far: 0.730583
 train accuracy so far: 0.989806

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5600
Valid Loss: 1.14460
Valid Accuracy: 0.71143
best accuracy so far: 0.730583
 train accuracy so far: 0.991310
 train accuracy so far: 0.993316

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5800
Valid Loss: 1.05044
Valid Accuracy: 0.73507Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.735071
 train accuracy so far: 0.992647

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6000
Valid Loss: 1.09869
Valid Accuracy: 0.72316
best accuracy so far: 0.735071
 train accuracy so far: 0.994151

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6200
Valid Loss: 1.01205
Valid Accuracy: 0.74612Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.746117
 train accuracy so far: 0.995321

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6400
Valid Loss: 1.06246
Valid Accuracy: 0.73800
best accuracy so far: 0.746117
 train accuracy so far: 0.994987

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6600
Valid Loss: 1.08843
Valid Accuracy: 0.73041
best accuracy so far: 0.746117
 train accuracy so far: 0.996825

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6800
Valid Loss: 1.07278
Valid Accuracy: 0.73714
best accuracy so far: 0.746117
 train accuracy so far: 0.996992

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7000
Valid Loss: 1.03900
Valid Accuracy: 0.74577
best accuracy so far: 0.746117
 train accuracy so far: 0.998329

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7200
Valid Loss: 1.05928
Valid Accuracy: 0.74336
best accuracy so far: 0.746117
 train accuracy so far: 0.999332

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7400
Valid Loss: 1.05510
Valid Accuracy: 0.74594
best accuracy so far: 0.746117
 train accuracy so far: 0.998496

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7600
Valid Loss: 1.08830
Valid Accuracy: 0.73662
best accuracy so far: 0.746117
 train accuracy so far: 0.998663

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7800
Valid Loss: 1.03139
Valid Accuracy: 0.74922Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.749223
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8000
Valid Loss: 1.03422
Valid Accuracy: 0.75285Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.752848
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8200
Valid Loss: 1.02982
Valid Accuracy: 0.75544Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.755437
 train accuracy so far: 0.999332

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8400
Valid Loss: 1.01980
Valid Accuracy: 0.75716Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.757163
 train accuracy so far: 0.998997

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8600
Valid Loss: 1.04295
Valid Accuracy: 0.74836
best accuracy so far: 0.757163
 train accuracy so far: 0.999666
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8800
Valid Loss: 1.05969
Valid Accuracy: 0.74853
best accuracy so far: 0.757163
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9000
Valid Loss: 1.01958
Valid Accuracy: 0.75578
best accuracy so far: 0.757163
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9200
Valid Loss: 1.02762
Valid Accuracy: 0.75837Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.758371
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9400
Valid Loss: 1.02760
Valid Accuracy: 0.75578
best accuracy so far: 0.758371
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9600
Valid Loss: 1.03878
Valid Accuracy: 0.75664
best accuracy so far: 0.758371
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9800
Valid Loss: 1.04922
Valid Accuracy: 0.75388
best accuracy so far: 0.758371
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10000
Valid Loss: 1.02637
Valid Accuracy: 0.75716
best accuracy so far: 0.758371
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10200
Valid Loss: 1.02320
Valid Accuracy: 0.75854Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.758543
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10400
Valid Loss: 1.01699
Valid Accuracy: 0.76493Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.764929
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10600
Valid Loss: 1.01909
Valid Accuracy: 0.76044
best accuracy so far: 0.764929
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10800
Valid Loss: 1.01391
Valid Accuracy: 0.76217
best accuracy so far: 0.764929
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11000
Valid Loss: 1.00545
Valid Accuracy: 0.76355
best accuracy so far: 0.764929
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11200
Valid Loss: 1.02218
Valid Accuracy: 0.76458
best accuracy so far: 0.764929
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11400
Valid Loss: 1.02494
Valid Accuracy: 0.75941
best accuracy so far: 0.764929
 train accuracy so far: 0.999833
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11600
Valid Loss: 1.02200
Valid Accuracy: 0.76372
best accuracy so far: 0.764929
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11800
Valid Loss: 1.01969
Valid Accuracy: 0.76286
best accuracy so far: 0.764929
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12000
Valid Loss: 1.01758
Valid Accuracy: 0.76217
best accuracy so far: 0.764929
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12200
Valid Loss: 1.00940
Valid Accuracy: 0.76683Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.766828
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12400
Valid Loss: 1.00594
Valid Accuracy: 0.77149Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.771488
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12600
Valid Loss: 1.00636
Valid Accuracy: 0.76786
best accuracy so far: 0.771488
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12800
Valid Loss: 1.00912
Valid Accuracy: 0.76821
best accuracy so far: 0.771488
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13000
Valid Loss: 1.00871
Valid Accuracy: 0.76804
best accuracy so far: 0.771488
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13200
Valid Loss: 1.00627
Valid Accuracy: 0.76855
best accuracy so far: 0.771488
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13400
Valid Loss: 1.00968
Valid Accuracy: 0.76648
best accuracy so far: 0.771488
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13600
Valid Loss: 1.00800
Valid Accuracy: 0.76666
best accuracy so far: 0.771488
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13800
Valid Loss: 1.00920
Valid Accuracy: 0.76700
best accuracy so far: 0.771488
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14000
Valid Loss: 1.00767
Valid Accuracy: 0.76752
best accuracy so far: 0.771488
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14200
Valid Loss: 1.00973
Valid Accuracy: 0.76717
best accuracy so far: 0.771488
 train accuracy so far: 1.000000
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14400
Valid Loss: 1.00835
Valid Accuracy: 0.76786
best accuracy so far: 0.771488
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14600
Valid Loss: 1.00795
Valid Accuracy: 0.76821
best accuracy so far: 0.771488
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14800
Valid Loss: 1.00809
Valid Accuracy: 0.76769
best accuracy so far: 0.771488
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 15000
Valid Loss: 1.00802
Valid Accuracy: 0.76821
best accuracy so far: 0.771488
 train accuracy so far: 1.000000
Best Accuracy: 	0.771488
End Training!
Total Training Time: 	1.930947



Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M


***** Running training *****
  Total optimization steps = 15000
  Instantaneous batch size per GPU = 14
  Total train batch size (w. parallel, distributed & accumulation) = 14
  Total train batch size (w. parallel, distributed & accumulation) = 14
  Gradient Accumulation steps = 1

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 200
Valid Loss: 5.30627
Valid Accuracy: 0.00794Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.007939
 train accuracy so far: 0.007009

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 400
Valid Loss: 4.83416
Valid Accuracy: 0.03176Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.031757
 train accuracy so far: 0.015854

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 600
Valid Loss: 4.06124
Valid Accuracy: 0.11357Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.113566
 train accuracy so far: 0.073097

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 800
Valid Loss: 3.50185
Valid Accuracy: 0.18295Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.182948
 train accuracy so far: 0.199099

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1000
Valid Loss: 2.61013
Valid Accuracy: 0.35847Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.358474
 train accuracy so far: 0.351636

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1200
Valid Loss: 2.21159
Valid Accuracy: 0.45288Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.452882
 train accuracy so far: 0.497330

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1400
Valid Loss: 1.87917
Valid Accuracy: 0.53435Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.534346
 train accuracy so far: 0.607810

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1600
Valid Loss: 1.63188
Valid Accuracy: 0.59441Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.594408
 train accuracy so far: 0.685915

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1800
Valid Loss: 1.51595
Valid Accuracy: 0.61046Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.610459
 train accuracy so far: 0.755674

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2000
Valid Loss: 1.31744
Valid Accuracy: 0.65948Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.659475
 train accuracy so far: 0.803238

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2200
Valid Loss: 1.25710
Valid Accuracy: 0.66966Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.669658
 train accuracy so far: 0.840621

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2400
Valid Loss: 1.41302
Valid Accuracy: 0.62927
best accuracy so far: 0.669658
 train accuracy so far: 0.878004

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2600
Valid Loss: 1.14745
Valid Accuracy: 0.69934Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.699344
 train accuracy so far: 0.900534

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2800
Valid Loss: 1.21374
Valid Accuracy: 0.66862
best accuracy so far: 0.699344
 train accuracy so far: 0.922230

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3000
Valid Loss: 1.15458
Valid Accuracy: 0.70107Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.701070

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3200
Valid Loss: 1.13718
Valid Accuracy: 0.69934
best accuracy so far: 0.701070
 train accuracy so far: 0.939753

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3400
Valid Loss: 1.13310
Valid Accuracy: 0.70435Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.704349
 train accuracy so far: 0.950267

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3600
Valid Loss: 1.08939
Valid Accuracy: 0.71729Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.717294
 train accuracy so far: 0.960113

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3800
Valid Loss: 1.15666
Valid Accuracy: 0.70331
best accuracy so far: 0.717294
 train accuracy so far: 0.973131

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4000
Valid Loss: 1.19997
Valid Accuracy: 0.69934
best accuracy so far: 0.717294
 train accuracy so far: 0.977637

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4200
Valid Loss: 1.14652
Valid Accuracy: 0.70780
best accuracy so far: 0.717294
 train accuracy so far: 0.981142

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4400
Valid Loss: 1.14223
Valid Accuracy: 0.71315
best accuracy so far: 0.717294
 train accuracy so far: 0.985147

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4600
Valid Loss: 1.12451
Valid Accuracy: 0.71850Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.718502
 train accuracy so far: 0.986816

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4800
Valid Loss: 1.10900
Valid Accuracy: 0.72264Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.722644
 train accuracy so far: 0.991489

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5000
Valid Loss: 1.13706
Valid Accuracy: 0.72316Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.723162
 train accuracy so far: 0.990654

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5200
Valid Loss: 1.13180
Valid Accuracy: 0.73438Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.734380
 train accuracy so far: 0.992991

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5400
Valid Loss: 1.18044
Valid Accuracy: 0.72420
best accuracy so far: 0.734380
 train accuracy so far: 0.993992

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5600
Valid Loss: 1.11021
Valid Accuracy: 0.73990Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.739903
 train accuracy so far: 0.995327

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5800
Valid Loss: 1.15275
Valid Accuracy: 0.72851
best accuracy so far: 0.739903
 train accuracy so far: 0.995661

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6000
Valid Loss: 1.11141
Valid Accuracy: 0.74422Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.744218

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6200
Valid Loss: 1.13444
Valid Accuracy: 0.74180
best accuracy so far: 0.744218
 train accuracy so far: 0.996162

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6400
Valid Loss: 1.09873
Valid Accuracy: 0.74577Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.745771
 train accuracy so far: 0.997497

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6600
Valid Loss: 1.11698
Valid Accuracy: 0.74543
best accuracy so far: 0.745771
 train accuracy so far: 0.998999

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6800
Valid Loss: 1.09664
Valid Accuracy: 0.74871Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.748706
 train accuracy so far: 0.998832

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7000
Valid Loss: 1.06325
Valid Accuracy: 0.75820Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.758198
 train accuracy so far: 0.999332

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7200
Valid Loss: 1.09232
Valid Accuracy: 0.75872Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.758716
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7400
Valid Loss: 1.08598
Valid Accuracy: 0.76010Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.760097
 train accuracy so far: 0.999332

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7600
Valid Loss: 1.08466
Valid Accuracy: 0.75751
best accuracy so far: 0.760097
 train accuracy so far: 0.999332

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7800
Valid Loss: 1.11553
Valid Accuracy: 0.76251Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.762513
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8000
Valid Loss: 1.07169
Valid Accuracy: 0.76407Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.764066
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8200
Valid Loss: 1.07028
Valid Accuracy: 0.76320
best accuracy so far: 0.764066
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8400
Valid Loss: 1.04707
Valid Accuracy: 0.76993Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.769934
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8600
Valid Loss: 1.04751
Valid Accuracy: 0.77425Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.774249
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8800
Valid Loss: 1.07537
Valid Accuracy: 0.76735
best accuracy so far: 0.774249
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9000
Valid Loss: 1.03768
Valid Accuracy: 0.77408
best accuracy so far: 0.774249

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9200
Valid Loss: 1.04264
Valid Accuracy: 0.77580Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.775803
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9400
Valid Loss: 1.05051
Valid Accuracy: 0.77667Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.776666
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9600
Valid Loss: 1.04232
Valid Accuracy: 0.77528
best accuracy so far: 0.776666
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9800
Valid Loss: 1.04013
Valid Accuracy: 0.77874Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.778737
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10000
Valid Loss: 1.04413
Valid Accuracy: 0.77960Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.779600
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10200
Valid Loss: 1.06483
Valid Accuracy: 0.77546
best accuracy so far: 0.779600
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10400
Valid Loss: 1.03205
Valid Accuracy: 0.78046Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.780463
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10600
Valid Loss: 1.03350
Valid Accuracy: 0.77960
best accuracy so far: 0.780463
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10800
Valid Loss: 1.04141
Valid Accuracy: 0.77874
best accuracy so far: 0.780463
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11000
Valid Loss: 1.04618
Valid Accuracy: 0.77925
best accuracy so far: 0.780463
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11200
Valid Loss: 1.04794
Valid Accuracy: 0.77718
best accuracy so far: 0.780463
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11400
Valid Loss: 1.04237
Valid Accuracy: 0.77960
best accuracy so far: 0.780463
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11600
Valid Loss: 1.04046
Valid Accuracy: 0.78012
best accuracy so far: 0.780463
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11800
Valid Loss: 1.04503
Valid Accuracy: 0.77943
best accuracy so far: 0.780463
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12000
Valid Loss: 1.03878
Valid Accuracy: 0.78064Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.780635
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12200
Valid Loss: 1.04726
Valid Accuracy: 0.77925
best accuracy so far: 0.780635

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12400
Valid Loss: 1.04269
Valid Accuracy: 0.77925
best accuracy so far: 0.780635
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12600
Valid Loss: 1.04267
Valid Accuracy: 0.77943
best accuracy so far: 0.780635
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12800
Valid Loss: 1.04333
Valid Accuracy: 0.78081Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13000
Valid Loss: 1.04335
Valid Accuracy: 0.78064
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13200
Valid Loss: 1.04289
Valid Accuracy: 0.78081
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13400
Valid Loss: 1.04074
Valid Accuracy: 0.78064
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13600
Valid Loss: 1.04399
Valid Accuracy: 0.78081
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13800
Valid Loss: 1.04387
Valid Accuracy: 0.78029
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14000
Valid Loss: 1.04350
Valid Accuracy: 0.77960
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14200
Valid Loss: 1.04294
Valid Accuracy: 0.77994
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14400
Valid Loss: 1.04288
Valid Accuracy: 0.78012
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14600
Valid Loss: 1.04303
Valid Accuracy: 0.78012
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14800
Valid Loss: 1.04326
Valid Accuracy: 0.78029
best accuracy so far: 0.780808
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 15000
Valid Loss: 1.04307
Valid Accuracy: 0.78029
best accuracy so far: 0.780808
 train accuracy so far: 1.000000
Best Accuracy: 	0.780808
End Training!
Total Training Time: 	1.784128



Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M


***** Running training *****
  Total optimization steps = 15000
  Instantaneous batch size per GPU = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 1

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 200
Valid Loss: 5.35636
Valid Accuracy: 0.00811Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.008112
 train accuracy so far: 0.008189

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 400
Valid Loss: 5.23471
Valid Accuracy: 0.01174Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.011736

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 600
Valid Loss: 4.93556
Valid Accuracy: 0.02934Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.029341
 train accuracy so far: 0.022226

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 800
Valid Loss: 4.50145
Valid Accuracy: 0.05506Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.055057

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1000
Valid Loss: 4.09884
Valid Accuracy: 0.08992Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.089921
 train accuracy so far: 0.088904

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1200
Valid Loss: 3.65747
Valid Accuracy: 0.15343Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.153435

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1400
Valid Loss: 3.31230
Valid Accuracy: 0.22437Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.224370
 train accuracy so far: 0.207721

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1600
Valid Loss: 3.07814
Valid Accuracy: 0.26182Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.261823

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1800
Valid Loss: 2.80307
Valid Accuracy: 0.32534Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.325337
 train accuracy so far: 0.329713

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2000
Valid Loss: 2.52362
Valid Accuracy: 0.38471Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.384708

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2200
Valid Loss: 2.32605
Valid Accuracy: 0.43252Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.432516
 train accuracy so far: 0.450535

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2400
Valid Loss: 2.22213
Valid Accuracy: 0.45219Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.452192

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2600
Valid Loss: 2.04120
Valid Accuracy: 0.49379Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.493787
 train accuracy so far: 0.560829

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2800
Valid Loss: 1.92895
Valid Accuracy: 0.52969Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.529686
 train accuracy so far: 0.647894

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3000
Valid Loss: 1.70168
Valid Accuracy: 0.57974Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.579738

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3200
Valid Loss: 1.62131
Valid Accuracy: 0.59475Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.594753
 train accuracy so far: 0.705882

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3400
Valid Loss: 1.51877
Valid Accuracy: 0.62012Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.620124

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3600
Valid Loss: 1.49278
Valid Accuracy: 0.62616Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.626165
 train accuracy so far: 0.766377

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3800
Valid Loss: 1.41296
Valid Accuracy: 0.63963Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.639627

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4000
Valid Loss: 1.38584
Valid Accuracy: 0.64808Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.648084
 train accuracy so far: 0.801805

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4200
Valid Loss: 1.27855
Valid Accuracy: 0.66500Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.664998

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4400
Valid Loss: 1.32726
Valid Accuracy: 0.65188
best accuracy so far: 0.664998
 train accuracy so far: 0.842246

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4600
Valid Loss: 1.27818
Valid Accuracy: 0.67035Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.670349

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4800
Valid Loss: 1.22046
Valid Accuracy: 0.68588Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.685882
 train accuracy so far: 0.869987

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5000
Valid Loss: 1.14582
Valid Accuracy: 0.70400Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.704004

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5200
Valid Loss: 1.18254
Valid Accuracy: 0.69572
best accuracy so far: 0.704004
 train accuracy so far: 0.897894

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5400
Valid Loss: 1.14357
Valid Accuracy: 0.69693
best accuracy so far: 0.704004

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5600
Valid Loss: 1.15065
Valid Accuracy: 0.70072
best accuracy so far: 0.704004
 train accuracy so far: 0.917447

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5800
Valid Loss: 1.12910
Valid Accuracy: 0.70504Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.705040
 train accuracy so far: 0.934659

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6000
Valid Loss: 1.13827
Valid Accuracy: 0.70452
best accuracy so far: 0.705040

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6200
Valid Loss: 1.12154
Valid Accuracy: 0.70815Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.708146
 train accuracy so far: 0.949532

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6400
Valid Loss: 1.11438
Valid Accuracy: 0.70469
best accuracy so far: 0.708146

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6600
Valid Loss: 1.16986
Valid Accuracy: 0.69520
best accuracy so far: 0.708146
 train accuracy so far: 0.957721

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6800
Valid Loss: 1.07960
Valid Accuracy: 0.71384Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.713842

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7000
Valid Loss: 1.13431
Valid Accuracy: 0.71177
best accuracy so far: 0.713842
 train accuracy so far: 0.968082

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7200
Valid Loss: 1.06684
Valid Accuracy: 0.72385Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.723852

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7400
Valid Loss: 1.17626
Valid Accuracy: 0.70228
best accuracy so far: 0.723852
 train accuracy so far: 0.976270

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7600
Valid Loss: 1.07592
Valid Accuracy: 0.72316
best accuracy so far: 0.723852

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7800
Valid Loss: 1.10334
Valid Accuracy: 0.71816
best accuracy so far: 0.723852
 train accuracy so far: 0.979947

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8000
Valid Loss: 1.08561
Valid Accuracy: 0.71764
best accuracy so far: 0.723852

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8200
Valid Loss: 1.06263
Valid Accuracy: 0.72730Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.727304
 train accuracy so far: 0.985294

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8400
Valid Loss: 1.07301
Valid Accuracy: 0.73110Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.731101

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8600
Valid Loss: 1.09867
Valid Accuracy: 0.72264
best accuracy so far: 0.731101
 train accuracy so far: 0.990307

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8800
Valid Loss: 1.02552
Valid Accuracy: 0.73887Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.738868
 train accuracy so far: 0.989973

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9000
Valid Loss: 1.06967
Valid Accuracy: 0.73473
best accuracy so far: 0.738868

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9200
Valid Loss: 1.03148
Valid Accuracy: 0.73559
best accuracy so far: 0.738868
 train accuracy so far: 0.994485

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9400
Valid Loss: 1.05572
Valid Accuracy: 0.73611
best accuracy so far: 0.738868

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9600
Valid Loss: 1.04933
Valid Accuracy: 0.74094Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.740939
 train accuracy so far: 0.995822

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9800
Valid Loss: 1.04077
Valid Accuracy: 0.73559
best accuracy so far: 0.740939

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10000
Valid Loss: 1.03678
Valid Accuracy: 0.73973
best accuracy so far: 0.740939
 train accuracy so far: 0.996324

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10200
Valid Loss: 1.04874
Valid Accuracy: 0.74163Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.741629

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10400
Valid Loss: 1.03870
Valid Accuracy: 0.74732Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.747325
 train accuracy so far: 0.996992

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10600
Valid Loss: 1.06636
Valid Accuracy: 0.73887
best accuracy so far: 0.747325

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10800
Valid Loss: 1.03041
Valid Accuracy: 0.74474
best accuracy so far: 0.747325
 train accuracy so far: 0.997828

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11000
Valid Loss: 1.02034
Valid Accuracy: 0.74663
best accuracy so far: 0.747325

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11200
Valid Loss: 1.00897
Valid Accuracy: 0.74957Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.749569
 train accuracy so far: 0.998329

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11400
Valid Loss: 1.02278
Valid Accuracy: 0.75112Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.751122
 train accuracy so far: 0.997660

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11600
Valid Loss: 1.02801
Valid Accuracy: 0.75060
best accuracy so far: 0.751122

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11800
Valid Loss: 1.01408
Valid Accuracy: 0.75009
best accuracy so far: 0.751122
 train accuracy so far: 0.998496

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12000
Valid Loss: 1.02459
Valid Accuracy: 0.75112
best accuracy so far: 0.751122

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12200
Valid Loss: 1.01543
Valid Accuracy: 0.75147Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.751467
 train accuracy so far: 0.998997

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12400
Valid Loss: 1.02501
Valid Accuracy: 0.74732
best accuracy so far: 0.751467

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12600
Valid Loss: 1.02512
Valid Accuracy: 0.75164Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.751640
 train accuracy so far: 0.999164

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12800
Valid Loss: 1.02544
Valid Accuracy: 0.75164
best accuracy so far: 0.751640

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13000
Valid Loss: 1.02094
Valid Accuracy: 0.75371Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.753711
 train accuracy so far: 0.998329

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13200
Valid Loss: 1.01327
Valid Accuracy: 0.75388Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.753883

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13400
Valid Loss: 1.01324
Valid Accuracy: 0.75457Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.754574
 train accuracy so far: 0.998663

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13600
Valid Loss: 1.00684
Valid Accuracy: 0.75526Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.755264

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13800
Valid Loss: 1.00926
Valid Accuracy: 0.75457
best accuracy so far: 0.755264
 train accuracy so far: 0.998997

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14000
Valid Loss: 1.01096
Valid Accuracy: 0.75423
best accuracy so far: 0.755264

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14200
Valid Loss: 1.00803
Valid Accuracy: 0.75388
best accuracy so far: 0.755264
 train accuracy so far: 0.998830

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14400
Valid Loss: 1.00702
Valid Accuracy: 0.75406
best accuracy so far: 0.755264
 train accuracy so far: 0.997995

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14600
Valid Loss: 1.00772
Valid Accuracy: 0.75406
best accuracy so far: 0.755264

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14800
Valid Loss: 1.00720
Valid Accuracy: 0.75440
best accuracy so far: 0.755264
 train accuracy so far: 0.998830

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 15000
Valid Loss: 1.00762
Valid Accuracy: 0.75475
best accuracy so far: 0.755264
 train accuracy so far: 0.998437
Best Accuracy: 	0.755264
End Training!
Total Training Time: 	1.320010



Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
activation: !!python/name:torch.nn.modules.activation.ReLU ''
classifier: token
conv_bias: false
hidden_size: 384
in_planes: 64
kernel_size: 7
max_pool: true
mlp_ratio: 3
n_conv_layers: 2
num_heads: 6
num_layers: 14
padding: 3
patches:
  size: !!python/tuple
  - 16
  - 16
pooling_kernel_size: 3
pooling_padding: 1
pooling_stride: 2
representation_size: null
seq_pool: true
slide_step: 12
split: overlap
stride: 2
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 1152
  num_heads: 12
  num_layers: 12

Training parameters Namespace(data_root='/home/ubuntu/Datas/CUB/CUB_200_2011', dataset='CUB_200_2011', decay_type='cosine', device=device(type='cuda', index=0), eval_batch_size=8, eval_every=100, fp16=True, fp16_opt_level='O2', gradient_accumulation_steps=1, img_size=384, learning_rate=0.1, local_rank=0, loss_scale=0, max_grad_norm=1.0, model_type='CCT-14t/7x2', n_gpu=1, name='sample_run', name_nni='first_nni', nprocs=2, num_steps=15000, output_dir='./output', pretrain=True, pretrained_dir='/home/ubuntu/Datas/cct_14_7x2_384_imagenet.pth', pretrained_model='cct_14_7x2_384', seed=42, seq_pool=True, slide_step=12, smoothing_value=0.0, split='overlap', train_batch_size=16, train_log_name='log_train_fix_cub_nni_local.txt', warmup_steps=500, weight_decay=0)
Total Parameter: 	22.2M


***** Running training *****
  Total optimization steps = 15000
  Instantaneous batch size per GPU = 14
  Total train batch size (w. parallel, distributed & accumulation) = 14
  Total train batch size (w. parallel, distributed & accumulation) = 14
  Gradient Accumulation steps = 1

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 100
Valid Loss: 5.37645
Valid Accuracy: 0.00466Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.004660

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 200
Valid Loss: 5.32492
Valid Accuracy: 0.00863Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.008630
 train accuracy so far: 0.006008

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 300
Valid Loss: 5.21455
Valid Accuracy: 0.01294Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.012944

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 400
Valid Loss: 5.02439
Valid Accuracy: 0.02451Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.024508
 train accuracy so far: 0.017023

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 500
Valid Loss: 4.71966
Valid Accuracy: 0.04470Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.044701

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 600
Valid Loss: 4.40954
Valid Accuracy: 0.07577Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.075768
 train accuracy so far: 0.045728

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 700
Valid Loss: 4.13099
Valid Accuracy: 0.10183Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.101829

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 800
Valid Loss: 3.89637
Valid Accuracy: 0.13048Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.130480
 train accuracy so far: 0.127670

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 900
Valid Loss: 3.51177
Valid Accuracy: 0.18226Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.182258

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1000
Valid Loss: 3.28550
Valid Accuracy: 0.22057Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.220573
 train accuracy so far: 0.237984

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1100
Valid Loss: 3.04164
Valid Accuracy: 0.28340Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.283397

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1200
Valid Loss: 2.87871
Valid Accuracy: 0.32913Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.329134
 train accuracy so far: 0.340621

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1300
Valid Loss: 2.68121
Valid Accuracy: 0.37522Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.375216

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1400
Valid Loss: 2.50467
Valid Accuracy: 0.40594Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.405937
 train accuracy so far: 0.447931

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1500
Valid Loss: 2.36308
Valid Accuracy: 0.44788Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.447877

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1600
Valid Loss: 2.19206
Valid Accuracy: 0.48257Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.482568

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1700
Valid Loss: 2.10683
Valid Accuracy: 0.49707Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.497066
 train accuracy so far: 0.540888

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1800
Valid Loss: 1.99700
Valid Accuracy: 0.52313Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.523127

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 1900
Valid Loss: 1.85401
Valid Accuracy: 0.55989Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.559890
 train accuracy so far: 0.618992

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2000
Valid Loss: 1.75837
Valid Accuracy: 0.57473Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.574732

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2100
Valid Loss: 1.75030
Valid Accuracy: 0.57473
best accuracy so far: 0.574732
 train accuracy so far: 0.685080

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2200
Valid Loss: 1.64923
Valid Accuracy: 0.59527Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.595271

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2300
Valid Loss: 1.54481
Valid Accuracy: 0.62478Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.624784
 train accuracy so far: 0.729139

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2400
Valid Loss: 1.53911
Valid Accuracy: 0.62081
best accuracy so far: 0.624784

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2500
Valid Loss: 1.46738
Valid Accuracy: 0.63341Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.633414
 train accuracy so far: 0.777203

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2600
Valid Loss: 1.36499
Valid Accuracy: 0.65775Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.657749

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2700
Valid Loss: 1.33031
Valid Accuracy: 0.66431Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.664308
 train accuracy so far: 0.810080

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2800
Valid Loss: 1.36444
Valid Accuracy: 0.65274
best accuracy so far: 0.664308

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 2900
Valid Loss: 1.29265
Valid Accuracy: 0.67294Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.672938
 train accuracy so far: 0.836949

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3000
Valid Loss: 1.23071
Valid Accuracy: 0.68640Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.686400

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3100
Valid Loss: 1.20287
Valid Accuracy: 0.69296Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.692958

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3200
Valid Loss: 1.19744
Valid Accuracy: 0.69106
best accuracy so far: 0.692958
 train accuracy so far: 0.863652

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3300
Valid Loss: 1.16863
Valid Accuracy: 0.69123
best accuracy so far: 0.692958

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3400
Valid Loss: 1.16362
Valid Accuracy: 0.69934Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.699344
 train accuracy so far: 0.878672

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3500
Valid Loss: 1.11861
Valid Accuracy: 0.71384Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.713842

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3600
Valid Loss: 1.17575
Valid Accuracy: 0.69555
best accuracy so far: 0.713842
 train accuracy so far: 0.904206

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3700
Valid Loss: 1.16036
Valid Accuracy: 0.69745
best accuracy so far: 0.713842

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3800
Valid Loss: 1.16063
Valid Accuracy: 0.69814
best accuracy so far: 0.713842
 train accuracy so far: 0.919226

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 3900
Valid Loss: 1.10366
Valid Accuracy: 0.70469
best accuracy so far: 0.713842

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4000
Valid Loss: 1.12864
Valid Accuracy: 0.70556
best accuracy so far: 0.713842
 train accuracy so far: 0.934913

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4100
Valid Loss: 1.08899
Valid Accuracy: 0.71609Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.716086

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4200
Valid Loss: 1.08895
Valid Accuracy: 0.71488
best accuracy so far: 0.716086
 train accuracy so far: 0.940087

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4300
Valid Loss: 1.08904
Valid Accuracy: 0.70763
best accuracy so far: 0.716086

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4400
Valid Loss: 1.01635
Valid Accuracy: 0.72903Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.729030
 train accuracy so far: 0.952603

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4500
Valid Loss: 1.07209
Valid Accuracy: 0.71022
best accuracy so far: 0.729030

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4600
Valid Loss: 1.06223
Valid Accuracy: 0.71212
best accuracy so far: 0.729030

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4700
Valid Loss: 1.05446
Valid Accuracy: 0.71850
best accuracy so far: 0.729030
 train accuracy so far: 0.964286

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4800
Valid Loss: 1.13182
Valid Accuracy: 0.70193
best accuracy so far: 0.729030

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 4900
Valid Loss: 1.06026
Valid Accuracy: 0.71643
best accuracy so far: 0.729030
 train accuracy so far: 0.969626

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5000
Valid Loss: 1.02880
Valid Accuracy: 0.72541
best accuracy so far: 0.729030

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5100
Valid Loss: 1.06859
Valid Accuracy: 0.72126
best accuracy so far: 0.729030
 train accuracy so far: 0.975300

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5200
Valid Loss: 1.09189
Valid Accuracy: 0.71798
best accuracy so far: 0.729030

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5300
Valid Loss: 1.03880
Valid Accuracy: 0.72834
best accuracy so far: 0.729030
 train accuracy so far: 0.980808

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5400
Valid Loss: 1.01931
Valid Accuracy: 0.73835Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.738350

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5500
Valid Loss: 1.04624
Valid Accuracy: 0.72541
best accuracy so far: 0.738350
 train accuracy so far: 0.981976

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5600
Valid Loss: 0.99906
Valid Accuracy: 0.74111Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.741111

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5700
Valid Loss: 1.04982
Valid Accuracy: 0.73145
best accuracy so far: 0.741111
 train accuracy so far: 0.986315

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5800
Valid Loss: 1.05983
Valid Accuracy: 0.72661
best accuracy so far: 0.741111

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 5900
Valid Loss: 1.07197
Valid Accuracy: 0.72351
best accuracy so far: 0.741111
 train accuracy so far: 0.989820

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6000
Valid Loss: 1.07828
Valid Accuracy: 0.72972
best accuracy so far: 0.741111

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6100
Valid Loss: 1.00921
Valid Accuracy: 0.74042
best accuracy so far: 0.741111

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6200
Valid Loss: 1.13595
Valid Accuracy: 0.70866
best accuracy so far: 0.741111
 train accuracy so far: 0.993324

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6300
Valid Loss: 1.06931
Valid Accuracy: 0.72799
best accuracy so far: 0.741111

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6400
Valid Loss: 1.04900
Valid Accuracy: 0.73007
best accuracy so far: 0.741111
 train accuracy so far: 0.993658

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6500
Valid Loss: 1.02740
Valid Accuracy: 0.73455
best accuracy so far: 0.741111

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6600
Valid Loss: 1.04945
Valid Accuracy: 0.73887
best accuracy so far: 0.741111
 train accuracy so far: 0.994326

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6700
Valid Loss: 1.04686
Valid Accuracy: 0.73662
best accuracy so far: 0.741111

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6800
Valid Loss: 1.06620
Valid Accuracy: 0.72903
best accuracy so far: 0.741111
 train accuracy so far: 0.997330

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 6900
Valid Loss: 1.01453
Valid Accuracy: 0.74732Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.747325

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7000
Valid Loss: 1.00408
Valid Accuracy: 0.74387
best accuracy so far: 0.747325
 train accuracy so far: 0.996495

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7100
Valid Loss: 0.99080
Valid Accuracy: 0.75509Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.755091

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7200
Valid Loss: 1.07764
Valid Accuracy: 0.73904
best accuracy so far: 0.755091
 train accuracy so far: 0.996829

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7300
Valid Loss: 0.99787
Valid Accuracy: 0.75250
best accuracy so far: 0.755091

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7400
Valid Loss: 0.99839
Valid Accuracy: 0.74681
best accuracy so far: 0.755091
 train accuracy so far: 0.996996

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7500
Valid Loss: 1.04364
Valid Accuracy: 0.75181
best accuracy so far: 0.755091

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7600
Valid Loss: 1.01641
Valid Accuracy: 0.74784
best accuracy so far: 0.755091

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7700
Valid Loss: 1.04350
Valid Accuracy: 0.74560
best accuracy so far: 0.755091
 train accuracy so far: 0.998665

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7800
Valid Loss: 1.07128
Valid Accuracy: 0.73421
best accuracy so far: 0.755091

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 7900
Valid Loss: 1.01744
Valid Accuracy: 0.75164
best accuracy so far: 0.755091
 train accuracy so far: 0.998832

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8000
Valid Loss: 1.02947
Valid Accuracy: 0.74871
best accuracy so far: 0.755091

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8100
Valid Loss: 1.05409
Valid Accuracy: 0.74715
best accuracy so far: 0.755091
 train accuracy so far: 0.999166

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8200
Valid Loss: 1.01804
Valid Accuracy: 0.75371
best accuracy so far: 0.755091

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8300
Valid Loss: 1.03000
Valid Accuracy: 0.75285
best accuracy so far: 0.755091
 train accuracy so far: 0.998498

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8400
Valid Loss: 1.04205
Valid Accuracy: 0.75682Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.756817

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8500
Valid Loss: 1.00672
Valid Accuracy: 0.75544
best accuracy so far: 0.756817
 train accuracy so far: 0.998498

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8600
Valid Loss: 1.00862
Valid Accuracy: 0.75682
best accuracy so far: 0.756817

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8700
Valid Loss: 1.03758
Valid Accuracy: 0.75423
best accuracy so far: 0.756817
 train accuracy so far: 0.999332

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8800
Valid Loss: 1.01830
Valid Accuracy: 0.75647
best accuracy so far: 0.756817

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 8900
Valid Loss: 0.98278
Valid Accuracy: 0.76096Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.760960
 train accuracy so far: 0.999166

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9000
Valid Loss: 1.02607
Valid Accuracy: 0.75544
best accuracy so far: 0.760960

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9100
Valid Loss: 1.01386
Valid Accuracy: 0.75889
best accuracy so far: 0.760960

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9200
Valid Loss: 1.02439
Valid Accuracy: 0.75406
best accuracy so far: 0.760960
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9300
Valid Loss: 1.01932
Valid Accuracy: 0.75820
best accuracy so far: 0.760960

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9400
Valid Loss: 0.99238
Valid Accuracy: 0.75923
best accuracy so far: 0.760960
 train accuracy so far: 0.999166

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9500
Valid Loss: 1.02538
Valid Accuracy: 0.75716
best accuracy so far: 0.760960

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9600
Valid Loss: 1.00972
Valid Accuracy: 0.76130Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.761305
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9700
Valid Loss: 1.01941
Valid Accuracy: 0.76113
best accuracy so far: 0.761305

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9800
Valid Loss: 1.00778
Valid Accuracy: 0.75889
best accuracy so far: 0.761305
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 9900
Valid Loss: 1.02104
Valid Accuracy: 0.75889
best accuracy so far: 0.761305

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10000
Valid Loss: 0.99962
Valid Accuracy: 0.76579Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.765792
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10100
Valid Loss: 1.01856
Valid Accuracy: 0.75923
best accuracy so far: 0.765792

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10200
Valid Loss: 1.01092
Valid Accuracy: 0.76286
best accuracy so far: 0.765792
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10300
Valid Loss: 1.01278
Valid Accuracy: 0.76407
best accuracy so far: 0.765792

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10400
Valid Loss: 0.99006
Valid Accuracy: 0.76372
best accuracy so far: 0.765792
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10500
Valid Loss: 1.01696
Valid Accuracy: 0.76372
best accuracy so far: 0.765792

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10600
Valid Loss: 0.99183
Valid Accuracy: 0.76907Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10700
Valid Loss: 1.02495
Valid Accuracy: 0.75647
best accuracy so far: 0.769071
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10800
Valid Loss: 1.02347
Valid Accuracy: 0.76027
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 10900
Valid Loss: 1.00050
Valid Accuracy: 0.76545
best accuracy so far: 0.769071
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11000
Valid Loss: 1.01287
Valid Accuracy: 0.76338
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11100
Valid Loss: 0.99568
Valid Accuracy: 0.76579
best accuracy so far: 0.769071
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11200
Valid Loss: 1.00860
Valid Accuracy: 0.76700
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11300
Valid Loss: 0.99067
Valid Accuracy: 0.76717
best accuracy so far: 0.769071
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11400
Valid Loss: 1.01102
Valid Accuracy: 0.76631
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11500
Valid Loss: 1.00829
Valid Accuracy: 0.76683
best accuracy so far: 0.769071
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11600
Valid Loss: 1.00771
Valid Accuracy: 0.76320
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11700
Valid Loss: 0.99146
Valid Accuracy: 0.76700
best accuracy so far: 0.769071
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11800
Valid Loss: 0.99133
Valid Accuracy: 0.76838
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 11900
Valid Loss: 1.00081
Valid Accuracy: 0.76527
best accuracy so far: 0.769071
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12000
Valid Loss: 1.00099
Valid Accuracy: 0.76666
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12100
Valid Loss: 1.00121
Valid Accuracy: 0.76700
best accuracy so far: 0.769071
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12200
Valid Loss: 1.00320
Valid Accuracy: 0.76579
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12300
Valid Loss: 0.99759
Valid Accuracy: 0.76596
best accuracy so far: 0.769071

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12400
Valid Loss: 0.99341
Valid Accuracy: 0.77097Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.770970
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12500
Valid Loss: 0.99638
Valid Accuracy: 0.76838
best accuracy so far: 0.770970

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12600
Valid Loss: 0.99490
Valid Accuracy: 0.76786
best accuracy so far: 0.770970
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12700
Valid Loss: 0.99100
Valid Accuracy: 0.76942
best accuracy so far: 0.770970

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12800
Valid Loss: 0.99142
Valid Accuracy: 0.76959
best accuracy so far: 0.770970
 train accuracy so far: 0.999499

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 12900
Valid Loss: 0.99134
Valid Accuracy: 0.76942
best accuracy so far: 0.770970

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13000
Valid Loss: 0.99312
Valid Accuracy: 0.77114Saved model checkpoint to [DIR: %s]./output
best accuracy so far: 0.771143
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13100
Valid Loss: 0.99420
Valid Accuracy: 0.76804
best accuracy so far: 0.771143

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13200
Valid Loss: 0.99361
Valid Accuracy: 0.76855
best accuracy so far: 0.771143
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13300
Valid Loss: 0.99297
Valid Accuracy: 0.76924
best accuracy so far: 0.771143

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13400
Valid Loss: 0.99195
Valid Accuracy: 0.76804
best accuracy so far: 0.771143
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13500
Valid Loss: 0.99531
Valid Accuracy: 0.76804
best accuracy so far: 0.771143

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13600
Valid Loss: 0.99516
Valid Accuracy: 0.76752
best accuracy so far: 0.771143
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13700
Valid Loss: 0.99344
Valid Accuracy: 0.76804
best accuracy so far: 0.771143

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13800
Valid Loss: 0.99727
Valid Accuracy: 0.76752
best accuracy so far: 0.771143

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 13900
Valid Loss: 0.99578
Valid Accuracy: 0.76786
best accuracy so far: 0.771143
 train accuracy so far: 0.999666

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14000
Valid Loss: 0.99838
Valid Accuracy: 0.76735
best accuracy so far: 0.771143

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14100
Valid Loss: 0.99659
Valid Accuracy: 0.76752
best accuracy so far: 0.771143
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14200
Valid Loss: 0.99694
Valid Accuracy: 0.76683
best accuracy so far: 0.771143

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14300
Valid Loss: 0.99594
Valid Accuracy: 0.76735
best accuracy so far: 0.771143
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14400
Valid Loss: 0.99647
Valid Accuracy: 0.76786
best accuracy so far: 0.771143

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14500
Valid Loss: 0.99654
Valid Accuracy: 0.76717
best accuracy so far: 0.771143
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14600
Valid Loss: 0.99690
Valid Accuracy: 0.76717
best accuracy so far: 0.771143

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14700
Valid Loss: 0.99697
Valid Accuracy: 0.76700
best accuracy so far: 0.771143
 train accuracy so far: 1.000000

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14800
Valid Loss: 0.99681
Valid Accuracy: 0.76700
best accuracy so far: 0.771143

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 14900
Valid Loss: 0.99675
Valid Accuracy: 0.76700
best accuracy so far: 0.771143
 train accuracy so far: 0.999833

***** Running Validation *****
  Num steps = 363
  Batch size = 8

Validation Results
Global Steps: 15000
Valid Loss: 0.99673
Valid Accuracy: 0.76700
best accuracy so far: 0.771143
 train accuracy so far: 1.000000
Best Accuracy: 	0.771143
End Training!
Total Training Time: 	2.190985

